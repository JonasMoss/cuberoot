#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass book
\begin_preamble

\usepackage{algorithm,algpseudocode}
\usepackage{tikz}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{masterfrontpage}
\usepackage{natbib}
\bibliographystyle{agsm}
\bibpunct{(}{)}{,}{a}{,}{,}


\usepackage{float}
\floatstyle{plaintop}
\restylefloat{table}

\renewcommand{\bibfont}{\small}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\med}{\textrm{med}}

\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Var}{\mathrm{Var}}

\newcommand{\F}{\mathcal{F}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\Pn}{\mathbb{P}_{n}}
\newcommand{\Prob}{\mathbb{P}}
\newcommand{\Pnstar}{\mathbb{P}_{n}^{*}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\tod}{\stackrel{d}{\to}}
\newcommand{\topr}{\stackrel{P}{\to}}
\newcommand{\tow}{\rightsquigarrow}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
theorems-named
theorems-sec
\end_modules
\maintain_unincluded_children false
\language british
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command bibtex
\index_command default
\paperfontsize 12
\spacing onehalf
\use_hyperref true
\pdf_title "Cube root asymptotics"
\pdf_author "Jonas Moss"
\pdf_subject "Statistics"
\pdf_keywords "histograms, density estimation, cube root asymptotics, binary response model, Manski's maximum score estimator"
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize a4paper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 4cm
\topmargin 3cm
\rightmargin 2.7cm
\bottommargin 3cm
\secnumdepth 2
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
author{Jonas Moss} 
\end_layout

\begin_layout Plain Layout


\backslash
title{Cube Root Asymptotics} 
\end_layout

\begin_layout Plain Layout


\backslash
subtitle{Maximal Scores and Irregular Histograms}
\end_layout

\begin_layout Plain Layout


\backslash
masterfrontpage
\end_layout

\begin_layout Plain Layout


\backslash
frontmatter
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Abstract
\end_layout

\begin_layout Standard
Estimators with cube root asymptotics are typically the result of M-estimation
 with non-smooth objective functions.
 Aside from being inefficient, they are hard to calculate, have intractable
 limiting distributions, and are unamenable to the bootstrap.
 Manski's maximum score estimator and irregular histograms receive special
 attention.
 We investigate the geometry, algorithmics and robustness properties of
 Manski's maximum score estimator, a semiparametric estimator of the coefficient
s in the binary response model.
 We provide a new exact algorithm for its computation in covariate dimension
 one and two.
 This is faster than other algorithms described in the statistical literature.
 The breakdown point in covariate dimension one is derived, and we make
 progress towards finding it in higher dimensions.
 The breakdown points are highly dependent on the underlying data generating
 mechanism.
 Irregular histograms on the unit interval are also a major theme of this
 thesis.
 These are obtained through the minimisation of the Kullback-Leibler divergence
 and integrated squared distance.
 For smooth densities, we derive the limit distributions of the split points
 estimates for four classes of irregular histograms.
 Different conditions on the underlying density leads to different rates
 of convergence, with cube root being the norm.
 The computational challenges involved in finding these histograms are discussed
, and some anomalies associated with them are investigated.
 Also, it is indicated how one can proceed in order to show consistency
 of these density estimators.
 Finally we derive the 
\emph on
CIC
\emph default
 (cube root information criterion), a cousin of the AIC.
 
\end_layout

\begin_layout Chapter
Preface
\end_layout

\begin_layout Standard
The subject of this thesis was decided upon after Nils and I talked about
 a specific regression problem.
 Assume we have a regression 
\begin_inset Formula $Y_{i}=m(x_{i})+\epsilon_{i}$
\end_inset

, where 
\begin_inset Formula $x_{i}\in[0,1]$
\end_inset

 for simplicity.
 Questions in the social sciences sometimes take the form 
\begin_inset Quotes eld
\end_inset

is 
\begin_inset Formula $m$
\end_inset

 an increasing function?
\begin_inset Quotes erd
\end_inset

.
 Let's take an example from the paper is 
\begin_inset Quotes eld
\end_inset

The Too-Much-Talent Effect: Team Interdependence Determines When More Talent
 Is Too Much or Not Enough
\begin_inset Quotes erd
\end_inset

 of 
\begin_inset CommandInset citation
LatexCommand citet
key "swaab2014too"

\end_inset

.
 In team sports like football, baseball and basketball, it seems very plausible
 that teams get better as they get more talented players.
 If 
\begin_inset Formula $x_{i}$
\end_inset

 is a measurement of the talentedness of team 
\begin_inset Formula $i$
\end_inset

, and 
\begin_inset Formula $Y_{i}$
\end_inset

 is its objective outcome (e.g.
 number of games won), then 
\begin_inset Formula $Y_{i}=m(x_{i})+\epsilon_{i}$
\end_inset

 is the model, and 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $m$
\end_inset

 is monotonely increasing
\begin_inset Quotes erd
\end_inset

 is the (sensible!) null hypothesis.
 Swab et al.
 claim that the function 
\begin_inset Formula $m$
\end_inset

 
\emph on
isn't 
\emph default
increasing on 
\begin_inset Formula $[0,1]$
\end_inset

 in the case of football, but reaches its maximum before 
\begin_inset Formula $1$
\end_inset

.
 There is, to me, no obvious way to attack this problem, which is why I
 brought it up.
\end_layout

\begin_layout Standard
This discussion of monotone regression functions quickly led to 
\emph on
isotonic regression
\emph default
, on to 
\emph on
Grenander's estimator.
 
\emph default
Since these estimators are well-known for having cube root asymptotics,
 it suddenly became the theme of my thesis! This theme couldn't have been
 chosen if it weren't for the work Nils did in 
\begin_inset CommandInset citation
LatexCommand citeyear
key "hjortCIC"

\end_inset

 on the limiting distribution of the split points in so-called quantile
 histograms, which sparked the fires of this thesis.
 
\end_layout

\begin_layout Standard
General thanks to my adviser Nils Lid Hjort for giving me much to work on
 and for deluging me with wisdom.
 General thanks to my wife Kjersti Moss for proofreading, the verification
 of some equations and for taking care of the kids.
 I also thank Scott Bunting and Robert Bunting for proofreading parts of
 the thesis.
 Special thanks to Gudmund Hermansen for helping me out with the exact histogram
 algorithm.
 Special thanks to Jonas Lindstr√∏m for listening to me go on and on about
 histograms: Histograms is, frankly speaking, a dry subject.
 General thanks to Nadia Larsen and Dag Normann for being excellent advisers
 on a master project in 
\begin_inset Formula $C^{*}$
\end_inset

-algebras I never finished.
 General thanks to the people who authored of all those papers and books,
 cited or not.
 Many of them are amazing! Unrelated thanks to Charles Darwin for being
 the most important scientist, and Yuki Kajiura for creating wonderful music.
 Very special bureaucratic thanks to the administration at Kvadraturen Skolesent
er high school (in 2010) for giving me my high school diploma even though
 I never went to school there.
 
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
mainmatter
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Setting the scene
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Quote
\noindent
\align right
No one has yet discovered any warlike purpose to be served by the theory
 of [cube root asymptotics], and it seems unlikely that anyone will do so
 for many years.
\end_layout

\begin_layout Quote
\noindent
\align right
- G.
 H.
 Hardy in 
\emph on
A Mathematician's Apology 
\emph default
(slightly paraphrased)
\end_layout

\begin_layout Standard
Among all warlike estimators in statistics, far most have square root asymptotic
s: An estimator 
\begin_inset Formula $\widehat{\theta}_{n}$
\end_inset

 of 
\begin_inset Formula $\theta$
\end_inset

 has square root asymptotics if 
\begin_inset Formula $\sqrt{n}(\widehat{\theta}_{n}-\theta)\tod Y$
\end_inset

, where 
\begin_inset Formula $Y$
\end_inset

 is a non-degenerate random variable.
 Typically, 
\begin_inset Formula $Y$
\end_inset

 is normally distributed with some 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\Sigma$
\end_inset

 dependent on the features of the underlying distribution 
\begin_inset Formula $F$
\end_inset

.
 This kind of limiting distribution appears e.g.
 when we use maximum likelihood, Bayes estimators, 
\begin_inset Formula $Z$
\end_inset

-estimators and the generalised method of moments.
 Estimators with cube root asymptotics, on the other hand, satisfy 
\begin_inset Formula $n^{\frac{1}{3}}(\widehat{\theta}_{n}-\theta)\tod Y$
\end_inset

 for some non-degenerate random 
\begin_inset Formula $Y$
\end_inset

.
 Instead of being normal, 
\begin_inset Formula $Y$
\end_inset

 is typically distributed as the maximiser of a non-degenerate zero-mean
 Gaussian process with drift.
 Frequentely, 
\begin_inset Formula $Y$
\end_inset

 is a scaled variant of 
\begin_inset Formula $\argmax_{t}\left[W(t)-t^{2}\right]$
\end_inset

, where 
\begin_inset Formula $W$
\end_inset

 is a two-sided Browian motion originating from 
\begin_inset Formula $0$
\end_inset

.
 Such variables are distributed according to  
\emph on
Chernoff's distribution.
 
\emph default
There is also at least one elementary case where we have
\emph on
 
\begin_inset Formula $n$
\end_inset

-asymptotics
\emph default
, namely 
\begin_inset Formula $\widehat{\theta}_{n}=\max X_{i}$
\end_inset

 when 
\begin_inset Formula $X_{i}\stackrel{i.i.d.}{\sim}\mathcal{U}(0,\theta)$
\end_inset

.
 Normalizing, we get the convergence 
\begin_inset Formula $n(\frac{\widehat{\theta}_{n}-\theta}{\theta})\to\exp(1)$
\end_inset

.
 More generally, this phenomenon obtains whenever the underlying 
\begin_inset Formula $F$
\end_inset

 is smooth all the way to a break point.
 There are no similarly simple examples of cube root asymptotics, however.
 
\end_layout

\begin_layout Standard
Cube root asymptotics fall into roughly three cases:
\end_layout

\begin_layout Enumerate
Maximum likelihood for distributions having specific features.
 Two examples are Grenander's estimator and isotonic regression.
 Under the assumption that 
\begin_inset Formula $f$
\end_inset

 is a decreasing density, Grenander's estimator is the left derivative of
 the concave majorant of the empirical distribution function.
 If smoothness assumptions on 
\begin_inset Formula $f$
\end_inset

 are satisfied, the estimator has cube root asymptotics.
 
\begin_inset CommandInset citation
LatexCommand citep
key "groeneboom2014nonparametric"

\end_inset


\end_layout

\begin_layout Enumerate
Robustness.
 The 
\emph on
shorth
\emph default
 estimator 
\begin_inset CommandInset citation
LatexCommand citep
key "andrews2015robust"

\end_inset

 is a robust estimator for the mean.
 Manski's maximum score estimator is a model robust estimator for the binary
 choice model.
 This estimator is discussed at length in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Manski's-maximum-score"

\end_inset

.
 The 
\emph on
least median squares
\emph default
 
\begin_inset CommandInset citation
LatexCommand citep
key "rousseeuw1984least"

\end_inset

, which is discussed in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Least-median-squares"

\end_inset

 robustly estimates the 
\begin_inset Formula $\beta$
\end_inset

s in a linear regression model.
\end_layout

\begin_layout Enumerate
Approximation by step functions: The largest chapter (
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:histograms"

\end_inset

) of this thesis is on the subject of 
\emph on
irregular histograms
\emph default
, wherein the split points are shown to converge at the 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

 rate provided the underlying 
\begin_inset Formula $f$
\end_inset

 possesses a derivative.
 A similar concept is that of decision trees, or regression histograms,
 discussed in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Binary-decision-trees"

\end_inset

.
\end_layout

\begin_layout Standard
A feature these estimators have in common is their attempt to measure something
 smooth by using something discrete.
 For instance, both Grenander's estimator and histograms approximate a smooth
 density with a step function.
 Manski's score estimator estimates the 
\begin_inset Formula $\beta$
\end_inset

s in a binary choice regression model by maximising a step function; binary
 decision trees estimate a smooth regression model with a step function.
 We can make this more precise.
 These estimators are typically 
\begin_inset Formula $M$
\end_inset

-estimators, with objective 
\begin_inset Formula $m_{\theta}$
\end_inset

.
 The underlying mechanism is that 
\begin_inset Formula $Pm_{\theta}=\int m_{\theta}dP$
\end_inset

 is smooth in 
\begin_inset Formula $\theta$
\end_inset

, but 
\begin_inset Formula $P_{n}m_{\theta}=n^{-1}\sum_{i=1}^{n}m_{\theta}(X_{i})$
\end_inset

 is not.
 Most 
\begin_inset Formula $M$
\end_inset

-estimators are constructed in a manner which makes this impossible.
 The culprit in cube root asymptotics is the introduction of indicator functions
 in 
\begin_inset Formula $m_{\theta}$
\end_inset

.
 For instance, 
\begin_inset Formula $m_{\theta}=1_{[x-\frac{1}{2}\theta,x+\frac{1}{2}\theta]}$
\end_inset

 for Chernoff's mode estimator of Section 
\begin_inset CommandInset ref
LatexCommand vref
reference "sub:Heuristics-and-examples"

\end_inset

, a section contains more about the heuristics of cube root asymptotics.
\end_layout

\begin_layout Standard
Sometimes, when we replace the smoothness assumptions on 
\begin_inset Formula $Pm_{\theta}$
\end_inset

 with discreteness assumptions, we gain 
\begin_inset Formula $n$
\end_inset

-convergence instead.
 This happens for decision trees and is likely to happen for irregular histogram
s as well.
\end_layout

\begin_layout Standard
Other common features of cube root asymptotics are:
\end_layout

\begin_layout Enumerate
In higher dimensions, the limit distributions are intractable both analytically
 and numerically.
 In one dimension, the limiting distribution can frequently be described
 as a rescaled Chernoff's distribution, typically involving several nuisance
 parameters.
\end_layout

\begin_layout Enumerate
Inconsistency of the bootstrap.
 Fortunately, the subsample and 
\begin_inset Formula $m$
\end_inset

-out-of-
\begin_inset Formula $n$
\end_inset

 bootstrap is still consistent.
 We will have more to say on this in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Resampling"

\end_inset

.
\end_layout

\begin_layout Enumerate
The estimates are computationally expensive to find, at least in higher
 dimensions.
 Finding them typically requires combinatorial optimisation, with methods
 like Newton-Raphson being next to useless.
\end_layout

\begin_layout Enumerate
Even for big 
\begin_inset Formula $n$
\end_inset

, the distance between the sampling distribution and the limiting distribution
 is large.
\end_layout

\begin_layout Standard
Add to all these the fact that cube roots give a tremendous loss in efficiency
 compared to other reasonable procedures, like local polynomial regression
 instead of decision trees, ordinary linear regression instead of least
 median of squares regression, and kernel smoothers instead of irregular
 histograms, and we have the reason why these estimators are not very popular.
 An attractive feature of these estimators is often that they have fewer
 assumptions, and sometimes other nice properties: Manski's maximum score
 estimator is consistent under very broad assumptions, it is robust, and
 it has been shown that there exist 
\emph on
no 
\emph default

\begin_inset Formula $\sqrt{n}$
\end_inset

-consistent estimator of the 
\begin_inset Formula $\mbox{Beta}$
\end_inset

s in the binary response model under these assumptions 
\begin_inset CommandInset citation
LatexCommand citep
key "chamberlain1986asymptotic"

\end_inset

.
 Also, Rousseeuw's least median of squares estimator is the most outlier
 robust linear regression estimator there is, and irregular histograms are
 likely to be 
\begin_inset Formula $L_{1}$
\end_inset

-consistent for any underlying density on 
\begin_inset Formula $[0,1]$
\end_inset

, are easy to interpret, and require little space to store (when compared
 to KDEs, which essentially require the entire set of observations).
 Still, the study of cube root asymptotics has mostly been theoretical,
 with some papers on the bootstrap appearing in later years.
 
\end_layout

\begin_layout Standard
The combination of the points 1.) and 2.) above is especially pernicious,
 as it leaves no obvious method for calculating confidence intervals and
 doing hypothesis tests.
 This can sometimes, as in the case of Manski's estimator and (probably)
 irregular histograms, be rectified by smoothing.
 Also, the 
\begin_inset Formula $m$
\end_inset

-out-of-
\begin_inset Formula $n$
\end_inset

 bootstrap and 
\begin_inset Formula $m$
\end_inset

-subsampling are consistent in general, but they require a choice of 
\begin_inset Formula $m$
\end_inset

.
 The choice of 
\begin_inset Formula $m$
\end_inset

 is usually done by a kind of cross validation approach, which requires
 the calculation of countless estimates.
 In addition, these methods often require a large 
\begin_inset Formula $n$
\end_inset

 in order to work well.
 This combined with 3.) makes it infeasible to use these two resampling approache
s.
 
\end_layout

\begin_layout Section
An outline
\end_layout

\begin_layout Standard
Roughly speaking, we will devote Chapter 2 to cube root asymptotics in general,
 while the the succeeding chapters are devoted to two more worked-out examples:
 Manski's maximum score estimator 
\begin_inset CommandInset citation
LatexCommand citet
key "manski1975maximum"

\end_inset

 and irregular histograms on the unit interval 
\begin_inset CommandInset citation
LatexCommand citet
key "rozenholc2010combining"

\end_inset

.
 These investigations are meant as theoretical exercises, and the estimators
 are not applied on any non-trivial data sets.
\end_layout

\begin_layout Standard
In Chapter 2 we briefly discuss some of the general theory required for
 proving cube root convergence.
 This is the theory of M-estimation and empirical processes, where most
 is taken from van der Vaart and Wellner's excellent book 
\begin_inset Quotes eld
\end_inset

Weak Convergence and Empirical Processes
\begin_inset Quotes erd
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "van1996weak"

\end_inset

.
 The key result from this book is the rate theorem, which can be used to
 establish the limit distribution and prove the rate of convergence for
 any known estimator with cube root asymptotics.
 We will not be able to do this theory justice, but we will try to indicate
 where the results come from and what the difficulties are.
 We will also discuss the cube root heuristics of Kim & Pollard 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "kim1990cube"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand citet
key "chernoff1964estimation"

\end_inset

, by means of a heuristic proof of the limiting distribution of Chernoff's
 mode estimator (ibid.), which is the most simple estimator in this category.
 This particular estimator illuminates the question of why cube root asymptotics
 occurs.
 Then we briefly describe the least median of squares estimator and binary
 decision trees 
\begin_inset CommandInset citation
LatexCommand citep
key "banerjee2007confidence"

\end_inset

.
 Finally, we will discuss resampling.
 
\end_layout

\begin_layout Standard
The next chapter is about Manski's maximum score estimator (which we will
 often call 
\begin_inset Quotes eld
\end_inset

Manski's estimator
\begin_inset Quotes erd
\end_inset

), a semiparametric estimator of the 
\begin_inset Formula $\beta$
\end_inset

s in a binary response model.
 We will not focus on the asymptotics in this Chapter, as the algorithmics
 will be at the centre of our attention.
 An algorithm for its computation in one and two dimensions is discussed
 in detail, and we supply and implementation of it in 
\begin_inset Formula $\mathtt{C}++$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "stroustrup1986c++"

\end_inset

, with a link to 
\begin_inset Formula $\mathtt{R}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "Rprog"

\end_inset

.
 In addition, we discuss its robustness properties and carry out some simulation
s.
 
\end_layout

\begin_layout Standard
In the Chapter 4, irregular histograms on the unit interval is the subject.
 This chapter forms the bulk of this thesis.
 First we discuss kernel density estimation on the unit interval, with a
 special focus on the Gaussian copula KDE of 
\begin_inset CommandInset citation
LatexCommand citet
key "jones2007miscellanea"

\end_inset

.
 Secondly, we define a class of histograms and discuss some of their properties.
 Then our attention goes the question of 
\begin_inset Formula $L_{1}$
\end_inset

-consistency for these histograms.
 In the succeeding section we find the limiting distribution of the 
\emph on
split points 
\emph default
of these histograms, which is our main application of theory of 
\begin_inset Formula $M$
\end_inset

-estimation from Chapter 2.
 Also, we will discuss three different algorithms for the computation of
 the split points, and demonstrate the considerable advantage of pre-smoothing.
 We implement some of this in 
\begin_inset Formula $\mathtt{C}++/\mathtt{R}$
\end_inset

.
 Finally we discuss the 
\emph on
cube root information criterion 
\emph default
(CIC), an extension of the AIC to these classes of histograms.
\end_layout

\begin_layout Chapter
Stochastic convergence
\end_layout

\begin_layout Quote
\noindent
\align right
For many, abstract thinking is toil; for me, on good days, it is feast and
 frenzy.
 
\end_layout

\begin_layout Quote
\noindent
\align right
- Martin Heidegger in 
\emph on
Nietzsche 
\emph default
(tr: D.
 F.
 Krell)
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
In the first section we briefly discuss the basic theory of weak convergence,
 including some of the technical difficulties that arises when working with
 stochastic variables on non-separable Banach spaces.
 The second section is devoted to 
\begin_inset Formula $M$
\end_inset

-estimation, a class which contains every known estimator with cube root
 asymptotics.
 A particularly important result is the monumental rate theorem.
 In the third section we discuss some estimators with cube root asymptotics.
 We will derive the limit distribution of Chernoff's mode estimator heuristicall
y, and will discuss the heuristics of cube root asymptotics from Kim and
 Pollard 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "kim1990cube"

\end_inset

.
 We end the chapter with a discussion on resampling schemes in the context
 of cube root asymptotics.
\end_layout

\begin_layout Section
Weak convergence
\end_layout

\begin_layout Subsection
Theoretical basis
\end_layout

\begin_layout Standard
Given a probability space 
\begin_inset Formula $(\Omega,\F,P),$
\end_inset

 a stochastic variable is a map 
\begin_inset Formula $X:\Omega\to\mathbb{R}^{n}$
\end_inset

 which is 
\begin_inset Formula $(\Sigma,\mathcal{\mathscr{B}}^{n})$
\end_inset

-measurable, where 
\begin_inset Formula $\mathcal{\mathscr{B}}^{n}$
\end_inset

 is the Borel 
\begin_inset Formula $\sigma$
\end_inset

-algebra on 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

.
 The majority of classical results on convergence of stochastic variables
 depends on this measurability condition being satisfied.
 For instance, a sequence 
\begin_inset Formula $X_{n}:\Omega\to\mathbb{R}$
\end_inset

 converges weakly to 
\begin_inset Formula $X$
\end_inset

, denoted 
\begin_inset Formula $X_{n}\tod X$
\end_inset

, if 
\begin_inset Formula $P(X_{n}\leq x)\to P(X\leq x)$
\end_inset

 pointwise for every continuity point of 
\begin_inset Formula $F(x)=P(X\leq x)$
\end_inset

.
 This definition requires something like 
\begin_inset Formula $(\Sigma,\mathcal{B})$
\end_inset

-measurability, as we need to assign probabilities to every set of the form
 
\begin_inset Formula $X_{n}^{-1}(-\infty,x]$
\end_inset

.
 Likewise, measurability is required for the concepts of convergence almost
 surely and convergence in probability.
 
\end_layout

\begin_layout Standard
In this thesis, we will encounter maps of the form 
\begin_inset Formula $X_{n}:\Omega\to\mathbb{D},$
\end_inset

 where 
\begin_inset Formula $\mathbb{D}$
\end_inset

 is some metric space, typically a non-separable Banach space.
 This lack of separability creates plenty of measurability issues.
 In the next example, it is illuminating to known that 
\begin_inset Formula $l^{\infty}(T)$
\end_inset

 is separable iff 
\begin_inset Formula $T$
\end_inset

 is finite 
\begin_inset CommandInset citation
LatexCommand citep
after "exercise 1.143"
key "megginson2012introduction"

\end_inset

.
\end_layout

\begin_layout Example
(Kosorok).
 Let 
\begin_inset Formula $\Omega=[0,1]$
\end_inset

 and 
\begin_inset Formula $P=\lambda$
\end_inset

 the Lebesgue measure on 
\begin_inset Formula $[0,1]$
\end_inset

.
 Let 
\begin_inset Formula $U:\Omega\to[0,1]$
\end_inset

 be the identity function on this interval, the uniform distribution on
 the unit interval.
 Now we define the function 
\begin_inset Formula $X:\left[0,1\right]\to\left[0,1\right]$
\end_inset

 by 
\begin_inset Formula $X\left(x\right)=1_{[U\leq x]}$
\end_inset

.
 This is gives us a map 
\begin_inset Formula 
\begin{eqnarray*}
\Omega & \to & l^{\infty}\left([0,1]\right).\\
\omega & \mapsto & X.
\end{eqnarray*}

\end_inset

Consider the sets 
\begin_inset Formula $a_{\delta}=\left\{ f\in l^{\infty}\left([0,1]\right)\mid\left\Vert f-1_{\left[a\leq x\right]}\right\Vert <\delta\right\} $
\end_inset

 and take 
\begin_inset Formula $\delta=\frac{1}{2}$
\end_inset

.
 
\end_layout

\begin_layout Example

\lang english
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center

\lang english
\begin_inset Graphics
	filename C:/Users/Jonas/Documents/OppgaveR/non-measurable.pdf
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout

\lang english
\begin_inset Caption Standard

\begin_layout Plain Layout

\lang english
Example of an 
\begin_inset Formula $l^{\infty}([0,1])$
\end_inset

-function inside 
\begin_inset Formula $a_{\delta}$
\end_inset

, with 
\begin_inset Formula $\delta=0.5$
\end_inset

 and 
\begin_inset Formula $a=0.3$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
it is clear that 
\begin_inset Formula $X^{-1}\left(a_{\delta}\right)=a$
\end_inset

, so if 
\begin_inset Formula $A_{\delta}=\cup_{a\in A}a_{\delta}$
\end_inset

, then 
\begin_inset Formula $X^{-1}(A_{\delta})=A$
\end_inset

.
 Now Let 
\begin_inset Formula $A\subset\left[0,1\right]$
\end_inset

 be a non-Borel subset, such as a complete analytic set (see e.g.
 
\begin_inset CommandInset citation
LatexCommand citet
after "p. 85"
key "kechris2012classical"

\end_inset

).
 As 
\begin_inset Formula $A_{\delta}$
\end_inset

 is open in 
\begin_inset Formula $l^{\infty}\left([0,1]\right)$
\end_inset

, 
\begin_inset Formula $X$
\end_inset

 isn't 
\begin_inset Formula $(\Sigma,\mathcal{B}^{n})$
\end_inset

-measurable.
\end_layout

\begin_layout Standard
An easy modification of this example shows that the process 
\begin_inset Formula 
\[
\sqrt{n}(\frac{1}{n}\sum_{i=1}^{n}1_{[X_{n}\leq x]}-x)
\]

\end_inset

isn't measurable when 
\begin_inset Formula $X_{n}$
\end_inset

 are i.i.d.
 uniform on the unit interval.
 Hence we need a different framework to deal with such processes.
 The classic approach, used in 
\begin_inset CommandInset citation
LatexCommand cite
key "billingsley2013convergence"

\end_inset

, uses convergence in the Skorokhod topology.
 The modern approach, described in 
\begin_inset CommandInset citation
LatexCommand cite
key "van1996weak"

\end_inset

 and started by Hoffmann-J√∏rgensen, is quite different, and we will briefly
 describe it here.
 
\end_layout

\begin_layout Standard
It is a well known result that convergence in distribution can equivalently
 be formulated as weak*-convergence: A sequence 
\begin_inset Formula $X_{n}\in\mathbb{R}$
\end_inset

 converges in distribution to 
\begin_inset Formula $X\in\mathbb{R}$
\end_inset

 iff 
\begin_inset Formula $Ef(X_{n})\to Ef(X)$
\end_inset

 for every bounded, continuous function 
\begin_inset Formula $f:\mathbb{R}\to\mathbb{R}$
\end_inset

, see e.g.
 
\begin_inset CommandInset citation
LatexCommand citet
after "p. 117, theorem 10.1.1"
key "rosenthal2006first"

\end_inset

.
 This definition extends nicely to the case when 
\begin_inset Formula $X_{n}$
\end_inset

 are elements of separable Banach spaces, but the measurability issues mentioned
 above makes it impossible to use this same definition of convergence when
 
\begin_inset Formula $X_{n}$
\end_inset

 are elements of 
\emph on
non-separable
\emph default
 Banach spaces, like 
\begin_inset Formula $l^{\infty}(\mathbb{R})$
\end_inset

.
 An appropriate extension is to define 
\begin_inset Formula $X^{\star}$
\end_inset

 as the least measurable majorant of 
\begin_inset Formula $X$
\end_inset

, 
\begin_inset Formula $E^{\star}(X)=E(X^{\star})$
\end_inset

: Let 
\begin_inset Formula $\mathbb{D}$
\end_inset

 be a (non-separable) Banach space, and let 
\begin_inset Formula $X_{n}\in\mathbb{D}$
\end_inset

 be random variables (not necessarily measurable).
 In addition, let 
\begin_inset Formula $X\in\mathbb{D}$
\end_inset

 be a measurable limit variable.
 Then 
\begin_inset Formula $X_{n}\stackrel{d}{\to}X$
\end_inset

 iff 
\begin_inset Formula $E^{\star}f(X_{n})\to Ef(X)$
\end_inset

 for each bounded and continuous 
\begin_inset Formula $f:\mathbb{D}\to\mathbb{D}$
\end_inset

.
\end_layout

\begin_layout Standard
We will not make any direct use of this theory in this thesis, and we will
 mostly ignore measurability issues.
\end_layout

\begin_layout Subsection
Glivenko-Cantelli classes
\end_layout

\begin_layout Standard
Throughout this thesis we use a functional notation for measures: When 
\begin_inset Formula $P$
\end_inset

 is a measure on a measure space 
\begin_inset Formula $(X,\Sigma)$
\end_inset

 and 
\begin_inset Formula $f:X\to\mathbb{R}$
\end_inset

 is a measurable function, we denote 
\begin_inset Formula $\int f(x)dP(x)=Pf$
\end_inset

.
 This notation reflects the fact that 
\begin_inset Formula $\int\cdot dP$
\end_inset

 is a functional mapping 
\begin_inset Formula $f\to\int f(x)dP(x)$
\end_inset

 for each 
\begin_inset Formula $f$
\end_inset

, and fits well into our approach.
 When 
\begin_inset Formula $P_{n}$
\end_inset

 is the empirical measure obtained from 
\begin_inset Formula $n$
\end_inset

 i.i.d.
 observations from 
\begin_inset Formula $P$
\end_inset

, 
\begin_inset Formula $P_{n}f=n^{-1}\sum_{i=1}^{n}f(X_{i})$
\end_inset

.
 It follows from the law of large numbers that 
\begin_inset Formula $P_{n}f\stackrel{a.s.}{\to}Pf$
\end_inset

 for any measurable 
\begin_inset Formula $f$
\end_inset

.
 We will need 
\emph on
uniform variants
\emph default
 of this result for different classes of functions.
 When 
\begin_inset Formula $\mathcal{F}$
\end_inset

 is a class of functions, the norm 
\begin_inset Formula $||\cdot||_{\mathcal{F}}$
\end_inset

 is defined by 
\begin_inset Formula $||X||_{\mathcal{F}}=\sup_{f\in\mathcal{F}}||f(X)||$
\end_inset

.
\end_layout

\begin_layout Definition
Let 
\begin_inset Formula $\mathcal{F}$
\end_inset

 be a class of functions and 
\begin_inset Formula $P$
\end_inset

 a probability measure.
 If 
\begin_inset Formula $||P_{n}-P||_{\mathcal{F}}\stackrel{p}{\to}0$
\end_inset

, the class 
\begin_inset Formula $\mathcal{F}$
\end_inset

 is 
\emph on

\begin_inset Formula $P$
\end_inset

-Glivenko-Cantelli.
\end_layout

\begin_layout Standard
The name 
\begin_inset Quotes eld
\end_inset

Glivenko-Cantelli class
\begin_inset Quotes erd
\end_inset

 comes from the famous Glivenko-Cantelli theorem 
\begin_inset CommandInset citation
LatexCommand cite
after "p. 269"
key "billingsley2008probability"

\end_inset

, which states that the class 
\begin_inset Formula 
\[
\mathcal{F}=\left\{ (-\infty,x]\mid x\in\mathbb{R}\right\} 
\]

\end_inset

is Glivenko-Cantelli for any probability 
\begin_inset Formula $P$
\end_inset

 on 
\begin_inset Formula $\mathbb{R}$
\end_inset

.
 Stated in a different way, it shows that 
\begin_inset Formula $F_{n}(x)\stackrel{p}{\to}F(x)$
\end_inset

 uniformly in 
\begin_inset Formula $x$
\end_inset

, where 
\begin_inset Formula $F_{n}$
\end_inset

 is the empirical distribution function.
 The definition also makes sense when convergence in probability is replaced
 with convergence almost surely.
\end_layout

\begin_layout Standard
In order to show that a family is Glivenko-Cantelli, we will use the concept
 of 
\emph on
bracketing numbers
\emph default
 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 83"
key "van1996weak"

\end_inset

, a stronger variant of the concept of compactness.
\end_layout

\begin_layout Definition
Given two functions 
\begin_inset Formula $l$
\end_inset

 and 
\begin_inset Formula $u$
\end_inset

, define the bracket 
\begin_inset Formula $[l,u]=\left\{ f\mid l\leq f\leq u\right\} $
\end_inset

.
 For a given norm 
\begin_inset Formula $||\cdot||$
\end_inset

, we define an 
\begin_inset Formula $\epsilon$
\end_inset

-bracket as a bracket 
\begin_inset Formula $[l,u]$
\end_inset

 with 
\begin_inset Formula $||l-u||<\epsilon$
\end_inset

.
 Let 
\begin_inset Formula $\mathcal{F}$
\end_inset

 be a class of measurable functions.
 The bracketing number of 
\begin_inset Formula $\mathcal{F}$
\end_inset

, denoted 
\begin_inset Formula $N_{[]}(\epsilon,\mathcal{F},||\cdot||)$
\end_inset

, is the minimal number of 
\begin_inset Formula $\epsilon$
\end_inset

-brackets required to cover 
\begin_inset Formula $\mathcal{F}.$
\end_inset


\end_layout

\begin_layout Standard
The following theorem is useful in proving that classes are Glivenko-Cantelli
 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 122, theorem 2.4.1"
key "van1996weak"

\end_inset

:
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:Bracket GC theorem"

\end_inset

Let 
\begin_inset Formula $\mathcal{F}$
\end_inset

 be a class of measurable functions that satisfy the bracketing number condition
 
\begin_inset Formula $N_{[]}(\epsilon,\mathcal{F},L_{1}(P))<\infty$
\end_inset

.
 Then 
\begin_inset Formula $\mathcal{F}$
\end_inset

 is 
\begin_inset Formula $P$
\end_inset

-Glivenko-Cantelli.
\end_layout

\begin_layout Standard
Now the original Glivenko-Cantelli result follows easily.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:Glivenko-Cantelli (main)"

\end_inset

The class 
\begin_inset Formula $\mathcal{F}=\left\{ (-\infty,x]\mid x\in\mathbb{R}\right\} $
\end_inset

 is Glivenko-Cantelli.
\end_layout

\begin_layout Proof
Apply the previous theorem with brackets of the form 
\begin_inset Formula $(-\infty,x_{i}]$
\end_inset

, where 
\begin_inset Formula $-\infty=x_{0}<x_{1},...<x_{m}=\infty$
\end_inset

 is chosen such that 
\begin_inset Formula $P([x_{i},x_{i+1}])<\epsilon$
\end_inset

.
 Then we need at most 
\begin_inset Formula $2+\frac{1}{\epsilon}$
\end_inset

 brackets, yielding the desired result.
\end_layout

\begin_layout Standard
Glivenko-Cantelli results are not of independent interest in this thesis,
 but will be used in order to establish consistency results through the
 Consistency Theorem (
\begin_inset CommandInset ref
LatexCommand vpageref
reference "thm:Consistency theorem"

\end_inset

).
 
\end_layout

\begin_layout Subsection
Donsker classes
\end_layout

\begin_layout Standard
While Glivenko-Cantelli results are uniform variants of the law of large
 numbers, Donsker results are uniform variants of the central limit theorem.
 These classes are named in honour of Monroe Donsker, who proved the uniform
 central limit theorem for the empirical distribution function.
 We are not interested in Donsker results in themselves, but they are needed
 in order to establish the limiting distributions of 
\begin_inset Formula $M$
\end_inset

-estimators by means of the rate theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:rate theorem"

\end_inset

.
 A family of functions 
\begin_inset Formula $\mathcal{F}$
\end_inset

 is 
\begin_inset Formula $P$
\end_inset

-Donsker if 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\sqrt{n}(P_{n}-P)\tod Z
\]

\end_inset

in 
\begin_inset Formula $l^{\infty}(\mathcal{F})$
\end_inset

, where 
\begin_inset Formula $Z$
\end_inset

 is a non-degenerate and measurable random process.
\end_layout

\begin_layout Standard
The concept of bracketing entropy has its place here as well: The bracketing
 integral is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
J_{[]}(\delta,F,L_{2}(P))=\int_{0}^{\delta}\sqrt{\log N_{[]}(\epsilon,\mathcal{F},L_{2}(P))}d\epsilon,
\]

\end_inset

which we want to be bounded as 
\begin_inset Formula $\delta\to\infty$
\end_inset

.
 This is a condition on the growth of the entropy as 
\begin_inset Formula $\epsilon\to0$
\end_inset

, for since 
\begin_inset Formula $N_{[]}(\epsilon,\mathcal{F},L_{2}(P)=1$
\end_inset

 when 
\begin_inset Formula $\delta$
\end_inset

 is large enough, it is only the values close to 
\begin_inset Formula $0$
\end_inset

 that are of interest.
 This integral is important due to the following theorem, which is proved
 in 
\begin_inset CommandInset citation
LatexCommand cite
after "p. 148"
key "kosorok2007introduction"

\end_inset

.
\end_layout

\begin_layout Theorem*
Let 
\begin_inset Formula $\mathcal{F}$
\end_inset

 be a class of measurable functions with a finite bracketing integral at
 infinity, 
\begin_inset Formula $J_{[]}(\infty,F,L_{2}(P))<\infty$
\end_inset

.
 Then 
\begin_inset Formula $\mathcal{F}$
\end_inset

 is P-Donsker.
\end_layout

\begin_layout Section
M-estimation
\begin_inset CommandInset label
LatexCommand label
name "sec:M-estimation"

\end_inset


\end_layout

\begin_layout Subsection
Basics
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\theta_{0}$
\end_inset

 be some statistical quantity and 
\begin_inset Formula $\widehat{\theta}$
\end_inset

 be an estimator of 
\begin_inset Formula $\theta_{0}$
\end_inset

.
 Then 
\begin_inset Formula $\widehat{\theta}$
\end_inset

 is an 
\emph on

\begin_inset Formula $M$
\end_inset

-estimator
\emph default
 if it is the point of maximum of a criterion function 
\begin_inset Formula $P_{n}m_{\theta},$
\end_inset

 where 
\begin_inset Formula $m_{\theta}:\mathcal{\Omega}\times\Theta\to\mathbb{R}$
\end_inset

.
 The function 
\begin_inset Formula $m_{\theta}$
\end_inset

 is typically chosen in order to ascertain that 
\begin_inset Formula $\argmax_{\theta\in\Theta}Pm_{\theta}=\theta_{0}$
\end_inset

, which indicates 
\begin_inset Formula $\widehat{\theta}\stackrel{p}{\to}\theta_{0}$
\end_inset

 as 
\begin_inset Formula $n\to\infty$
\end_inset

.
 The most famous case of 
\begin_inset Formula $M$
\end_inset

-estimation is that of maximum likelihood estimation, where 
\begin_inset Formula $m_{\theta}=l_{\theta}$
\end_inset

, the log likelihood of a parametric model.
 
\begin_inset Formula $M$
\end_inset

-estimation is often associated with robust statistics, where one can use
 criterion functions other than the log likelihood in order to obtain estimators
 with bounded 
\emph on
influence functions 
\emph default
(see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Manski Robustness"

\end_inset

) and easily understandable asymptotics.
 This approach was developed by 
\begin_inset CommandInset citation
LatexCommand citet
key "huber2011robust"

\end_inset

, and is often constrasted with 
\begin_inset Formula $L$
\end_inset

-estimators and 
\begin_inset Formula $R$
\end_inset

-estimators in classical robust statistics.
 In the context of robust statistics, 
\begin_inset Formula $M$
\end_inset

-estimators has a more restricted meaning than ours, as only smooth choices
 of 
\begin_inset Formula $m_{\theta}$
\end_inset

 are used.
 In this setting, both the asymptotics of 
\begin_inset Formula $\widehat{\theta}$
\end_inset

 and its value can be obtained by differentiating 
\begin_inset Formula $P_{n}m_{\theta}$
\end_inset

, yielding estimators which can be understood as the solution of the equation
 
\begin_inset Formula $P_{n}\frac{d}{d\theta}m_{\theta}=0$
\end_inset

 for some 
\begin_inset Formula $m_{\theta}.$
\end_inset

 These estimators are often called 
\begin_inset Formula $Z$
\end_inset

-estimators in the empirical process literature 
\begin_inset CommandInset citation
LatexCommand citet
after "chapter 3.3; chapter 5"
key "van1996weak,van2000asymptotic"

\end_inset

, emphasising this property (
\begin_inset Formula $Z$
\end_inset

 is for zero).
 The following result is a classic.
 For a rigorous proof can be found 
\begin_inset CommandInset citation
LatexCommand citet
after "theorem 3.3.1"
key "van1996weak"

\end_inset


\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:Z estimators"

\end_inset

Assume 
\begin_inset Formula $Pm_{\theta}$
\end_inset

 is differentiable at 
\begin_inset Formula $\theta_{0}$
\end_inset

 with a non-singular Hessian 
\begin_inset Formula $J$
\end_inset

, and 
\begin_inset Formula $K=Pm_{\theta}m_{\theta}^{T}$
\end_inset

 exists.
 Also assume some regularity conditions, most importantly that 
\begin_inset Formula $m_{\theta}$
\end_inset

 is differentiable at 
\begin_inset Formula $\theta_{0}$
\end_inset

.
 Then 
\begin_inset Formula $\sqrt{n}(\widehat{\theta}-\theta)\tod N(0,J^{-1}KJ^{-1})$
\end_inset

.
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $h=\theta-\theta_{0}$
\end_inset

.
 Under some regularity and smoothness conditions we have 
\begin_inset Formula 
\begin{eqnarray*}
nP_{n}m_{\theta} & = & \sum_{i=1}^{n}m_{\theta}(X_{i})\\
 & \approx & \sum_{i=1}^{n}m_{\theta_{0}}(X_{i})+U(X_{i};\theta_{0})h+\frac{1}{2}h^{T}Jh+o(h^{2}),
\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $U=\frac{d}{d\theta}m_{\theta}\mid_{\theta=\theta_{0}}$
\end_inset

.
 This yields the local centred likelihood process 
\begin_inset Formula 
\begin{eqnarray*}
M_{n}(\theta) & = & nP_{n}(m_{\theta_{0}+hn^{-\frac{1}{2}}}-m_{\theta_{0}})\\
 & = & \sqrt{n}h\left[\frac{1}{n}\sum_{i=1}^{n}U(X_{i};\theta_{0})\right]-\frac{1}{2}h^{T}Jh+o(|h|^{2}).
\end{eqnarray*}

\end_inset

This process converges to 
\begin_inset Formula $h^{T}Z-\frac{1}{2}h^{T}Jh$
\end_inset

, with 
\begin_inset Formula $Z\sim N(0,K)$
\end_inset

 and 
\begin_inset Formula $K=\textrm{Var}U(X,\theta_{0})$
\end_inset

.
 Taking the derivative, we get 
\begin_inset Formula $KZ=Jh,$
\end_inset

 hence 
\begin_inset Formula $h=J^{-1}Z$
\end_inset

 maximises it, and 
\begin_inset Formula $\sqrt{n}(\widehat{\theta}-\theta_{0})\tod N(0,J^{-1}KJ^{-1})$
\end_inset

.
 
\end_layout

\begin_layout Standard
The matrix 
\begin_inset Formula $J^{-1}KJ^{-1}$
\end_inset

 is often called the 
\emph on
sandwich matrix
\emph default
, and be put to use as a model robust covariance matrix in maximum likelihood
 estimation.
 In the special case when 
\begin_inset Formula $m_{\theta}=\log g(\theta)$
\end_inset

, for some density 
\begin_inset Formula $g$
\end_inset

, we obtain the classical limit result on maximum likelihood estimators
 as a corollary.
 If 
\begin_inset Formula $g=f$
\end_inset

, where 
\begin_inset Formula $f$
\end_inset

 is the true model density, 
\begin_inset Formula $J=K$
\end_inset

 and we obtain the well-known limit 
\begin_inset Formula $\sqrt{n}(\widehat{\theta}-\theta_{0})\tod N(0,J^{-1})$
\end_inset

.
\end_layout

\begin_layout Standard
Our investigations will deal with 
\begin_inset Formula $M$
\end_inset

-estimators where the smoothness assumption on 
\begin_inset Formula $m_{\theta}$
\end_inset

 does not hold.
 The estimators will have associated criterion functions 
\begin_inset Formula $m_{\theta}$
\end_inset

 such that 
\begin_inset Formula $P_{n}m_{\theta}=n^{-1}\sum_{i=1}^{n}m_{\theta}(X_{i})$
\end_inset

 is very jagged and far from being differentiable.
 Still, importantly, we will require that the 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 objective 
\begin_inset Formula $Pm_{\theta}=\int m_{\theta}dP$
\end_inset

 is differentiable.
 In order for this to be the case, 
\begin_inset Formula $P$
\end_inset

 will have to be sufficiently smooth.
 
\end_layout

\begin_layout Subsection
Heuristics and examples
\begin_inset CommandInset label
LatexCommand label
name "sub:Heuristics-and-examples"

\end_inset


\end_layout

\begin_layout Standard
Now we will turn to a discussion of the heuristics of cube root asymptotics,
 as discussed in 
\begin_inset CommandInset citation
LatexCommand cite
after "p. 193"
key "kim1990cube"

\end_inset

.
 In the process we derive the limit distribution of the sample median and
 
\emph on
Chernoff's mode estimator
\emph default
.
 The median is natural to spend some time on: First of all, it appears non-smoot
h, it has a small solution space, is very robust, and forms the basis of
 the least median of squares regression estimator (which has cube root asymptoti
cs).
 Chernoff's mode estimator is the simplest cube root estimator, and the
 basis of Kim and Pollard's (ibid.) cube root intuition.
\end_layout

\begin_layout Standard
We begin by characterising the sample median as an 
\begin_inset Formula $\argmin$
\end_inset

.
 The mean is the 
\begin_inset Formula $\argmin$
\end_inset

 of 
\begin_inset Formula $\theta\mapsto E(X-\theta)^{2}$
\end_inset

: Use the decomposition 
\begin_inset Formula $E(X-\theta)^{2}=E(X-\mu)^{2}+2(\mu-\theta)E(X-\mu)+(\mu-\theta)^{2}$
\end_inset

 and take the derivative with respect to 
\begin_inset Formula $\theta$
\end_inset

.
 Perhaps less intuitively, the median is the 
\begin_inset Formula $\argmin$
\end_inset

 of 
\begin_inset Formula $\theta\mapsto E|X-\theta|$
\end_inset

, due to this well known fact.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:Median objective"

\end_inset

Let 
\begin_inset Formula $X\sim F$
\end_inset

, where 
\begin_inset Formula $F$
\end_inset

 is a distribution with a density in a neighbourhood of 
\begin_inset Formula $f(\theta_{0})$
\end_inset

, 
\begin_inset Formula $\theta_{0}$
\end_inset

 being the median of 
\begin_inset Formula $F$
\end_inset

.
 Then 
\begin_inset Formula $\theta_{0}=\argmin E(|X-\theta|)$
\end_inset

.
 
\end_layout

\begin_layout Proof
Observe that 
\begin_inset Formula 
\begin{eqnarray*}
E(|X-\theta|) & = & \int_{\theta}^{\infty}(x-\theta)dF(x)+\int_{-\infty}^{\theta}(\theta-x)dF(x),\\
 & = & \int_{\theta}^{\infty}xdF(x)-\int_{-\infty}^{\theta}xdF(x)+\theta(2F(\theta)-1).
\end{eqnarray*}

\end_inset

Since 
\begin_inset Formula $\frac{d}{d\theta}\int_{\theta}^{\infty}xdF(x)=-\frac{d}{d\theta}\int_{-\infty}^{\theta}xdF(x)=\theta f(\theta)$
\end_inset

, this function is differentiable at 
\begin_inset Formula $\theta_{0}$
\end_inset

 with derivative
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
-2\theta f(\theta)+(2F(\theta)-1)+2\theta f(\theta)=(2F(\theta)-1),
\]

\end_inset

consequently 
\begin_inset Formula $F(\theta_{0})=\frac{1}{2}$
\end_inset

 as claimed.
\end_layout

\begin_layout Standard
Define 
\begin_inset Formula $m_{\theta}=|\cdot-\theta|$
\end_inset

.
 As above, 
\begin_inset Formula $\theta_{0}$
\end_inset

 is the true median in the following theorem.
 The content of this theorem is well known, but this proof is the work of
 the author.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:median theorem"

\end_inset

Let 
\begin_inset Formula $\widehat{\theta}$
\end_inset

 be the sample median obtained from 
\begin_inset Formula $X_{1},...,X_{n}$
\end_inset

 i.i.d.
 copies from a distribution 
\begin_inset Formula $F$
\end_inset

 with a non-zero density in the neighbourhood of the median.
 In this case, 
\begin_inset Formula 
\[
n^{\frac{1}{2}}(\widehat{\theta}-\theta_{0})\tod N(0,(2f(\theta_{0})^{-2}).
\]

\end_inset


\end_layout

\begin_layout Proof
For simplicity we assume, throughout this proof, that 
\begin_inset Formula $\theta>\theta_{0}$
\end_inset

.
 By decomposing the sum of 
\begin_inset Formula $P_{n}m_{\theta}$
\end_inset

 as in Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Median objective"

\end_inset

, we obtain
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\frac{1}{n}\sum_{i=1}^{n}|X_{i}-\theta|=\frac{1}{n}\left[\sum_{X_{i}>\theta}X_{i}-\sum_{X_{i}<\theta}X_{i}+\theta(2\#\left\{ \theta>X_{i}\right\} -n)\right].
\]

\end_inset

Define lower, middle and upper random variables as follows:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
L & = & \#\left\{ \theta_{0}>X_{i}\right\} ,\\
M & = & \#\left\{ \theta>X_{i}>\theta_{0}\right\} ,\\
U & = & \#\left\{ X_{i}>\theta\right\} .
\end{eqnarray*}

\end_inset

We can understand 
\begin_inset Formula $(L,M,U)$
\end_inset

 as an 
\begin_inset Formula $n$
\end_inset

-multinomial vector with cell probabilities 
\begin_inset Formula $F(\theta_{0}),\: F(\theta)-F(\theta_{0}),$
\end_inset

 and 
\begin_inset Formula $1-F(\theta)$
\end_inset

.
 Take note of the following, Taylor-derived observation: When 
\begin_inset Formula $\theta\approx\theta_{0}$
\end_inset

, the cell probability of 
\begin_inset Formula $M$
\end_inset

 is approximately 
\begin_inset Formula $f(\theta_{0})(\theta-\theta_{0})$
\end_inset

.
 By simple reasoning, 
\begin_inset Formula $Y_{n}=P_{n}m_{\theta}-P_{n}m_{\theta_{0}}$
\end_inset

 can be identified as
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
Y_{n} & = & 2\sum_{\theta>X_{i}>\theta_{0}}(\theta-X_{k_{i}})+(\theta-\theta_{0})(2L-n),
\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $k_{i}$
\end_inset

 are the indices of those 
\begin_inset Formula $X_{j}$
\end_inset

 satisfying 
\begin_inset Formula $\theta>X_{j}>\theta_{0}$
\end_inset

.
 Then 
\begin_inset Formula $X_{k_{j}}$
\end_inset

 is distributed according to the density 
\begin_inset Formula $f(x)1_{[\theta_{0},\theta]}(F(\theta)-F(\theta_{0}))^{-1}$
\end_inset

, which equals 
\begin_inset Formula $(\theta-\theta_{0})^{-1}1_{[\theta_{0},\theta]}$
\end_inset

 when 
\begin_inset Formula $\theta_{0}\approx\theta$
\end_inset

 by Taylor expansion.
 Thus 
\begin_inset Formula $\theta-X_{j}\sim\mathcal{U}(\theta_{0},\theta)$
\end_inset

.
 Denote these variables 
\begin_inset Formula $(\theta-\theta_{0})V_{j}$
\end_inset

, and use this to rewrite 
\begin_inset Formula $\frac{1}{n}Y_{n}$
\end_inset

 as
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\frac{1}{n}Y_{n}=\frac{1}{n}2(\theta-\theta_{0})\sum_{i=1}^{M}V_{j}+\frac{1}{n}2(\theta-\theta_{0})(L-0.5n).
\]

\end_inset

Since 
\begin_inset Formula $EM=nf(\theta_{0})(\theta-\theta_{0})$
\end_inset

 and 
\begin_inset Formula $EV_{i}=\frac{1}{2}$
\end_inset

, we get 
\begin_inset Formula 
\[
E[\frac{1}{n}2(\theta-\theta_{0})\sum_{i=1}^{M}V_{i}]=f(\theta_{0})(\theta-\theta_{0})^{2}.
\]

\end_inset

An application of the law of total variance gives us
\begin_inset Formula 
\begin{eqnarray*}
\mathrm{Var}(\sum_{i=1}^{M}V_{i}) & = & E(\mathrm{Var}(\sum_{i=1}^{M}V_{i})|M)+\mathrm{Var}(E(\sum_{i=1}^{M}V_{i})|M)\\
 & = & nf(\theta_{0})(\theta-\theta_{0})12^{-1}+4^{-1}nf(\theta_{0})(\theta-\theta_{0})(1-f(\theta_{0})(\theta-\theta_{0}))\\
 & = & 3^{-1}nf(\theta_{0})(\theta-\theta_{0}).
\end{eqnarray*}

\end_inset

Where the higher order terms are discarded.
 Hence 
\begin_inset Formula 
\[
\mathrm{Var}[\frac{1}{n}2(\theta-\theta_{0})\sum_{i=1}^{M}V_{i}]=\frac{4}{3n}f(\theta_{0})(\theta-\theta_{0})^{3}.
\]

\end_inset

The term 
\begin_inset Formula $\frac{1}{n}2(\theta-\theta_{0})(L-0.5n)$
\end_inset

 is easily seen to be normally distributed in the limit: 
\begin_inset Formula 
\[
\frac{1}{n}2(\theta-\theta_{0})(L-0.5n)\sim N(0,n{}^{-1}(\theta-\theta_{0})^{2}).
\]

\end_inset

Now we find the covariance between 
\begin_inset Formula $X=\frac{1}{n}2(\theta-\theta_{0})\sum_{i=1}^{M}V_{j}$
\end_inset

 and 
\begin_inset Formula $Y=\frac{1}{n}2(\theta-\theta_{0})(L-0.5n)$
\end_inset

 by using the law of total covariance,
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\mathrm{Cov}(X,Y)=E(\mathrm{Cov(X,Y\mid M))+\mathrm{Cov}(E(X\mid M),\mathrm{Cov}(E(Y\mid M))}.
\]

\end_inset

Here 
\begin_inset Formula $E(\mathrm{Cov(X,Y\mid M))}=0$
\end_inset

, as 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are conditionally independent given 
\begin_inset Formula $M$
\end_inset

.
 Clearly, 
\begin_inset Formula $E(X\mid M)=\frac{1}{n}(\theta-\theta_{0})M$
\end_inset

.
 Since 
\begin_inset Formula 
\begin{eqnarray*}
E(Y\mid M) & = & \frac{1}{n}2(\theta-\theta_{0})(\frac{F(\theta_{0})}{1-(F(\theta)-F(\theta_{0}))})(n-M)-0.5n)\\
 & = & \frac{1}{n}2(\theta-\theta_{0})(\frac{F(\theta_{0})}{1-f(\theta_{0})(\theta-\theta_{0})})(n-M)-0.5n),
\end{eqnarray*}

\end_inset

and
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\mathrm{Var}M\approx nf(\theta_{0})(\theta-\theta_{0})(1-f(\theta_{0})(\theta-\theta_{0})),
\]

\end_inset

we obtain
\begin_inset Formula 
\begin{eqnarray*}
\mathrm{Cov}(X,Y) & = & -\frac{2}{n^{2}}(\theta-\theta_{0})^{2}F(\theta_{0})\mathrm{Var}M,\\
 & \approx & -\frac{2}{n}(\theta-\theta_{0})^{3}F(\theta_{0})f(\theta_{0}).
\end{eqnarray*}

\end_inset

Notice that the variance of 
\begin_inset Formula $X$
\end_inset

 is of higher order than the variance of 
\begin_inset Formula $Y$
\end_inset

.
 Since the covariance is equally negligible, we obtain
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\frac{1}{n}Y_{n}(\theta)\approx f(\theta_{0})(\theta-\theta_{0})^{2}+n^{-\frac{1}{2}}(\theta-\theta_{0})Z,
\]

\end_inset

where 
\begin_inset Formula $Z\sim N(0,1)$
\end_inset

 is the same across all 
\begin_inset Formula $\theta$
\end_inset

s sufficiently close to 
\begin_inset Formula $\theta_{0}$
\end_inset

.
 The case when 
\begin_inset Formula $\theta<\theta_{0}$
\end_inset

 is similar and is omitted.
\end_layout

\begin_layout Proof
Now make the substitution 
\begin_inset Formula $t=|\theta-\theta_{0}|$
\end_inset

 and differentiate 
\begin_inset Formula $\frac{1}{n}Y_{n}$
\end_inset

 with respect to 
\begin_inset Formula $t$
\end_inset

.
 This yields 
\begin_inset Formula $2f(\theta_{0})t+\frac{1}{2}n^{-\frac{1}{2}}Z,$
\end_inset

 which has its root at 
\begin_inset Formula $n^{\frac{1}{2}}t=-\frac{1}{2f(\theta_{0})}Z.$
\end_inset

 Hence 
\begin_inset Formula $n^{\frac{1}{2}}(\widehat{\theta}-\theta)\sim N(0,(2f(\theta))^{-2})$
\end_inset

, as claimed.
\end_layout

\begin_layout Standard
Importantly, the 
\begin_inset Formula $Z$
\end_inset

 in the previous proposition is constant across all 
\begin_inset Formula $\theta$
\end_inset

 --- there is one dominating source of randomness, and it doesn't change
 with 
\begin_inset Formula $\theta$
\end_inset

.
 This happens because we manage to decompose the process into two parts,
 one of which has higher order variance than the other, where the dominating
 part depends linearly on 
\begin_inset Formula $\theta$
\end_inset

.
 The kind of decomposition we arrived at in this theorem is impossible for
 cube root asymptotics: The Brownian motions that typically appear are witnesses
 to this fact, the 
\begin_inset Quotes eld
\end_inset

dominating randomness
\begin_inset Quotes erd
\end_inset

 does not depend linearly on 
\begin_inset Formula $\theta$
\end_inset

 in this case.
\end_layout

\begin_layout Standard
A slight modification of the process above turns it into an 
\begin_inset Quotes eld
\end_inset

argmax
\begin_inset Quotes erd
\end_inset

-process: 
\begin_inset Formula $-f(\theta_{0})(\theta-\theta_{0})^{2}+n^{-\frac{1}{2}}(\theta-\theta_{0})Z$
\end_inset

.
 This is a special case of the more general type of expression 
\begin_inset Formula $U_{n}(\theta)=-c_{1}(\theta-\theta_{0})^{2}+c_{2}n^{-\frac{1}{2}}(\theta-\theta_{0})Z_{\theta}$
\end_inset

, where 
\begin_inset Formula $c_{1}>0,c_{2}$
\end_inset

 are constants and 
\begin_inset Formula $Z_{\theta}$
\end_inset

 is an asymptotically normally distributed variable which might depend on
 
\begin_inset Formula $\theta$
\end_inset

.
 For 
\begin_inset Formula $t=(\theta-\theta_{0})$
\end_inset

 to maximise 
\begin_inset Formula $U_{n}$
\end_inset

, it has to strike a balance between the negative contribution of 
\begin_inset Formula $c_{1}t^{2}$
\end_inset

 and the positive contribution of 
\begin_inset Formula $c_{2}n^{-\frac{1}{2}}(\theta-\theta_{0})Z_{\theta}$
\end_inset

.
 When is this likely to happen? If 
\begin_inset Formula $|\theta-\theta_{0}|$
\end_inset

 gets too large, 
\begin_inset Formula $c_{1}$
\end_inset

 will make the value too small; if 
\begin_inset Formula $|\theta-\theta_{0}|$
\end_inset

 is too small, there will not be enough positive contribution from
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $c_{2}n^{-\frac{1}{2}}|Z_{\theta}|$
\end_inset

.
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
When 
\begin_inset Formula $(\theta-\theta_{0})=tn^{-\frac{1}{2}}$
\end_inset

 is of the order 
\begin_inset Formula $n^{-\frac{1}{2}}$
\end_inset

, the contribution of each side equalises: 
\begin_inset Formula $U_{n}(tn^{-\frac{1}{2}})=n^{-1}\left(c_{1}t^{2}-c_{2}tZ_{tn^{-\frac{1}{2}}+\theta_{0}}\right)$
\end_inset

, but any other choice of 
\begin_inset Formula $\alpha$
\end_inset

 in 
\begin_inset Formula $n^{-\alpha}$
\end_inset

 will put too much weight on either side.
 We will see this rate intuition at work for cube root asymptotics soon.
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/MedianProcess.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Simulated example of the true median process 
\begin_inset Formula $P_{n}(m_{\theta}-m_{\theta_{0}})$
\end_inset

 along with the approximation in Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:median theorem"

\end_inset

.
 We simulate 
\begin_inset Formula $n=100,500,1000,10000$
\end_inset

 observations from 
\begin_inset Formula $N(0,1)$
\end_inset

 and calculate the approximation and the true process:
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citet
key "chernoff1964estimation"

\end_inset

, an estimator of the mode was introduced.
 Let 
\begin_inset Formula $F$
\end_inset

 be a unimodal, smooth density on 
\begin_inset Formula $\mathbb{R}$
\end_inset

, and let 
\begin_inset Formula $\alpha>0$
\end_inset

 be given.
 Let 
\begin_inset Formula $P_{n}$
\end_inset

 be the empirical distribution of 
\begin_inset Formula $X_{1},X_{2},...,X_{n}\stackrel{i.i.d.}{\sim}F$
\end_inset

, as usual.
 Chernoff's estimator is then defined as 
\begin_inset Formula $\widehat{\theta}=\argmax_{x\in\mathbb{R}}P_{n}[x-\frac{1}{2}\alpha,x+\frac{1}{2}\alpha]$
\end_inset

.
 The interpretation is simple: For each 
\begin_inset Formula $x\in\mathbb{R}$
\end_inset

, the interval 
\begin_inset Formula $[x-\frac{1}{2}\alpha,x+\frac{1}{2}\alpha]$
\end_inset

 contains a fixed number of observations from 
\begin_inset Formula $P_{n}$
\end_inset

, and 
\begin_inset Formula $\widehat{\theta}$
\end_inset

 is the centre of the interval of this form which contains the highest number
 of observations.
 If 
\begin_inset Formula $\alpha$
\end_inset

 is small enough and 
\begin_inset Formula $F$
\end_inset

 is symmetric around its mode, 
\begin_inset Formula $x_{0}=\argmax_{x\in\mathbb{R}}P[x-\frac{1}{2}\alpha,x+\frac{1}{2}\alpha]$
\end_inset

 is the mode 
\begin_inset Formula $F$
\end_inset

.
 In this case, 
\begin_inset Formula $f(x-\frac{1}{2}\alpha)=f(x+\frac{1}{2}\alpha)$
\end_inset

.
 We assume that 
\begin_inset Formula $f'$
\end_inset

 exists.
 Notice that 
\begin_inset Formula $P[x-\frac{1}{2}\alpha,x+\frac{1}{2}\alpha]$
\end_inset

 is smooth in 
\begin_inset Formula $\alpha$
\end_inset

, but 
\begin_inset Formula $P_{n}[x-\frac{1}{2}\alpha,x+\frac{1}{2}\alpha]$
\end_inset

 is not.
 
\end_layout

\begin_layout Standard
Now we present an heuristic proof of the limiting distribution of Chernoff's
 mode estimator, which is copied from 
\begin_inset CommandInset citation
LatexCommand cite
key "chernoff1964estimation"

\end_inset

.
 For a formal derivation, see 
\begin_inset CommandInset citation
LatexCommand citet
after "example 3.2.13"
key "van1996weak"

\end_inset

.
 We will make use of the distribution of 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\argmax_{x\in\mathbb{R}}\left[W(x)-x^{2}\right],\label{eq:W(x)-x^2}
\end{equation}

\end_inset

where 
\begin_inset Formula $W$
\end_inset

 is a two-sided Brownian motion originating from 
\begin_inset Formula $0$
\end_inset

.
 This will be denoted 
\begin_inset Formula $Z$
\end_inset

 and is called Chernoff's distribution in the literature 
\begin_inset CommandInset citation
LatexCommand citep
key "groeneboom2001computing"

\end_inset

, the name deriving from its first appearance in 
\begin_inset CommandInset citation
LatexCommand citet
key "chernoff1964estimation"

\end_inset

.
 We will see this distribution several times throughout the course of this
 thesis.
 It is symmetric around 
\begin_inset Formula $0$
\end_inset

 and is bell-curved.
 It is reasonably well approximated by 
\begin_inset Formula $N(0,0.52^{2})$
\end_inset

, see Figure 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "fig:The--density-and"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/ChernoffVsNormal.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:The--density-and"

\end_inset

The 
\begin_inset Formula $N(0,.52^{2})$
\end_inset

-density and Chernoff's density obtained through simulations.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

We will typically encounter distributions of the form 
\begin_inset Formula $\argmax_{x\in\mathbb{R}}\left[aW(x)-bx^{2}\right]$
\end_inset

.
 An argument based on the concept of Brownian scaling 
\begin_inset CommandInset citation
LatexCommand citet
after "p. 504"
key "billingsley2008probability"

\end_inset

: For any 
\begin_inset Formula $c>0$
\end_inset

, 
\begin_inset Formula $c^{-1}W(c^{2}x)=W(x)$
\end_inset

.
 The following trick was first observed by 
\begin_inset CommandInset citation
LatexCommand citet
key "chernoff1964estimation"

\end_inset

.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:Chernoff trick"

\end_inset

Let 
\begin_inset Formula $Z$
\end_inset

 be Chernoff's distribution, and 
\begin_inset Formula $Y=\argmax_{x\in\mathbb{R}}\left[aW(x)-bx^{2}\right]$
\end_inset

.
 In that case, 
\begin_inset Formula $Y$
\end_inset

 and 
\begin_inset Formula $(\frac{b}{a})^{\frac{2}{3}}Z$
\end_inset

 have the same distribution.
\end_layout

\begin_layout Proof
We will find a 
\begin_inset Formula $c$
\end_inset

 such that 
\begin_inset Formula $z$
\end_inset

 maximises 
\begin_inset Formula $W(x)-x^{2}$
\end_inset

 if and only if 
\begin_inset Formula $cz$
\end_inset

 maximises 
\begin_inset Formula $aW(x)-bx^{2}.$
\end_inset

 We can do this by making 
\begin_inset Formula $aW(xc)-c^{2}x^{2}\propto W(x)-x^{2}.$
\end_inset

 By Brownian scaling 
\begin_inset Formula $aW(xc)=ac^{\frac{1}{2}}W(x)-bx^{2}c^{2}$
\end_inset

.
 The proportionality requirement is fulfilled when 
\begin_inset Formula $ac^{\frac{1}{2}}=bc^{2},$
\end_inset

 which has solution 
\begin_inset Formula $c=(\frac{b}{a})^{\frac{2}{3}}$
\end_inset

.
\end_layout

\begin_layout Standard
we will also make use of one the heuristic interpretations of a Brownian
 motion (see 
\begin_inset CommandInset citation
LatexCommand citet
after "chapter 10"
key "ross2014introduction"

\end_inset

).
 Let 
\begin_inset Formula $X_{i}$
\end_inset

 be distributed according to
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
P(X_{i}=-1) & = & \frac{1}{2},\\
P(X_{i}=1) & = & \frac{1}{2}.
\end{eqnarray*}

\end_inset

This distribution is called the 
\emph on
Rademacher distribution.
 
\emph default
Define a process, 
\begin_inset Formula 
\[
X(t)=\Delta x\sum_{i=1}^{\lfloor t/\Delta t\rfloor}X_{i},
\]

\end_inset

where 
\begin_inset Formula $\Delta t$
\end_inset

 is the time increment and 
\begin_inset Formula $\Delta x$
\end_inset

 is the space increment.
 Let 
\begin_inset Formula $\Delta x=\sigma\sqrt{\Delta t}$
\end_inset

 for some 
\begin_inset Formula $\sigma$
\end_inset

, and let 
\begin_inset Formula $\Delta t\to0$
\end_inset

.
 The resulting processes exists and is a Brownian motion with standard deviation
 
\begin_inset Formula $\sigma.$
\end_inset

 
\end_layout

\begin_layout Theorem
Assume the above conditions, and let 
\begin_inset Formula $\widehat{\theta}$
\end_inset

 be Chernoff's estimator, and 
\begin_inset Formula $\theta_{0}$
\end_inset

 be the mode.
 Its limiting distribution is given by
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
n^{\frac{1}{3}}(\widehat{\theta}-\theta_{0})\tod\tau^{\frac{1}{3}}Z,
\]

\end_inset

where 
\begin_inset Formula $\tau=\frac{8f\left(x_{0}+\frac{1}{2}\alpha\right)}{\left[f'(x_{0}-\frac{1}{2}\alpha)-f'(x_{0}+\frac{1}{2}\alpha)\right]^{2}}$
\end_inset

.
\end_layout

\begin_layout Proof
Denote 
\begin_inset Formula 
\[
Z_{n}=P_{n}\left[x-\frac{1}{2}\alpha,x+\frac{1}{2}\alpha\right]-P_{n}\left[x_{0}-\frac{1}{2}\alpha,x_{0}+\frac{1}{2}\alpha\right].
\]

\end_inset

We decompose this into
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
Z_{n}=n^{-\frac{1}{2}}Y_{n}+u,
\]

\end_inset

where
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
n^{-\frac{1}{2}}Y_{n}=\left(P_{n}-P\right)\left[x-\frac{1}{2}\alpha,x+\frac{1}{2}\alpha\right]-\left(P_{n}-P\right)\left[x_{0}-\frac{1}{2}\alpha,x_{0}+\frac{1}{2}\alpha\right]
\]

\end_inset

and
\begin_inset Formula 
\[
u=P\left[x-\frac{1}{2}\alpha,x+\frac{1}{2}\alpha\right]-P\left[x_{0}-\frac{1}{2}\alpha,x_{0}+\frac{1}{2}\alpha\right].
\]

\end_inset

Here 
\begin_inset Formula $u$
\end_inset

 is the 
\emph on
actual deviation
\emph default
, as seen from the true 
\begin_inset Formula $P$
\end_inset

, while 
\begin_inset Formula $n^{-\frac{1}{2}}Y_{n}$
\end_inset

 represents the 
\emph on
random deviation
\emph default
.
 We can approximate 
\begin_inset Formula $u$
\end_inset

 by a second order Taylor expansion: 
\begin_inset Formula 
\begin{eqnarray*}
 &  & P\left[x-\frac{1}{2}\alpha,x+\frac{1}{2}\alpha\right]-P\left[x_{0}-\frac{1}{2}\alpha,x_{0}+\frac{1}{2}\alpha\right]\\
 & = & [F(x+\frac{1}{2}\alpha)-F(x_{0}+\frac{1}{2}\alpha)]-[F(x-\frac{1}{2}\alpha)-F(x_{0}-\frac{1}{2}\alpha)]\\
 & \approx & -\frac{1}{2}(f'(x_{0}-\frac{1}{2}\alpha)-f'(x_{0}+\frac{1}{2}\alpha))(x-x_{0}){}^{2},
\end{eqnarray*}

\end_inset

where we use that 
\begin_inset Formula $f(x_{0}+a)-f(x_{0}-a)=0$
\end_inset

, which makes the first order terms cancel.
 Now we consider 
\begin_inset Formula 
\[
n^{\frac{1}{2}}Y_{n}=n\left(P_{n}-P\right)\left[x-\frac{1}{2}\alpha,x+\frac{1}{2}\alpha\right]-n\left(P_{n}-P\right)\left[x_{0}-\frac{1}{2}\alpha,x_{0}+\frac{1}{2}\alpha\right].
\]

\end_inset

This process can be rewritten in two ways, depending on whether 
\begin_inset Formula $x\leq x_{0}$
\end_inset

 or 
\begin_inset Formula $x>x_{0}$
\end_inset

.
 If 
\begin_inset Formula $x\leq x_{0}$
\end_inset

,
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
n^{\frac{1}{2}}Y_{n}\left(x\right)=n\left(P_{n}-P\right)\left[x+\frac{1}{2}\alpha,x_{0}+\frac{1}{2}\alpha\right]-n\left(P_{n}-P\right)\left[x-\frac{1}{2}\alpha,x_{0}-\frac{1}{2}\alpha\right],
\]

\end_inset

and if 
\begin_inset Formula $x>x_{0}$
\end_inset

,
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
n^{\frac{1}{2}}Y_{n}\left(x\right) & = & n\left(P_{n}-P\right)\left[x_{0}+\frac{1}{2}\alpha,x+\frac{1}{2}\alpha\right]-n\left(P_{n}-P\right)\left[x_{0}-\frac{1}{2}\alpha,x-\frac{1}{2}\alpha\right].
\end{eqnarray*}

\end_inset

We assume 
\begin_inset Formula $x>x_{0}$
\end_inset

 and 
\begin_inset Formula $x\approx x_{0}$
\end_inset

 from now on, and put 
\begin_inset Formula $t=(x-x_{0})$
\end_inset

.
 This process counts the deviation from expectation in 
\begin_inset Formula $\left[x_{0}+\frac{1}{2}\alpha,x+\frac{1}{2}\alpha\right]$
\end_inset

 and subtracts the deviation from expectation in the disjoint interval 
\begin_inset Formula $\left[x_{0}-\frac{1}{2}\alpha,x_{0}-\frac{1}{2}\alpha\right]$
\end_inset

.
 These counts are approximately independent, and if we increase 
\begin_inset Formula $x$
\end_inset

 a little bit, there is an equal probability of adding one as subtracting
 one, provided the distribution is approximately symmetric close to the
 mode.
 The expected value of each interval is 
\begin_inset Formula $0$
\end_inset

 while each of their variances are approximately 
\begin_inset Formula $n(x-x_{0})f(x_{0}+a)=n(x-x_{0})f(x_{0}-a)$
\end_inset

 by a first order Taylor expansion:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray}
\textrm{Var}n^{\frac{1}{2}}Y_{n}\left(t+x_{0}\right) & = & \textrm{Var}\left[\sum_{i=1}^{n}\left(1_{\left[x_{0}+\frac{1}{2}\alpha,x+\frac{1}{2}\alpha\right]}(X_{i})-1_{\left[x_{0}-\frac{1}{2}\alpha,x-\frac{1}{2}\alpha\right]}(X_{i})\right)\right]\nonumber \\
 & = & P\left[x_{0}+\frac{1}{2}\alpha,x+\frac{1}{2}\alpha\right]+P\left[x_{0}-\frac{1}{2}\alpha,x-\frac{1}{2}\alpha\right]\nonumber \\
 & \approx & 2ntf(x_{0}-\frac{1}{2}\alpha),\label{eq:First order terms won't cancel}
\end{eqnarray}

\end_inset

Thus the process 
\begin_inset Formula $Y_{n}$
\end_inset

 looks like it tends to a two-sided Brownian motion with variance 
\begin_inset Formula $2f(x_{0}+\frac{1}{2}\alpha)=2f(x_{0}-\frac{1}{2}\alpha)$
\end_inset

 per unit 
\begin_inset Formula $t$
\end_inset

.
 From this we find that 
\begin_inset Formula $Z_{n}\approx n^{-\frac{1}{2}}\sqrt{2f\left(x_{0}+a\right)}W(t)-\frac{1}{2}Vt^{2}$
\end_inset

, where 
\begin_inset Formula $V=f'(x_{0}-a)-f'(x_{0}+a)$
\end_inset

.
 Furthermore, 
\begin_inset Formula $\widehat{x}\approx\argmax_{t}Z_{n}$
\end_inset

, where 
\begin_inset Formula $W\left(t\right)$
\end_inset

 is a standard two-sided Brownian motion starting in 
\begin_inset Formula $0$
\end_inset

.
 Using the trick in the previous proposition we obtain
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
c=n^{-\frac{1}{3}}\left(\frac{8f\left(x_{0}+a\right)}{V^{2}}\right)^{\frac{1}{3}}.
\]

\end_inset

It follows that 
\begin_inset Formula $n^{\frac{1}{3}}(\widehat{x}-x_{0})\tod\tau^{\frac{1}{3}}Z$
\end_inset

, where 
\begin_inset Formula $\tau=\frac{8f\left(x_{0}+a\right)}{V^{2}}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Comparing this work to that of the median, there are two important differences.
 First, there is no unique source of randomness across all 
\begin_inset Formula $\theta$
\end_inset

s, instead we must take the maximum over a Brownian motion with parabolic
 drift.
 Second, the argument for 
\begin_inset Formula $n^{-\frac{1}{2}}$
\end_inset

 rate doesn't fall through.
 This is because the standard deviation of the random part 
\begin_inset Formula $n^{-\frac{1}{2}}\sqrt{2f\left(x_{0}+a\right)}W(y)$
\end_inset

 is of too small order, only 
\begin_inset Formula $\sqrt{\theta-\theta_{0}}$
\end_inset

.
 More generally, assume the limit process has the form 
\begin_inset Formula $c_{1}(\theta-\theta_{0})^{2}+n^{-\frac{1}{2}}c_{2}\sqrt{\theta-\theta_{0}}Z_{\theta}$
\end_inset

 for some constants 
\begin_inset Formula $c_{1}<0,c_{2}$
\end_inset

.
 In order to carry through the equalisation mentioned below Theorem 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "thm:median theorem"

\end_inset

 on the median, 
\begin_inset Formula $\theta-\theta_{0}=tn^{-\frac{1}{3}}$
\end_inset

 must be chosen.
 From this we get 
\begin_inset Formula $Z_{n}(tn^{-\frac{1}{3}})\approx n^{-\frac{2}{3}}(c_{1}t^{2}+c_{2}\sqrt{t}Z_{\theta}).$
\end_inset

 This is the intuition behind cube root asymptotics offered by Kim & Pollard
 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "kim1990cube"

\end_inset

.
 It happens when the first order terms of the variance in the random deviation
 part of 
\begin_inset Formula $P_{n}(m_{\theta}-m_{\theta_{0}})$
\end_inset

 will not cancel, as in equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:First order terms won't cancel"

\end_inset

.
\end_layout

\begin_layout Subsection
Consistency
\end_layout

\begin_layout Standard
In the Donsker and Glivenko-Cantelli results, we were concerned with uniform
 convergence over the whole space: E.g., 
\begin_inset Formula $n^{-\frac{1}{2}}(F_{n}-F)\tod\mathbb{G}$
\end_inset

 concerns the uniform convergence over 
\begin_inset Formula $\mathbb{R}$
\end_inset

.
 In our case, we're not interested in uniform convergence per se, only the
 continuity of the argmax functional: When 
\begin_inset Formula $M_{n}\to M$
\end_inset

 uniformly, it seems intuitively clear that 
\begin_inset Formula $\argmax M_{n}\tod\argmax M$
\end_inset

, but we only require that 
\begin_inset Formula $M_{n}\to M$
\end_inset

 uniformly on compacta.
 In our applications, 
\begin_inset Formula $M_{n}(\theta)=P_{n}m_{\theta}$
\end_inset

 and 
\begin_inset Formula $M(\theta)=Pm_{\theta}$
\end_inset

 for some criterion function 
\begin_inset Formula $m_{\theta}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The following result, a slightly modified version of 
\begin_inset CommandInset citation
LatexCommand cite
after "corollary 3.2.3, p. 287"
key "van1996weak"

\end_inset

, is a general theorem for proving consistency of 
\begin_inset Formula $M$
\end_inset

-estimators.
 The only difficult condition is the Glivenko-Cantelli condition 
\begin_inset Formula $||P_{n}m_{\theta}-Pm_{\theta}||\stackrel{P}{\to}0$
\end_inset

, which we use the bracketing entropy machinery to establish.
\end_layout

\begin_layout Theorem
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Consistency theorem
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "thm:Consistency theorem"

\end_inset

Let 
\begin_inset Formula $M_{n}$
\end_inset

 be a stochastic process index by a metric space 
\begin_inset Formula $\Theta$
\end_inset

, and let 
\begin_inset Formula $M:\theta\to\mathbb{R}$
\end_inset

 be a deterministic function.
 If 
\begin_inset Formula $||M_{n}-M||\stackrel{P}{\to}0$
\end_inset

 and 
\begin_inset Formula $\theta_{0}$
\end_inset

 is well-separated, then any sequence 
\begin_inset Formula $\widehat{\theta}_{n}$
\end_inset

 which nearly maximises 
\begin_inset Formula $\theta\mapsto M_{n}(\theta)$
\end_inset

 for any 
\begin_inset Formula $n$
\end_inset

 will be consistent for 
\begin_inset Formula $\theta_{0}$
\end_inset

.
\end_layout

\begin_layout Standard
The condition that 
\begin_inset Formula $\widehat{\theta}_{n}$
\end_inset

 nearly maximises the map 
\begin_inset Formula $\theta\to M_{n}(\theta)$
\end_inset

 is understood to mean that 
\begin_inset Formula $\widehat{\theta}_{n}\geq\argmax_{\theta}M_{n}(\theta)-o_{p}(1)$
\end_inset

, where 
\begin_inset Formula $\theta_{0}=\argmax_{\theta}M(\theta)$
\end_inset

, which we assume is identified.
 That is, we assume 
\begin_inset Formula $\theta_{0}$
\end_inset

 is a unique, global maximiser of 
\begin_inset Formula $M(\theta)$
\end_inset

.
 Also, 
\begin_inset Formula $\theta_{0}$
\end_inset

 is well-separated 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 60"
key "van2000asymptotic"

\end_inset

 if it is the unique global maximum and it can't be approximated outside
 its neighbourhoods: For all 
\begin_inset Formula $\epsilon>0$
\end_inset

, 
\begin_inset Formula $\sup_{d(\theta,\theta_{0})\geq\epsilon}M(\theta)<M(\theta_{0}).$
\end_inset

 In one dimension, this condition can be broken if there are horizontal
 asymptotes in 
\begin_inset Formula $M(\theta)$
\end_inset

.
 Notice that the condition is satisfied on compact neighbourhoods of 
\begin_inset Formula $\theta_{0}$
\end_inset

 whenever 
\begin_inset Formula $M$
\end_inset

 is continuous.
 This is because 
\begin_inset Formula $M$
\end_inset

 attains its supremum on any compact set 
\begin_inset Formula $K$
\end_inset

, hence 
\begin_inset Formula $\sup_{K\cap d(\theta,\theta_{0})\geq\epsilon}M(\theta)=\max_{K\cap d(\theta,\theta_{0})\geq\epsilon}M(\theta)<M(\theta_{0})$
\end_inset

, since 
\begin_inset Formula $\theta_{0}$
\end_inset

 is the unique maximum.
\end_layout

\begin_layout Subsection
The rate theorem
\end_layout

\begin_layout Standard
The following theorem is the most important technical tool of this thesis,
 and is almost exactly the same as Theorem 3.2.10 from 
\begin_inset CommandInset citation
LatexCommand citet
after "p. 293"
key "van1996weak"

\end_inset

.
 A similar result which only covers 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

-convergence can be found in 
\begin_inset CommandInset citation
LatexCommand cite
key "kim1990cube"

\end_inset

.
 We will have need of the additional generality of this result in Chapter
 4 on histograms.
\end_layout

\begin_layout Standard
In order to make all the uniform Lindeberg central limit theorems involved
 in this theorem work, we require the local bracketing entropy integral
 to be finite,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\int_{0}^{\infty}\sup_{\delta<\delta_{0}}\sqrt{\log N_{[]}(\epsilon||M_{\delta}||_{2},\mathcal{M}_{\delta},L_{2}(P)}d\epsilon<\infty,\label{eq:local bracketing entropy integral condition}
\end{equation}

\end_inset

where 
\begin_inset Formula $M_{\delta}$
\end_inset

 is an envelope for 
\begin_inset Formula $F_{\delta}$
\end_inset

, and 
\begin_inset Formula $\mathcal{M}_{\delta}=\left\{ m_{\theta}-m_{\theta_{0}}\mid d(\theta,\theta_{0})\leq\delta\right\} $
\end_inset

.
 We will not deal with this condition in any detail, as it is not very enlighten
ing and quite tedious.
 This condition can be replaced with a uniform entropy integral condition,
 which can be verified by establishing bounds on the Vapnik-Chervonenkis
 dimension of 
\begin_inset Formula $\mathcal{M}_{\delta}$
\end_inset

 (see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
after "chapter 2.6"
key "van1996weak"

\end_inset

 for definitions and results about VC dimension).
 we will not make use of that approach here, but will use concepts from
 Vapnik-Chervonenkis theory in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:L1-consistency"

\end_inset

.
\end_layout

\begin_layout Standard
The following is theorem 3.2.10 from 
\begin_inset CommandInset citation
LatexCommand cite
after "p. 297"
key "van1996weak"

\end_inset

, and is the main technical tool for rigorously proving convergence of M-estimat
ors.
 We will use it to derive the limit distributions of irregular histograms
 in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:histograms"

\end_inset

.
\end_layout

\begin_layout Named Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:rate theorem"

\end_inset


\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
rate theorem
\end_layout

\end_inset

For each 
\begin_inset Formula $\theta$
\end_inset

 in an open subset 
\begin_inset Formula $U\subseteq\mathbb{R}^{n}$
\end_inset

, let 
\begin_inset Formula $m_{\theta}$
\end_inset

 be a measurable function such that 
\begin_inset Formula $\theta\mapsto Pm_{\theta}$
\end_inset

 is twice continuously differentiable at its maximum 
\begin_inset Formula $\theta_{0}$
\end_inset

, with non-singular Hessian (or information matrix) 
\begin_inset Formula $V$
\end_inset

.
 Let the bracketing entropy integral condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:local bracketing entropy integral condition"

\end_inset

 hold.
 Assume there is a continuous function 
\begin_inset Formula $\phi$
\end_inset

 such that 
\begin_inset Formula $\phi^{2}(\delta)\geq P^{\star}M_{\delta}^{2}$
\end_inset

 with 
\begin_inset Formula $\delta\mapsto\phi(\delta)/\delta^{\alpha}$
\end_inset

 decreasing for some 
\begin_inset Formula $\alpha<2$
\end_inset

.
 Assume the following Lindeberg condition is met: For every 
\begin_inset Formula $\eta>0$
\end_inset

,
\end_layout

\begin_layout Named Theorem
\begin_inset Formula 
\begin{equation}
\lim_{\delta\searrow0}\frac{P^{\star}M_{\delta}^{2}\{M_{\delta}>\eta\delta^{-2}\phi^{2}(\delta)\}}{\phi^{2}(\delta)}=0.\label{eq:Lindeberg condition}
\end{equation}

\end_inset

We also require the uniformity condition
\end_layout

\begin_layout Named Theorem
\begin_inset Formula 
\begin{equation}
\lim_{\epsilon\searrow0}\limsup_{\delta\searrow0}\sup_{\begin{array}{c}
||h-g||<\epsilon\end{array}}\frac{P(m_{\theta_{0}+\delta g}-m_{\theta_{0}+\delta h})^{2}}{\phi^{2}(\delta)}=0,\label{eq:Uniformity condition}
\end{equation}

\end_inset

when 
\begin_inset Formula $\max(||h||,||g||)\leq K$
\end_inset

 for all 
\begin_inset Formula $K\in\mathbb{N}$
\end_inset

.
 Furthermore, 
\end_layout

\begin_layout Named Theorem
\begin_inset Formula 
\begin{equation}
\lim_{\delta\searrow0}\frac{P(m_{\theta_{0}+\delta g}-m_{\theta_{0}+\delta h})^{2}}{\phi^{2}(\delta)}=E(G(g)-G(h))^{2}\label{eq:Gaussian condition}
\end{equation}

\end_inset

for a zero-mean non-degenerate Gaussian process 
\begin_inset Formula $G$
\end_inset

 such that 
\begin_inset Formula $G(g)=G(h)$
\end_inset

 almost surely if and only if 
\begin_inset Formula $h=g$
\end_inset

.
 Then there exists a version of 
\begin_inset Formula $G$
\end_inset

 with bounded, uniformly continuous sample paths on compacta.
 Define 
\begin_inset Formula $r_{n}$
\end_inset

 as the solution to 
\begin_inset Formula $r_{n}^{2}\phi(r_{n}^{-1})=\sqrt{n}$
\end_inset

.
 Then the rescaled process 
\begin_inset Formula $h\mapsto r_{n}^{2}(P_{n}m_{\theta_{0}+r_{n}^{-1}h}-P_{n}m_{\theta_{0}})$
\end_inset

 converges weakly to 
\begin_inset Formula $G(h)+\frac{1}{2}h^{T}Vh$
\end_inset

.
 If 
\begin_inset Formula $\widehat{\theta}_{n}$
\end_inset

 nearly maximises the map 
\begin_inset Formula $\theta\to P_{n}m_{\theta}$
\end_inset

 for every 
\begin_inset Formula $n$
\end_inset

 and converges in outer probability to 
\begin_inset Formula $\theta_{0}$
\end_inset

, the sequence 
\begin_inset Formula $r_{n}(\widehat{\theta}_{n}-\theta_{0})$
\end_inset

 converges in distribution to the unique maximiser 
\begin_inset Formula $\widehat{h}$
\end_inset

 of the process 
\begin_inset Formula $h\mapsto G(h)+\frac{1}{2}h^{T}Vh$
\end_inset

.
\end_layout

\begin_layout Standard
In our applications, the uniformity and Gaussian conditions are easy to
 verify.
 The condition that 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\widehat{\theta}_{n}$
\end_inset

 nearly maximises the map 
\begin_inset Formula $\theta\to P_{n}m_{\theta}$
\end_inset

 for every 
\begin_inset Formula $n$
\end_inset

 and converges in outer probability to 
\begin_inset Formula $\theta_{0}$
\end_inset


\begin_inset Quotes erd
\end_inset

, is understood to mean to that 
\begin_inset Formula $\widehat{\theta}_{n}$
\end_inset

 is consistent for 
\begin_inset Formula $\theta_{0}$
\end_inset

 and 
\begin_inset Formula $\widehat{\theta}_{n}\geq\argmax_{\theta}P_{n}m_{\theta}-o_{p}(1)$
\end_inset

.
 
\end_layout

\begin_layout Section
Least median squares regression
\begin_inset CommandInset label
LatexCommand label
name "sec:Least-median-squares"

\end_inset


\end_layout

\begin_layout Standard
Consider the ordinary linear regression model 
\begin_inset Formula 
\[
Y=X^{T}\beta+\epsilon,\;\epsilon\sim N(0,\sigma^{2}),
\]

\end_inset

where the samples are independent.
 The maximum likelihood estimate of this model is given by the ordinary
 least squares (OLS) solution, namely 
\begin_inset Formula 
\[
\argmin_{\beta}\frac{1}{n}\sum_{i=1}^{n}(X_{i}^{T}\beta-Y_{i})^{2}.
\]

\end_inset

While this estimator is efficient under model conditions with no contaminated
 data, it is very sensitive even to single outliers.
 Notice the sum involved in the least squares solution: We minimise the
 mean of the squared residuals 
\begin_inset Formula $r_{i}^{2}=(X_{i}^{T}\beta-Y_{i})^{2}$
\end_inset

.
 It is well known that the median is far more robust than the mean as an
 estimator of the centre in a symmetric distribution, for instance it has
 a breakdown point of 
\begin_inset Formula $50\%$
\end_inset

.
 This knowledge gave rise to the least median squares estimator (LMS) 
\begin_inset CommandInset citation
LatexCommand citep
key "rousseeuw1984least"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\widehat{\beta} & = & \argmin_{\beta}\textrm{med}((X^{T}\beta-Y)^{2})\\
 & = & \argmin_{\beta}\textrm{med}|X^{T}\beta-Y|.
\end{eqnarray*}

\end_inset

The equality between the first and second line follows from the monotonicity
 of 
\begin_inset Formula $x\mapsto x^{2}$
\end_inset

 when 
\begin_inset Formula $x\geq0$
\end_inset

.
 This estimator is extremely robust to outliers in both the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 direction.
 Similarly to the median, it has a breakdown point of 
\begin_inset Formula $50\%$
\end_inset

, which means that a data set 
\begin_inset Formula $(Y_{i},X_{i})$
\end_inset

 can contain up to 50% percent contamination without the regressor being
 affected by it (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Manski Robustness"

\end_inset

).
 This is clearly the upper bound for any reasonable estimator.
 Nonetheless, it pays for this robustness by being very inefficient.
 Its cube root asymptotics were derived both in 
\begin_inset CommandInset citation
LatexCommand cite
key "rousseeuw2005robust"

\end_inset

 and in 
\begin_inset CommandInset citation
LatexCommand cite
key "kim1990cube"

\end_inset

.
 The estimator is available in 
\begin_inset Formula $\mathtt{R}$
\end_inset

 through the function 
\begin_inset Formula $\mathtt{lmsreg}$
\end_inset

 in the built-in package 
\begin_inset Formula $\mathtt{MASS}$
\end_inset

.
\end_layout

\begin_layout Standard
We have not succeeded in isolating the conditions under which the LMS is
 consistent, but it appears likely that it is consistent whenever the covariates
 are sufficiently nicely distributed and the error terms are symmetric,
 independent of each other and 
\begin_inset Formula $X_{i}$
\end_inset

, and satisfying 
\begin_inset Formula $\textrm{med}(\epsilon_{i})=0$
\end_inset

.
 
\end_layout

\begin_layout Standard
Another idea for robustifying the OLS is to use 
\begin_inset Formula $\argmin_{\beta}\frac{1}{n}\sum_{i=1}^{n}|X_{i}^{T}\beta-Y_{i}|$
\end_inset

, which is known as 
\begin_inset Formula $L_{1}$
\end_inset

-regression or least absolute deviations (LAD) regression.
 In one sense, this is the generalisation of the median to the regression
 setting, recall Proposition 
\begin_inset CommandInset ref
LatexCommand vref
reference "prop:Median objective"

\end_inset

.
 It is the maximum likelihood estimator under the assumption that the 
\begin_inset Formula $\epsilon$
\end_inset

s are Laplace distributed.
 While this estimator is more robust than OLS in the sense that it doesn't
 put larger weight on large residuals and smaller weight on small residuals,
 its breakdown point is equally bad.
 Modulo regularity conditions on the covariates, LAD is consistent under
 the assumption that 
\begin_inset Formula $\textrm{med}(\epsilon_{i})=0$
\end_inset

 and the 
\begin_inset Formula $\epsilon$
\end_inset

s being i.i.d.
 with a positive density in the neighbourhood of 
\begin_inset Formula $0$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "pollard1991asymptotics"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Properties
\end_layout

\begin_layout Standard
The LMS estimator has some nice properties, described in depth in the aforementi
oned monograph 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 116-117"
key "rousseeuw2005robust"

\end_inset

, including several desirable equivariance properties.
 
\end_layout

\begin_layout Definition
Let 
\begin_inset Formula $\left\{ (x_{i},y_{i})\in\mathbb{R}^{d}\times\mathbb{R}\mid i=1,...,n\right\} $
\end_inset

 be observed data and 
\begin_inset Formula $T_{n}:(\mathbb{R}^{d}\times\mathbb{R})^{n}\to\mathbb{R}^{d+1}$
\end_inset

 be a regression estimator.
 We define the following properties:
\end_layout

\begin_layout Definition
1.) 
\emph on
Regression equivariance: 
\emph default

\begin_inset Formula $T_{n}$
\end_inset

 satisfies this property if 
\end_layout

\begin_layout Definition
\begin_inset Formula 
\[
T_{n}(\{(x_{i},y_{i}+v^{T}x_{i})\})=T_{n}(\{(x_{i},y_{i})\})+v,
\]

\end_inset

whenever 
\begin_inset Formula $v\in\mathbb{R}^{d}$
\end_inset

.
\end_layout

\begin_layout Definition
2.) 
\emph on
Affine equivariance: 
\emph default
This is satisfied when
\end_layout

\begin_layout Definition
\begin_inset Formula 
\[
T_{n}(\{(Ax_{i},y_{i})\})=(A^{T})^{-1}T_{n}(\{(x_{i},y_{i})\}),
\]

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
for any non-singular transformation 
\begin_inset Formula $A$
\end_inset

 of the covariates.
 
\end_layout

\begin_layout Definition
3.) 
\emph on
Scale equivariance: 
\emph default
The estimator is said to be scale equivariant if
\end_layout

\begin_layout Definition
\begin_inset Formula 
\[
T_{n}(\{x_{i},cy_{i}\})=cT_{n}\{(x_{i},y_{i})\}.
\]

\end_inset


\end_layout

\begin_layout Standard
Affine equivariance
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 implies that the estimator is independent of the choice of coordinate system,
 which is clearly desirable.
 Scale invariance also appears important to have.
 The regression equivariance doesn't look as intuitively desirable.
 To explain what's going on, take a look at the 
\begin_inset Formula $LS$
\end_inset

 estimator, 
\begin_inset Formula $\widehat{\beta}=\argmin_{\beta}(\beta^{T}x_{i}-y_{i})^{2}$
\end_inset

.
 When 
\begin_inset Formula $v\in\mathbb{R}^{d}$
\end_inset

, 
\begin_inset Formula $\argmin_{\beta}(\beta^{T}x_{i}-(y_{i}+v^{T}x_{i})^{2}=\argmin_{\beta}((\beta^{T}-v^{T})x_{i}-y_{i})^{2}$
\end_inset

, which equals 
\begin_inset Formula $\widehat{\beta}+v$
\end_inset

.
 Regression equivariant estimators have the property that one can assume,
 without loss of generality, that 
\begin_inset Formula $\widehat{\beta}=0$
\end_inset

.
 
\end_layout

\begin_layout Standard
There are reasonable, highly robust estimators without some of these properties.
 An example is the repeated median estimator of 
\begin_inset CommandInset citation
LatexCommand citet
key "siegel1982robust"

\end_inset

, another estimator with 
\begin_inset Formula $50\%$
\end_inset

 breakdown point.
 Let 
\begin_inset Formula $d$
\end_inset

 be the covariate dimension and 
\begin_inset Formula $\left\{ (x_{i},y_{i})\in\mathbb{R}^{d}\times\mathbb{R}\mid i=1,...,n\right\} $
\end_inset

 be observed data.
 For any selection of 
\begin_inset Formula $d+1$
\end_inset

 numbers 
\begin_inset Formula $i_{1},i_{2}...,i_{d+1}$
\end_inset

 between 
\begin_inset Formula $1$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

, the system 
\begin_inset Formula $(1,x_{i_{1}},x_{i_{2}},...,x_{i_{d}})^{T}\beta=(y_{i_{1}},y_{i_{2}},...,y_{i_{d}})^{T}$
\end_inset

 has a unique solution.
 This follows from the ubiquitous full rank condition on the covariates.
 Denote this solution 
\begin_inset Formula $\beta(i_{1},i_{2},...,i_{d})$
\end_inset

, and let 
\begin_inset Formula $\beta_{j}(i_{1},i_{2},...,i_{d})$
\end_inset

 be its 
\begin_inset Formula $j$
\end_inset

th coordinate.
 Define the repeated median as follows:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\widehat{\beta}_{j}=\textrm{med}_{i_{1}}(\textrm{med}_{i_{2}}(....\textrm{med}_{i_{d}}(\{\beta_{j}(i_{1},i_{2},...,i_{d})\}))...)
\]

\end_inset

When 
\begin_inset Formula $d=1$
\end_inset

, a pair of tuples 
\begin_inset Formula $(x_{j},y_{j})$
\end_inset

 and 
\begin_inset Formula $(x_{i},y_{i})$
\end_inset

 yield the parameter estimates
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\beta_{0}^{(ij)} & = & \frac{x_{j}y_{i}-x_{i}y_{j}}{x_{j}-x_{i}},\\
\beta_{1}^{(ij)} & = & \frac{y_{j}-y_{i}}{x_{j}-x_{i}}.
\end{eqnarray*}

\end_inset

The desired estimates is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\widehat{\beta}_{0}=\textrm{med}\{\textrm{med}\{\beta_{0}^{(ij)}\mid j=1,...,n\}\mid j\neq i\},
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\widehat{\beta}_{1}=\textrm{med}\{\textrm{med}\{\beta_{1}^{(ij)}\mid j=1,...,n\}\mid j\neq i\}.
\]

\end_inset

This estimator is not affine equivariant.
 It is not a very efficient estimator at standard normal error conditions,
 with efficiency at 
\begin_inset Formula $4/\pi^{2}\approx40.5\%$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "hossjer1994asymptotics"

\end_inset

.
 (Though it compares nicely to the LMS, with an efficiency of 
\begin_inset Formula $0$
\end_inset

!) A related estimator is the Theil-Sen estimator, where the median isn't
 repeated.
 In dimension two, the slope estimate is 
\begin_inset Formula $\textrm{med}\left\{ \frac{y_{j}-y_{i}}{x_{j}-x_{i}}\mid i<j\right\} $
\end_inset

 and the intercept estimate is 
\begin_inset Formula $\textrm{med}\left\{ \frac{x_{j}y_{i}-x_{i}y_{j}}{x_{j}-x_{i}}\mid i<j\right\} $
\end_inset

.
 It is more efficient (
\begin_inset Formula $90.5\%)$
\end_inset

 than the repeated median estimator, but has a lower breakdown point at
 
\begin_inset Formula $29\%$
\end_inset

, (ibid.).
 The Theil-Sen estimator isn't affine equivariant either.
 The gist of the matter, for both estimators, is that the estimator runs
 independently on each coordinate, but the runs must be 
\begin_inset Quotes eld
\end_inset

coordinated
\begin_inset Quotes erd
\end_inset

 in order to make the 
\begin_inset Formula $A^{T}$
\end_inset

 commute with the median.
\end_layout

\begin_layout Standard
The LMS estimator also has the 
\emph on
exact fit 
\emph default
property: Whenever 
\begin_inset Formula $\lceil\frac{n}{2}\rceil$
\end_inset

 observations lie on a straight line 
\begin_inset Formula $\theta^{T}x$
\end_inset

, the LMS estimate is 
\begin_inset Formula $\widehat{\beta}=\theta$
\end_inset

.
 This property is not shared by e.g.
 OLS regression, but it is not clear whether its desirable in the first
 place.
 This property is a straight forward consequence of the geometrical interpretati
on of the LMS: It attempts to find the mid-line of the tube of smallest
 radius which contains at least half of the observations 
\begin_inset CommandInset citation
LatexCommand citet
after "p. 24"
key "rousseeuw2005robust"

\end_inset

.
 The geometry is arguably easier to understand than OLS geometry.
 Nevertheless, it makes the estimator sensitive to small perturbations in
 data values, as described in 
\begin_inset CommandInset citation
LatexCommand citet
key "hettmansperger1992cautionary"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Calculation
\end_layout

\begin_layout Standard
If there are no covariates, the regression model reduces to a location model
 
\begin_inset Formula $Y_{i}=\theta+\epsilon_{i}$
\end_inset

.
 In this special case, it is easy to describe its LMS estimator.
 Now the objective function reduces to 
\begin_inset Formula $f(\theta)=\textrm{med}(|y_{i}-\theta|)$
\end_inset

.
 The next proposition was first observed 
\begin_inset CommandInset citation
LatexCommand citet
key "steele1986algorithms"

\end_inset

 in a more general.
 This particular proof is a simplification of theirs to 
\begin_inset Formula $d=2$
\end_inset

.
 In it we use the 
\begin_inset Quotes eld
\end_inset

high median
\begin_inset Quotes erd
\end_inset

 convention: When faced with an even number of observations, 
\begin_inset Formula $n=2k$
\end_inset

, we define 
\begin_inset Formula $\textrm{med}\{x_{i}\}=x_{(k)}$
\end_inset

.
 
\end_layout

\begin_layout Proposition
The LMS estimate of 
\begin_inset Formula $\theta$
\end_inset

 in 
\begin_inset Formula $Y=\theta+\epsilon$
\end_inset

, where 
\begin_inset Formula $\textrm{med}(\epsilon)=0$
\end_inset

, is given by 
\begin_inset Formula 
\[
\widehat{\theta}=\min_{A\in\mathcal{A}}\frac{1}{2}(\max A+\min A),
\]

\end_inset

where 
\begin_inset Formula $\mathcal{A}=\left\{ S\subset\{y_{1},...,y_{2}\}\mid\#S=\lfloor\frac{n}{2}\rfloor+1\right\} $
\end_inset

.
 In addition, 
\begin_inset Formula 
\[
f(\widehat{\theta})=\min_{A\in\mathcal{A}}\left(\max A-\min A\right).
\]

\end_inset


\end_layout

\begin_layout Proof
We first show that the local minima of 
\begin_inset Formula $f(\theta)$
\end_inset

 is on the form 
\begin_inset Formula 
\[
\left(\max A-\min A\right)_{A\in\mathcal{A}}.
\]

\end_inset

Let 
\begin_inset Formula $\theta$
\end_inset

 be arbitrary, and assume that 
\begin_inset Formula $f(\theta)$
\end_inset

 is on the form above.
 The value of 
\begin_inset Formula $f(\theta)$
\end_inset

 is obtained by taking the 
\begin_inset Formula $(\lfloor\frac{n}{2}\rfloor+1)$
\end_inset

st element of the list 
\begin_inset Formula $\{|y_{i}-\theta|:i=1,...,n\}$
\end_inset

, hence a slight tilt of 
\begin_inset Formula $\theta$
\end_inset

 to the left will make the distance to the rightmost element slightly larger,
 increasing the value of 
\begin_inset Formula $f(\theta)$
\end_inset

; the same argument works for a tilt to the right, hence 
\begin_inset Formula $f(\theta)$
\end_inset

 is a local minimum.
 Conversely, let 
\begin_inset Formula $A$
\end_inset

 be the 
\begin_inset Formula $(\lfloor\frac{n}{2}\rfloor+1)$
\end_inset

-element head of 
\begin_inset Formula $\{|y_{i}-\theta|:i=1,...,n\}$
\end_inset

 associated with 
\begin_inset Formula $\theta$
\end_inset

 and assume 
\begin_inset Formula $|\max A-\theta|>|\min A-\theta|$
\end_inset

.
 If we slide 
\begin_inset Formula $\theta$
\end_inset

 towards the right, we will reach a point 
\begin_inset Formula $\theta'$
\end_inset

 where 
\begin_inset Formula $|\max A-\theta'|=|\min A-\theta'|$
\end_inset

.
 Here 
\begin_inset Formula $|\max A-\theta'|<|\max A-\theta|$
\end_inset

, showing that 
\begin_inset Formula $f(\theta)$
\end_inset

 is not a local minimum.
 
\end_layout

\begin_layout Standard
This is reminiscent of the 
\emph on
shorth 
\emph default
estimator of the centre in a symmetric distribution 
\begin_inset CommandInset citation
LatexCommand citep
key "andrews2015robust"

\end_inset

, whose cube root asymptotics is rigorously derived in 
\begin_inset CommandInset citation
LatexCommand citet
key "kim1990cube"

\end_inset

.
 This estimator is defined as 
\begin_inset Formula $\frac{1}{\lfloor\frac{n}{2}\rfloor+1}\sum_{y\in A}y$
\end_inset

, the mean of the shortest interval containing half of the observations.
 The computation of these estimators is simple: We order the observations,
 then check the distances 
\begin_inset Formula $x_{i+\lfloor\frac{n}{2}\rfloor+1}-x_{i}$
\end_inset

 for 
\begin_inset Formula $i=1,...,\lfloor\frac{n}{2}\rfloor$
\end_inset

, and finally compute the midrange (mean) in order to get the LMS estimate
 (shorth estimate).
 Together this takes 
\begin_inset Formula $O(n\log n)$
\end_inset

 time.
 The 
\begin_inset Quotes eld
\end_inset

weirdness
\begin_inset Quotes erd
\end_inset

 of this explicit solution form casts doubt on whether the LMS is such a
 good idea after all.
 Consider the following example, inspired by 
\begin_inset CommandInset citation
LatexCommand citet
key "hettmansperger1992cautionary"

\end_inset

, which shows that the LMS behaves unpredictably when presented with slightly
 manipulated data.
 They called this phenomenon 
\begin_inset Quotes eld
\end_inset

local instability
\begin_inset Quotes erd
\end_inset

, and observed it in real data sets.
\end_layout

\begin_layout Example
Let 
\begin_inset Formula $y=(1,3,4,6.0001,10)$
\end_inset

 be the set observations.
 The 3-ary set attaining the smallest midrange is 
\begin_inset Formula $(1,3,4)$
\end_inset

, with midrange 
\begin_inset Formula $2.5$
\end_inset

.
 Assume that 
\begin_inset Formula $y'=(1,3,4,5.999,10)$
\end_inset

 is observed instead.
 The 3-ary set attaining the smallest midrange has changed into 
\begin_inset Formula $(3,4,5.999)$
\end_inset

, with a midrange approximately equal to 
\begin_inset Formula $4.5$
\end_inset

.
 Clearly, the same criticism applies to the shorth estimator.
\end_layout

\begin_layout Standard
Anomalies like this, which stem from discontinuity, is a burden we have
 to bear when dealing with cube root asymptotics.
 This kind of jump in estimates only happens in OLS when the covariates
 are multicollinear.
 We will discuss a phenomenon like this in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Presmoothing-and-instability"

\end_inset

 as well.
\end_layout

\begin_layout Standard
To compute 
\begin_inset Formula $\widehat{\beta}$
\end_inset

 in a regression setting one would have to use some more advanced combinatorial
 optimisation.
 The problem is computationally hard, but has received the attention of
 the computational geometers 
\begin_inset CommandInset citation
LatexCommand citealt
key "edelsbrunner1990computing"

\end_inset

, where a 
\begin_inset Formula $O(n^{2})$
\end_inset

-algorithm is given for the case of one covariate.
 In practice, approximation algorithms are used, see 
\begin_inset CommandInset citation
LatexCommand cite
key "rousseeuw2005robust"

\end_inset

.
\end_layout

\begin_layout Standard
Rousseeuw and Leroy 
\begin_inset CommandInset citation
LatexCommand citeyearpar
after "chapter 6"
key "rousseeuw2005robust"

\end_inset

 proposes to use this method to identify outliers, remove them, and perform
 an ordinary LS regression in order to get confidence intervals and perform
 hypothesis tests afterwards.
 As the authors say on p.
 229,
\end_layout

\begin_layout Quote
Many diagnostics are based on the residuals resulting from LS.
 However, this starting point may lead to useless results because of the
 following reason.
 By definition, LS tries to avoid large residuals.
 Consequently, one outlying case may cause a poor fit for the majority of
 the data because the LS estimator tries to accommodate this case at the
 expense of the remaining observations.
 Therefore, an outlier may have a small LS residual, especially when it
 is a leverage point [...].
 As a consequence, diagnostics based on LS residuals often fail to reveal
 such points.
\end_layout

\begin_layout Standard
Finally, we mention that the LMS is not the method of choice for performing
 robust regression analysis.
 There are a myriad of different procedures for robust regression, most
 of which are both easier to compute and far more efficient, see e.g.
 
\begin_inset CommandInset citation
LatexCommand citet
after "chapter 4,5"
key "maronna2006robust"

\end_inset

.
\end_layout

\begin_layout Section
Binary decision trees
\begin_inset CommandInset label
LatexCommand label
name "sec:Binary-decision-trees"

\end_inset


\end_layout

\begin_layout Standard
A binary decision tree is a step function of the form 
\begin_inset Formula $g(x;\beta_{l},\beta_{u},d)=\beta_{l}1{}_{[x\leq d]}+\beta_{u}1{}_{[x>d]}$
\end_inset

, 
\begin_inset Formula $x\in\mathbb{R}$
\end_inset

.
 Let 
\begin_inset Formula $(y_{i},x_{i})\in\mathbb{R}^{2}$
\end_inset

 be observations from some regression model 
\begin_inset Formula $y_{i}=f(x_{i})+\epsilon_{i}$
\end_inset

, where 
\begin_inset Formula $f=E(Y\mid x)$
\end_inset

 is a given function.
 Now we wish to approximate 
\begin_inset Formula $f$
\end_inset

 by means of a binary decision tree.
 We consider the situation when the covariates 
\begin_inset Formula $X$
\end_inset

 come from a density 
\begin_inset Formula $p_{X}$
\end_inset

, hence we can talk about the joint distribution of 
\begin_inset Formula $(Y,X)$
\end_inset

.
 As indicated, we wish to approximate a regression function 
\begin_inset Formula $E(Y\|X=x)=f(x)$
\end_inset

 by a step function 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
g(x;\beta_{l},\beta_{u},d)=\beta_{l}\left\{ x\leq d\right\} +\beta_{u}\left\{ x>d\right\} .
\]

\end_inset

In machine learning, this procedure is typically iterated 
\begin_inset CommandInset citation
LatexCommand citep
after "chapter 9"
key "hastie2005elements"

\end_inset

, an application which will not be discussed here.
 Given the true distribution 
\begin_inset Formula $P$
\end_inset

 of 
\begin_inset Formula $(Y,X)$
\end_inset

, we can talk about the 
\begin_inset Quotes eld
\end_inset

least false values
\begin_inset Quotes erd
\end_inset

 in the mean square error sense:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
(\beta_{l}^{0},\beta_{u}^{0},d^{0}) & = & \argmin_{(\beta_{l},\beta_{u},d)}P\left[\left(Y-\left[\beta_{l}\left\{ X\leq d\right\} +\beta_{u}\left\{ X>d\right\} \right]\right)^{2}\right],
\end{eqnarray*}

\end_inset

which gives rise to the least sum of squares estimator,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
(\widehat{\beta_{l}},\widehat{\beta_{u}},\widehat{d}) & = & \argmin_{\beta_{l},\beta_{u},d}P_{n}\left[\left(Y-\left[\beta_{l}\left\{ X\leq d\right\} +\beta_{u}\left\{ X>d\right\} \right]\right)^{2}\right],\\
 &  & \argmin_{\beta_{l},\beta_{u},d}\sum_{i=1}^{n}\left[\left(Y_{i}-\left[\beta_{l}\left\{ X_{i}\leq d\right\} +\beta_{u}\left\{ X_{i}>d\right\} \right]\right)^{2}\right].
\end{eqnarray*}

\end_inset

Now we must make the distinction between two 
\emph on
very 
\emph default
different problems, only one of which is covered here.
 It concerns the shape of the true 
\begin_inset Formula $f$
\end_inset

.
\end_layout

\begin_layout Standard
(C1) 
\begin_inset Formula $f$
\end_inset

 is on the form 
\begin_inset Formula $g$
\end_inset

, or reasonably close in the sense that it actually has a jump discontinuity
 at 
\begin_inset Formula $d^{0}$
\end_inset

,
\end_layout

\begin_layout Standard
(C2) 
\begin_inset Formula $f$
\end_inset

 is not on the form 
\begin_inset Formula $g$
\end_inset

, specifically, it is differentiable at 
\begin_inset Formula $d^{0}$
\end_inset

.
\begin_inset Newline newline
\end_inset

Modelling with (C2) satisfied is like using histograms in a regression setting,
 and is called 
\emph on
split-point analysis
\emph default
 by Banerjee and McKeague 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "banerjee2007confidence"

\end_inset

.
 They proved the following:
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:Decision tree asymptotics"

\end_inset

Under conditions (A1)-(A5) of Banerjee & McKeague, including (C2) above,
 
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
n^{\frac{1}{3}}(\widehat{\beta_{l}}-\beta_{l}^{0},\widehat{\beta_{u}}-\beta_{u}^{0},\widehat{d_{n}}-d^{0})\stackrel{d}{\to}(c_{1},c_{2},1)\argmax_{h}\left[Vh^{2}+aW(h)\right],
\]

\end_inset

where 
\begin_inset Formula $W$
\end_inset

 is a standard two-sided Brownian motion and 
\begin_inset Formula $V$
\end_inset

 and 
\begin_inset Formula $a$
\end_inset

 are real constants depending on 
\begin_inset Formula $p_{X}(d^{0})$
\end_inset

, 
\begin_inset Formula $f'(d^{0})$
\end_inset

 
\begin_inset Formula $(\beta_{l}^{0},\beta_{u}^{0},d^{0})$
\end_inset

 and 
\begin_inset Formula $P(d^{0})$
\end_inset

.
\end_layout

\begin_layout Standard
While the authors only found the limiting distribution for one split point,
 it is probably straightforward to extend it to any number of split points.
 This would give us the asymptotic theory for a particular form of histogram
 regression with data driven partitioning rules (see 
\begin_inset CommandInset citation
LatexCommand citet
key "nobel1996histogram"

\end_inset

).
 Peculiarly, the value of 
\begin_inset Formula $(\widehat{\beta_{l}}-\beta_{l}^{0},\widehat{\beta_{u}}-\beta_{u}^{0},\widehat{d_{n}}-d^{0})$
\end_inset

 depends only one random variable, namely 
\begin_inset Formula $Z=\argmax_{h}Vh^{2}+aW(t)$
\end_inset

.
 We will obtain an analogy of Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Decision tree asymptotics"

\end_inset

 for irregular histograms 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "exa:(k = 2) distributin, irregular histogram, KL"

\end_inset

, where the same curious 
\begin_inset Quotes eld
\end_inset

single random
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $Z$
\end_inset

 appears.
 There aren't many obvious applications for these binary decision trees,
 but Banerjee and McKeague 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "banerjee2007confidence"

\end_inset

 applied it on an environmental problem concerning the Everglades National
 Park in Florida.
 The convergence rate of the split points was first observed by 
\begin_inset CommandInset citation
LatexCommand citet
key "buchlmann2002analyzing"

\end_inset

, in a paper analysing the effect of 
\emph on
bootstrap aggregation
\emph default
 on decision trees, a variance reduction technique.
 Interestingly, they erred on the convergence rate of the levels (
\begin_inset Formula $\widehat{\beta_{l}}$
\end_inset

 and 
\begin_inset Formula $\widehat{\beta_{u}}$
\end_inset

), believing they converged at the ordinary 
\begin_inset Formula $n^{\frac{1}{2}}$
\end_inset

-rate instead.
 This can serve as a warning on how hard it can be to get these things right.
\end_layout

\begin_layout Standard
On the other hand, if (C1) is satisfied, we obtain 
\begin_inset Formula $n$
\end_inset

 asymptotics for 
\begin_inset Formula $d$
\end_inset

 and 
\begin_inset Formula $n^{\frac{1}{2}}$
\end_inset

-asymptotics for 
\begin_inset Formula $\beta_{l}$
\end_inset

 and 
\begin_inset Formula $\beta_{u}$
\end_inset

, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
after "section 14.5.1"
key "kosorok2007introduction"

\end_inset

.
 This happens as we attempt to isolate 
\emph on
real
\emph default
 change-points in the underlying regression model.
 Note that the rate theorem can't be used in this case, as the smoothness
 condition on 
\begin_inset Formula $Pm_{\theta}$
\end_inset

 isn't satisfied.
\end_layout

\begin_layout Standard
This phenomenon of 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

-convergence for smooth underlying distributions and 
\begin_inset Formula $n^{\frac{1}{2}}/n$
\end_inset

-convergence for appropriately discontinuous underlying distributions is
 extremely likely to happen for irregular histograms (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:histograms"

\end_inset

) as well.
 Indeed, our discussion of histograms in that chapter will only concern
 underlying 
\begin_inset Formula $F$
\end_inset

s satisfying the analogue of (C2).
 
\end_layout

\begin_layout Section
Resampling
\begin_inset CommandInset label
LatexCommand label
name "sec:Resampling"

\end_inset


\end_layout

\begin_layout Subsection
Bootstrap
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $X_{1},\ldots,X_{n}\stackrel{i.i.d.}{\sim}P$
\end_inset

 and 
\begin_inset Formula $R_{n}(X_{1},\ldots,X_{n};P)$
\end_inset

 be a functional of both the data and the probability.
 Such a functional is called a 
\emph on
root
\emph default
, after 
\begin_inset CommandInset citation
LatexCommand cite
key "beran1983bootstrap"

\end_inset

.
 The most prominent example of 
\begin_inset Formula $R_{n}$
\end_inset

 is 
\begin_inset Formula $\sqrt{n}(\widehat{\theta}_{n}-\theta_{0}(P))$
\end_inset

, where 
\begin_inset Formula $\widehat{\theta}_{n}$
\end_inset

 is an estimator of 
\begin_inset Formula $\theta_{0}(P)$
\end_inset

 depending only on 
\begin_inset Formula $X_{1},\ldots,X_{n}$
\end_inset

, for instance an 
\begin_inset Formula $M$
\end_inset

-estimator or a more general statistical functional.
 Whenever 
\begin_inset Formula $P$
\end_inset

 is unknown, it is of interest to approximate 
\begin_inset Formula $R_{n}$
\end_inset

s distribution in order to construct confidence intervals, perform hypothesis
 tests, etc.
 A sensible approach is to approximate 
\begin_inset Formula $P$
\end_inset

 with a known distribution 
\begin_inset Formula $Q_{n}$
\end_inset

, usually (if not always) data dependent, and calculate the distribution
 of 
\begin_inset Formula $R_{n}(\widehat{X}_{1},\ldots,\widehat{X}_{n};Q_{n})$
\end_inset

, where 
\begin_inset Formula $\widehat{X}_{1},\ldots,\widehat{X}_{n}\stackrel{i.i.d.}{\sim}Q_{n}$
\end_inset

 This can sometimes be done analytically, but is typically done numerically
 through Monte Carlo methods.
 Some possible choices for 
\begin_inset Formula $Q_{n}$
\end_inset

 are
\end_layout

\begin_layout Enumerate
\begin_inset Formula $P_{n}$
\end_inset

, the empirical measure.
 This leads to the ordinary non-parametric bootstrap 
\begin_inset CommandInset citation
LatexCommand citep
key "efron1979bootstrap"

\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $Q_{n}=\widetilde{P}_{n}$
\end_inset

, a smoothed version of 
\begin_inset Formula $P_{n}$
\end_inset

, which yields the smoothed bootstrap.
\end_layout

\begin_layout Enumerate
Use a parametric distribution with plug-in parameters.
 From this we get the parametric bootstrap.
\end_layout

\begin_layout Standard
The non-parametric bootstrap is the most commonly used of these procedures,
 and has been thoroughly researched.
 For a reference, see 
\begin_inset CommandInset citation
LatexCommand cite
key "shao2012jackknife"

\end_inset

.
 Still, the smoothed bootstrap hasn't received that much attention.
 In recent years, there has been done some work on the smoothed bootstrap
 in the context of cube root asymptotics.
 This research is motivated by the fact that the ordinary bootstrap isn't
 consistent in general in cube root asymptotics.
 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $H_{n}(P)$
\end_inset

 be the distribution function of 
\begin_inset Formula $R_{n}(X_{1},\ldots,X_{n};P)$
\end_inset

, and assume it converges in distribution to some distribution function
 
\begin_inset Formula $H(P)$
\end_inset

.
 Likewise, let 
\begin_inset Formula $H_{n}(Q_{n})$
\end_inset

 be the distribution function of 
\begin_inset Formula $R_{n}(\widehat{X}_{1},\ldots,\widehat{X}_{n};Q_{n})$
\end_inset

.
 Our goal is to estimate 
\begin_inset Formula $H_{n}(P)$
\end_inset

 by 
\begin_inset Formula $H_{n}(Q_{n})$
\end_inset

, and a necessary condition for this to be reasonable is that 
\begin_inset Formula $H_{n}(Q_{n})$
\end_inset

 is 
\begin_inset Quotes eld
\end_inset

consistent
\begin_inset Quotes erd
\end_inset

.
 Since the bootstrap attempts to approximate a unique distribution conditionally
, we say that the bootstrap is consistent if 
\begin_inset Formula $H_{n}(Q_{n})\stackrel{d}{\to}H(P)$
\end_inset

 conditionally on 
\begin_inset Formula $X_{1},X_{2},...\stackrel{i.i.d.}{\sim}P$
\end_inset

 for almost every such sequence of observations.
 Hence, if 
\begin_inset Formula $H(P)$
\end_inset

 is assumed to continuous, which is usually the case, the bootstrap is consisten
t if 
\begin_inset Formula 
\[
\sup_{x}|H_{n}(Q_{n})(x)-H(P)(x)|\to0
\]

\end_inset

almost surely 
\begin_inset CommandInset citation
LatexCommand citep
after "lemma 2.11"
key "van2000asymptotic"

\end_inset

.
\end_layout

\begin_layout Standard
The following basic result on the bootstrap is perhaps the most important
 one.
 Here 
\begin_inset Formula $\mu(P)$
\end_inset

 is the mean of 
\begin_inset Formula $P$
\end_inset

, while 
\begin_inset Formula $\sigma^{2}(P)$
\end_inset

 is its variance.
\end_layout

\begin_layout Theorem
Assume 
\begin_inset Formula $P$
\end_inset

 has finite variance.
 Let 
\begin_inset Formula $P_{n}$
\end_inset

 be a sequence of distributions such that 
\begin_inset Formula $P_{n}\stackrel{d}{\to}P$
\end_inset

.
 In addition, assume both 
\begin_inset Formula $\mu(P_{n})\to\mu(P)$
\end_inset

 and 
\begin_inset Formula $\sigma^{2}(P_{n})\to\sigma^{2}(P)$
\end_inset

.
 Then the bootstrap is consistent for the root 
\begin_inset Formula $H_{n}(X_{1},...,X_{n};P)=\sqrt{n}(\overline{X}-\mu(P))$
\end_inset

, where 
\begin_inset Formula $H(P)\sim N(0,\sigma^{2}(P))$
\end_inset

.
\end_layout

\begin_layout Standard
For a proof, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
after "proposition 1.3"
key "politissubsampling"

\end_inset

.
 The finite variance condition is not only needed to assure asymptotic normality.
 In fact, for some cases of 
\begin_inset Formula $X_{i}$
\end_inset

s with infinite variance, the bootstrap isn't only not consistent, but has
 no deterministic limit in probability 
\begin_inset CommandInset citation
LatexCommand citep
key "athreya1987bootstrap"

\end_inset

.
 This theorem generalises to the case of smooth functionals as well 
\begin_inset CommandInset citation
LatexCommand citep
after "theorem 3.6"
key "shao2012jackknife"

\end_inset

.
\end_layout

\begin_layout Standard
The known cases of estimators with cube root asymptotics are in a sense
 non-smooth, and also the most famous case of 
\begin_inset Formula $n$
\end_inset

-asymptotics, the maximum of the uniform distribution.
 The nonparametric bootstrap is inconsistent for the maximum in a uniform
 distribution, which we now show.
 
\end_layout

\begin_layout Example
(From 
\begin_inset CommandInset citation
LatexCommand cite
key "knight1989bootstrap"

\end_inset

) Let 
\begin_inset Formula $X_{1},...,X_{n}\stackrel{i.i.d.}{\sim}\mathcal{U}(0,\theta)$
\end_inset

, and denote the order statistics 
\begin_inset Formula $X_{(1)}<X_{(2)}<...<X_{(n)}$
\end_inset

.
 We wish to estimate the 
\begin_inset Formula $\theta$
\end_inset

 by its MLE, 
\begin_inset Formula $\widehat{\theta}_{n}=X_{(n)}$
\end_inset

.
 It is well known that 
\begin_inset Formula $H_{n}(P)=n\frac{\theta-X_{(n)}}{\theta}\stackrel{d}{\to}\exp(1)$
\end_inset

, and we take this as our root, with bootstrap variant 
\begin_inset Formula $H_{n}(P_{n})=n\frac{X_{(n)}-X_{(n)}^{*}}{X_{(n)}}.$
\end_inset

 First we find the unconditional distribution.
 Recall the distribution for the maximum of a sample 
\begin_inset Formula $Z_{1},...Z_{n}$
\end_inset

: 
\begin_inset Formula $P(Z_{(n)}\leq x)=P(Z_{1}\le x,Z_{2}\leq x,...,Z_{n}\leq x)=P(Z_{1}\leq x)^{n}$
\end_inset

, which we can use to find
\end_layout

\begin_layout Example
\begin_inset Formula 
\begin{eqnarray*}
P(X_{(n)}^{*}=X_{(n-i)}) & = & P(X_{(n)}^{*}\leq X_{(n-i)})-P(X_{(n)}^{*}<X_{(n-i)})\\
 & = & (1-\frac{i}{n})^{n}-(1-\frac{i+1}{n})^{n}\\
 & \approx & e^{-i}-e^{-(i+1)}.
\end{eqnarray*}

\end_inset

Also, it is assumed known that 
\end_layout

\begin_layout Example
\begin_inset Formula 
\[
(0,n(X_{(n)}-X_{(n-1)})/X_{(n)},n(X_{(n)}-X_{(n-2)})/X_{(n)},...)\tod(U_{1},U_{2},U_{3},...)
\]

\end_inset

where 
\begin_inset Formula $U_{1}=0$
\end_inset

, 
\begin_inset Formula $U_{i}=\sum_{j=2}^{i}V_{j}$
\end_inset

, with 
\begin_inset Formula $V_{1},V_{2},...$
\end_inset

 i.i.d.
 standard exponentials.
 Thus 
\begin_inset Formula $H_{n}^{*}$
\end_inset

 converges unconditionally to the mixture 
\begin_inset Formula $\sum_{i=1}^{\infty}\xi_{i}U_{i}$
\end_inset

, where 
\begin_inset Formula $\xi$
\end_inset

 is an infinite multinomial vector with cell probabilities 
\begin_inset Formula $p_{i}=e^{-i}-e^{-(i+1)}$
\end_inset

.
 
\end_layout

\begin_layout Example
Conditioning on 
\begin_inset Formula $X_{1},...,X_{n}$
\end_inset

, we get 
\begin_inset Formula $R_{n}(P_{n})=\sum_{i=0}^{n}\pi_{i}n\frac{X_{(n)}-X_{(n-i)}}{X_{(n)}}$
\end_inset

, where 
\begin_inset Formula $\pi_{i}$
\end_inset

 is a multinomial vector with cell probabilities 
\begin_inset Formula $(1-\frac{i}{n})^{n}-(1-\frac{i+1}{n})^{n}$
\end_inset

.
 Note that 
\begin_inset Formula $(1-\frac{i-1}{n})^{n}-(1-\frac{i}{n})^{n}\nearrow1-e^{-1}\approx0.632$
\end_inset

 when 
\begin_inset Formula $i=0$
\end_inset

.
 Since 
\begin_inset Formula $X_{(n)}-X_{(n-0)}=0$
\end_inset

, the bootstrap distribution will always have a point mass at 
\begin_inset Formula $0$
\end_inset

, sharply discordant with our wish for consistency.
 In fact, it has no limit distribution with probability 1, as both 
\begin_inset Formula $P(\limsup_{n\to\infty}n\frac{X_{(n)}-X_{(n-i)}}{X_{(n)}}=\infty)=1$
\end_inset

 and 
\begin_inset Formula $P(\liminf_{n\to\infty}n\frac{X_{(n)}-X_{(n-i)}}{X_{(n)}}=0)=1$
\end_inset

, see 
\begin_inset CommandInset citation
LatexCommand citet
key "bickel1981some"

\end_inset

.
\end_layout

\begin_layout Example
On the other hand, the parametric bootstrap is easily seen to be consistent.
 Conditioned on 
\begin_inset Formula $X_{1},X_{2},...$
\end_inset

,
\end_layout

\begin_layout Example
\begin_inset Formula 
\begin{eqnarray*}
P(n\frac{X_{(n)}-X_{(n)}^{*}}{X_{(n)}}\leq x) & = & P(X_{(n)}^{*}/X_{(n)}\geq1-\frac{x}{n}),\\
 & = & 1-(1-\frac{x}{n})^{n},\\
 & \to & 1-e^{-x}.
\end{eqnarray*}

\end_inset

As we can see, not only is the parametric bootstrap consistent, but we have
 the identity 
\begin_inset Formula $H_{n}(Q_{n})=H_{n}(P)$
\end_inset

 for every 
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Standard
An important task is to identify necessary and / or sufficient conditions
 for the non-parametric bootstrap to be consistent.
 This is a difficult task which goes far beyond the scope of this thesis,
 but we will supply some heuristics which indicates when we would expect
 the bootstrap to be consistent.
\end_layout

\begin_layout Quote
[...] The bootstrap is not foolproof, even for statistics whose asymptotic
 distribution is normal.
 Asymptotic optimality, or even consistency, of the bootstrap estimate 
\begin_inset Formula $H_{n}(\widehat{P}_{n})$
\end_inset

 is not to be expected unless 
\begin_inset Formula $H_{n}(P)$
\end_inset

 depends smoothly upon 
\begin_inset Formula $P$
\end_inset

.
\end_layout

\begin_layout Quote
\noindent
\align right
- Rudolph Beran in 
\begin_inset CommandInset citation
LatexCommand cite
key "beran1982estimated"

\end_inset


\end_layout

\begin_layout Standard
In accordance with this quote, 
\begin_inset CommandInset citation
LatexCommand cite
key "bickel1981some"

\end_inset

 propose the following heuristics for when we can expect consistency of
 the bootstrap,
\end_layout

\begin_layout Enumerate
Uniform convergence of 
\begin_inset Formula $H_{n}(Q_{n})$
\end_inset

 to 
\begin_inset Formula $H(P)$
\end_inset

 over all 
\begin_inset Formula $Q_{n}$
\end_inset

s in a shrinking neighbourhood around 
\begin_inset Formula $P$
\end_inset

;
\end_layout

\begin_layout Enumerate
\begin_inset Formula $H_{n}(P)$
\end_inset

 depends smoothly on 
\begin_inset Formula $P$
\end_inset

.
\end_layout

\begin_layout Standard
In the previous example 
\begin_inset Formula $H_{n}(P)$
\end_inset

 does not depend smoothly on 
\begin_inset Formula $P$
\end_inset

 whenever the 
\begin_inset Formula $P$
\end_inset

s are discrete.
 In cube root asymptotics, the smoothness condition is usually not satisfied,
 This is clearly seen in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:A-special-case"

\end_inset

 on the histograms, where a slight tilt in 
\begin_inset Formula $P$
\end_inset

, 
\emph on
even if 
\begin_inset Formula $P$
\end_inset

 is constrained to be smooth
\emph default
, can give a different rate of convergence (from 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

 to 
\begin_inset Formula $n^{\frac{1}{2}}$
\end_inset

).
 If 
\begin_inset Formula $P$
\end_inset

 isn't constrained to be smooth, the rate of convergence can even change
 from 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

 to 
\begin_inset Formula $n$
\end_inset

! The basic problem appears to be that 
\begin_inset Formula $H_{n}(Q_{n})$
\end_inset

 does not emulate 
\begin_inset Formula $H_{n}(P)$
\end_inset

 well whenever 
\begin_inset Formula $Q_{n}$
\end_inset

 is non-smooth, which is clearly the case when 
\begin_inset Formula $Q_{n}=P_{n}$
\end_inset

.
 This has lead to some work on the 
\emph on
smoothed bootstrap
\emph default
 in the context of cube root asymptotics.
 
\begin_inset CommandInset citation
LatexCommand citet
key "Kosorok2008"

\end_inset

 proved that the non-parametric bootstrap is inconsistent for Grenander's
 estimator, but developed a consistent variant of the smoothed bootstrap.
 
\begin_inset CommandInset citation
LatexCommand citet
key "abrevaya2005bootstrap"

\end_inset

 attempted to show that the ordinary bootstrap fails for Manski's estimator.
 However, as discussed in the paper of 
\begin_inset CommandInset citation
LatexCommand citet
key "sen2010inconsistency"

\end_inset

 on bootstrapping Grenander's estimator, their result is likely erroneous:
 Their result strongly indicate that the bootstrap distributions of cube
 root estimators have no weak limit almost surely, contradicting the main
 result of the aforementioned paper.
 
\begin_inset CommandInset citation
LatexCommand citet
key "leger2006bootstrap"

\end_inset

 made an attempt at a general theorem for proving consistency and inconsistency
 of bootstrap variants for cube root asymptotics.
 
\begin_inset CommandInset citation
LatexCommand citet
key "seijo2011bootstrapping"

\end_inset

 developed a variant of the smoothed bootstrap for Manski's estimator, which
 appears to work very well.
\end_layout

\begin_layout Subsection
Subsampling and 
\begin_inset Formula $m$
\end_inset

-out-of-
\begin_inset Formula $n$
\end_inset

 bootstrap
\end_layout

\begin_layout Standard
Subsampling is an alternative to the bootstrap procedure which is consistent
 in great generality, but usually requires larger sample sizes in order
 to work properly.
 it is also more computationally expensive, as we have to establish a certain
 nuisance parameter, the block size 
\begin_inset Formula $m$
\end_inset

.
 Let 
\begin_inset Formula $X_{1},X_{2},X_{3},...\stackrel{i.i.d.}{\sim}F$
\end_inset

 as usual, and let 
\begin_inset Formula $\widehat{\theta}_{n}$
\end_inset

 be a statistic of interest.
 Let 
\begin_inset Formula $R_{n}$
\end_inset

 be 
\begin_inset Formula $n^{\alpha}(\widehat{\theta}_{n}-\theta_{0})$
\end_inset

, for some 
\begin_inset Formula $\alpha>0$
\end_inset

, and 
\begin_inset Formula $H_{n}$
\end_inset

 be its distribution function.
 We assume that 
\begin_inset Formula $H_{n}\stackrel{d}{\to}H$
\end_inset

 as 
\begin_inset Formula $n\to\infty$
\end_inset

 for some continuous limit distribution 
\begin_inset Formula $H$
\end_inset

.
 
\end_layout

\begin_layout Standard
Choose a block size 
\begin_inset Formula $b<n$
\end_inset

.
 Define 
\begin_inset Formula $N_{n}=\binom{n}{b}$
\end_inset

 and let 
\begin_inset Formula $\widehat{\theta}_{n,b,i}$
\end_inset

 be the version of 
\begin_inset Formula $\widehat{\theta}$
\end_inset

 based on the 
\begin_inset Formula $i$
\end_inset

th sample from the 
\begin_inset Formula $\binom{n}{b}$
\end_inset

 subsets of 
\begin_inset Formula $X_{1},X_{2},...,X_{n}$
\end_inset

 with cardinality 
\begin_inset Formula $b$
\end_inset

.
 Define the distribution function 
\begin_inset Formula $L_{n}(x)$
\end_inset

 by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
L_{n}(x)=N_{n}^{-1}\sum_{i=1}^{N_{n}}\{b^{\alpha}(\widehat{\theta}_{n,b,i}-\widehat{\theta}_{n})\leq x\},
\]

\end_inset

where 
\begin_inset Formula $\{\cdot\}$
\end_inset

 is the characteristic function.
 Then 
\begin_inset Formula $L_{n,b}$
\end_inset

 is the
\emph on
 subsample distribution
\emph default
 based on 
\begin_inset Formula $X_{1},X_{2},...,X_{n}$
\end_inset

.
 Unlike the bootstrap, the subsample doesn't attempt to find the distribution
 
\begin_inset Formula $n^{\alpha}(\widehat{\theta}_{n}-\theta_{0}),$
\end_inset

 but rather 
\begin_inset Formula $b^{\alpha}(\widehat{\theta}_{b}-\theta_{0})$
\end_inset

, which gives it an additional source of variance.
 It depends on the fact that sampling 
\begin_inset Formula $b$
\end_inset

 elements from 
\begin_inset Formula $X_{1},X_{2},...,X_{n}$
\end_inset

 behaves like sampling from the real underlying distribution 
\begin_inset Formula $F$
\end_inset

, 
\emph on
regardless of the features of 
\begin_inset Formula $F$
\end_inset

, 
\emph default
provided only that 
\begin_inset Formula $bn^{-1}\to0$
\end_inset

 as 
\begin_inset Formula $b\to\infty$
\end_inset

.
\end_layout

\begin_layout Standard
The following is a variant of 
\begin_inset CommandInset citation
LatexCommand citet
after "theorem 2.1"
key "politis1994large"

\end_inset

.
 The proof is simple and illuminating, so we provide it in full.
 
\end_layout

\begin_layout Theorem
Let 
\begin_inset Formula $b_{n}$
\end_inset

 be a sequence of block sizes satisfying 
\begin_inset Formula $n^{-1}b_{n}\to0$
\end_inset

 as 
\begin_inset Formula $n\to\infty$
\end_inset

, and assume that 
\begin_inset Formula $H_{n}(P)\stackrel{d}{\to}H(P)$
\end_inset

, with 
\begin_inset Formula $H(P)$
\end_inset

 continuous.
 Then
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
\sup_{x}|L_{n}(x)-H(x)|\stackrel{p}{\to}0.
\]

\end_inset


\end_layout

\begin_layout Proof
Our first observation is
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
\{b^{\alpha}(\widehat{\theta}_{n,b,i}-\widehat{\theta}_{n})\leq x\} & = & \{b^{\alpha}(\widehat{\theta}_{n,b,i}-\theta_{0})-b^{\alpha}(\widehat{\theta}_{n}-\theta_{0})\leq x\}.
\end{eqnarray*}

\end_inset

Since the rate of convergence is 
\begin_inset Formula $n^{\alpha},$
\end_inset

 we have 
\begin_inset Formula $b^{\alpha}(\widehat{\theta}_{n}-\theta_{0})\stackrel{p}{\to}0$
\end_inset

.
 Define the random function 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
U_{n}(x)=N_{n}^{-1}\sum_{i=1}^{N_{n}}\{b^{\alpha}(\widehat{\theta}_{n,b,i}-\theta_{0})\leq x\}.
\]

\end_inset

Let 
\begin_inset Formula $\epsilon>0$
\end_inset

 and 
\begin_inset Formula $E_{n}$
\end_inset

 be the event that 
\begin_inset Formula $|b^{\alpha}(\widehat{\theta}_{n}-\theta_{0})|<\epsilon$
\end_inset

.
 Then we obtain the following,
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
U_{n}(x-\epsilon)1_{E_{n}}\leq L_{n}(x)1_{E_{n}}\leq U_{n}(x+\epsilon).
\]

\end_inset

If 
\begin_inset Formula $U_{n}(x)\stackrel{p}{\to}H(x)$
\end_inset

, we can pass 
\begin_inset Formula $\epsilon$
\end_inset

 to 
\begin_inset Formula $0$
\end_inset

 and obtain 
\begin_inset Formula $L_{n}(x)\stackrel{p}{\to}H(x)$
\end_inset

 as well, hence it suffices to show that 
\begin_inset Formula $U_{n}(x)\stackrel{p}{\to}H(x)$
\end_inset

.
 Clearly 
\begin_inset Formula $E(U_{n}(x))=H_{n}(x)$
\end_inset

, and we only need to show that 
\begin_inset Formula $\textrm{Var}U_{n}(x)\to0$
\end_inset

.
 We can do this by an application of the Rao-Blackwell theorem 
\begin_inset CommandInset citation
LatexCommand citep
after "2.5"
key "shaomath"

\end_inset

: When 
\begin_inset Formula $T$
\end_inset

 is a sufficient statistic for 
\begin_inset Formula $\mathcal{P}$
\end_inset

 and 
\begin_inset Formula $W$
\end_inset

 is an unbiased estimator of a statistic 
\begin_inset Formula $\tau(P)$
\end_inset

, then 
\begin_inset Formula $W'=E(W|T)$
\end_inset

 has less variance than 
\begin_inset Formula $W$
\end_inset

 for every 
\begin_inset Formula $P\in\mathcal{P}$
\end_inset

.
 Now define 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
U_{n}^{'}=m^{-1}\sum_{i=0}^{m-1}\{b^{\alpha}(\widehat{\theta}_{m,i}-\theta_{0})\leq x\},
\]

\end_inset

where 
\begin_inset Formula $m=\lfloor n/b\rfloor$
\end_inset

 and 
\begin_inset Formula $\widehat{\theta}_{m,i}$
\end_inset

 is 
\begin_inset Formula $\widehat{\theta}$
\end_inset

 calculated from sequence 
\begin_inset Formula $X_{mb+1},X_{mb+2},...,X_{(m+1)b}$
\end_inset

.
 This is a mean of 
\begin_inset Formula $m$
\end_inset

 identically distributed random variables with variance bounded by 
\begin_inset Formula $1$
\end_inset

, hence 
\begin_inset Formula $\mathrm{Var}L_{n}^{'}\to0$
\end_inset

.
 Also, 
\begin_inset Formula $EL_{n}^{'}=H(x)$
\end_inset

.
 Since the order of the observations 
\begin_inset Formula $X_{1},X_{2},...$
\end_inset

 contains no information about 
\begin_inset Formula $H_{n}(x)$
\end_inset

, the Rao-Blackwell theorem gives us
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\textrm{Var}E(L_{n}^{'}\mid X_{(1)},X_{(2)},...)\leq\textrm{Var}L_{n}^{'}.
\]

\end_inset

Seeing as 
\begin_inset Formula $E(L_{n}^{'}\mid X_{(1)},X_{(2)},...)=U_{n}$
\end_inset

, the subsample converges pointwise in probability.
 By Lemma 2.11 in 
\begin_inset CommandInset citation
LatexCommand citet
key "van2000asymptotic"

\end_inset

, the convergence is uniform.
\end_layout

\begin_layout Standard
The subsample has been applied on Manski's estimator (Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Manski's-maximum-score"

\end_inset

) by 
\begin_inset CommandInset citation
LatexCommand citet
key "delgado2001subsampling"

\end_inset

, who obtained good results.
 In ordinary, smooth statistics, the subsample typically behaves worse than
 the non-parametric bootstrap: While the bootstrap has an error of order
 
\begin_inset Formula $o(n^{-\frac{1}{2}})$
\end_inset

, the subsample bootstrap has an error of order 
\begin_inset Formula $O(n^{-\frac{1}{3}})$
\end_inset

, which is substantially worse 
\begin_inset CommandInset citation
LatexCommand citep
key "politis1994large"

\end_inset

.
 Here the error refers to 
\begin_inset Formula $|L_{n}(t)-H_{n}(t)|$
\end_inset

.
 
\end_layout

\begin_layout Standard
A similar method is the 
\begin_inset Formula $m$
\end_inset

-out-of-
\begin_inset Formula $n$
\end_inset

 bootstrap 
\begin_inset CommandInset citation
LatexCommand citep
key "lee2006m"

\end_inset

, a variant of the subsample with block size 
\begin_inset Formula $m$
\end_inset

 where the sampling is done 
\emph on
with
\emph default
 replacement.
 Under extremely general conditions both the 
\begin_inset Formula $m$
\end_inset

-out-of-
\begin_inset Formula $n$
\end_inset

 bootstrap and 
\begin_inset Formula $m$
\end_inset

-subsampling are consistent provided 
\begin_inset Formula $\frac{m}{n}\to0$
\end_inset

 as 
\begin_inset Formula $n\to\infty$
\end_inset

.
 Yet this doesn't give us much guidance in how to select the 
\begin_inset Formula $m$
\end_inset

 in practice.
 In applications, this choice is made by doing even more resampling.
 
\end_layout

\begin_layout Standard
Say we're interested in obtaining a confidence interval with level 
\begin_inset Formula $\alpha$
\end_inset

 for an estimator 
\begin_inset Formula $\widehat{\theta}$
\end_inset

.
 For each choice of 
\begin_inset Formula $m$
\end_inset

, we can approximate this interval by 
\begin_inset Formula $[\frac{\frac{\alpha}{2}_{m}}{n^{\frac{1}{3}}}+\widehat{\theta},\frac{(1-\frac{\alpha}{2})_{m}}{n^{\frac{1}{3}}}+\widehat{\theta}]$
\end_inset

, where 
\begin_inset Formula $\alpha_{m}$
\end_inset

 is the 
\begin_inset Formula $\alpha$
\end_inset

-quantile of 
\begin_inset Formula $m^{\frac{1}{3}}(\widehat{\theta}_{m}^{*}-\widehat{\theta})$
\end_inset

.
 All confidence intervals will not have level 
\begin_inset Formula $\alpha$
\end_inset

, but rather level 
\begin_inset Formula $h_{\alpha}(m)$
\end_inset

 for some unknown function 
\begin_inset Formula $h_{\alpha}$
\end_inset

 dependent on the data generating mechanism.
 Now we wish to find the 
\begin_inset Formula $m$
\end_inset

 such that 
\begin_inset Formula $|h_{\alpha}(m)-\alpha|$
\end_inset

 is minimised.
 Since 
\begin_inset Formula $h_{\alpha}$
\end_inset

 is unknown in general, we will have to estimate it with 
\begin_inset Formula $\widehat{h}$
\end_inset

.
 
\begin_inset CommandInset citation
LatexCommand citet
key "delgado2001subsampling"

\end_inset

 propose the 
\emph on
calibration method, 
\emph default
where they use the ordinary, non-parametric bootstrap for this purpose.
 It is described in Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:Calibration method"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Enumerate
Select lower and upper bounds for 
\begin_inset Formula $m$
\end_inset

, called 
\begin_inset Formula $l$
\end_inset

 and 
\begin_inset Formula $u$
\end_inset

 respectively, and minimum step 
\begin_inset Formula $s$
\end_inset

.
 We intend to check subsamples of sizes 
\begin_inset Formula $l,l+s,\ldots,u-s,u$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
For 
\begin_inset Formula $k=1,...K$
\end_inset

, generate 
\begin_inset Formula $n$
\end_inset

 bootstrap samples 
\begin_inset Formula $X_{1k}^{*},X_{2l}^{*},\ldots,X_{nk}^{*}$
\end_inset

.
 For each applicable subsample size 
\begin_inset Formula $m$
\end_inset

, put 
\begin_inset Formula $H(m,k)=1$
\end_inset

 if 
\begin_inset Formula $\widehat{\theta}$
\end_inset

 is in the 
\begin_inset Formula $m$
\end_inset

-subsampling confidence interval based on these observations, and 
\begin_inset Formula $0$
\end_inset

 otherwise.
\end_layout

\begin_layout Enumerate
Put 
\begin_inset Formula $\widehat{h}(m)=\frac{1}{K}\sum_{k=1}^{K}H(m,k)$
\end_inset


\end_layout

\begin_layout Enumerate
Minimise 
\begin_inset Formula $|\widehat{h}(m)-\alpha|$
\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:Calibration method"

\end_inset

The calibration method of 
\begin_inset CommandInset citation
LatexCommand citet
key "delgado2001subsampling"

\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Manski's maximum score estimator
\begin_inset CommandInset label
LatexCommand label
name "chap:Manski's-maximum-score"

\end_inset


\end_layout

\begin_layout Quote
\noindent
\align right
Sometimes in football you have to score goals.
\end_layout

\begin_layout Quote
\noindent
\align right
- Thierry Henry, former Arsenal and France striker
\end_layout

\begin_layout Standard
Manski's maximum score estimator is a discontinuous 
\begin_inset Formula $M$
\end_inset

-estimator with cube root asymptotics.
 In Section 1 we supply the definition of the estimator along with some
 discussion about what it does.
 In Section 2 we provide some characterisations of the associated optimisation
 problem, prove that it is 
\begin_inset Formula $NP$
\end_inset

-hard, and discuss some related estimators.
 Section 3 is devoted to its asymptotics, with special emphasis on the condition
s leading to consistency.
 There are no proofs in this Section.
 Section 4 is devoted to algorithms for its computation.
 We supply a reformulation of the only workable exact algorithm in the statistic
al literature, and provide a new exact algorithm (a complete enumeration)
 for the computation of the entire solution sets when the covariate dimension
 is 
\begin_inset Formula $d\leq2$
\end_inset

.
 Robustness is the theme of Section 5, where we find the breakdown point
 of the estimator in 
\begin_inset Formula $d=1$
\end_inset

, and make progress towards finding it in 
\begin_inset Formula $d>1$
\end_inset

.
 Finally, we do some simulations to asses the estimator's model robustness
 and outlier robustness under some different settings, replicating a result
 of 
\begin_inset CommandInset citation
LatexCommand citet
key "horowitz1992smoothed"

\end_inset

.
\end_layout

\begin_layout Section
Overview
\end_layout

\begin_layout Standard
A linear binary response model
\emph on
 
\emph default
is a regression model 
\begin_inset Formula $Y_{i}=1_{X_{i}^{T}\beta+\epsilon_{i}\geq0}$
\end_inset

, where the 
\begin_inset Formula $X_{i}$
\end_inset

s are covariates and 
\begin_inset Formula $\epsilon_{i}$
\end_inset

s are random variables not necessarily independent of the 
\begin_inset Formula $X_{i}$
\end_inset

s, but independent of each other.
 Several parametric binary choice models exists, of which the most famous
 are the logit and probit models.
 The logit model arises from taking 
\begin_inset Formula $\epsilon_{i}$
\end_inset

 i.i.d.
 standard logistic (
\begin_inset Formula $F(x)=\frac{\exp(x)}{1+\exp(x)}$
\end_inset

), while the probit model arises from taking 
\begin_inset Formula $\epsilon_{i}$
\end_inset

 i.i.d.
 standard normal.
 
\end_layout

\begin_layout Fact
The logit and probit models are the binary choice models where 
\begin_inset Formula $\epsilon_{i}\stackrel{i.i.d.}{\sim}\textrm{Logistic}(0,1)$
\end_inset

 and 
\begin_inset Formula $\epsilon_{i}\stackrel{i.i.d.}{\sim}N(0,1)$
\end_inset

 respectively.
\end_layout

\begin_layout Proof
Assume 
\begin_inset Formula $\epsilon_{i}\stackrel{i.i.d.}{\sim}\textrm{Logistic}(0,1)$
\end_inset

, and let 
\begin_inset Formula $F$
\end_inset

 be its cdf.
 Then 
\begin_inset Formula $Y_{i}=1$
\end_inset

 if and only if 
\begin_inset Formula $X_{i}^{T}\beta\geq-\epsilon_{i}$
\end_inset

, which since 
\begin_inset Formula $F$
\end_inset

 is symmetric has probability 
\begin_inset Formula $F(X_{i}^{T}\beta)$
\end_inset

.
 The same argument works for the probit model.
 
\end_layout

\begin_layout Standard
While these two methods are very popular (389,000 results on Google Scholar
 for 
\begin_inset Quotes eld
\end_inset

logit
\begin_inset Quotes erd
\end_inset

 in august 2015, 266,000 for 
\begin_inset Quotes eld
\end_inset

probit
\begin_inset Quotes erd
\end_inset

), they have rather strict distributional assumptions.
 Most importantly, they exclude heteroskedasticity and react poorly to non-symme
tric error distributions.
\end_layout

\begin_layout Standard
We will consider a conditional median variant of the binary response model.
 This problem can be viewed as an instance of quantile regression with missing
 data.
 Let the underlying model be 
\begin_inset Formula $Z_{i}=X_{i}^{T}\beta+\epsilon_{i}$
\end_inset

, where the conditional median is required to be 
\begin_inset Formula $0$
\end_inset

: 
\begin_inset Formula $\textrm{med}(\epsilon_{i}|X_{i})=0$
\end_inset

.
 We don't assume independence of the 
\begin_inset Formula $\epsilon_{i}$
\end_inset

s, but we observe only the tuple 
\begin_inset Formula $(1_{[W_{i}\geq0]},X_{i})$
\end_inset

.
 Hence there is a tremendous information loss involved in this model, an
 information loss so severe that 
\begin_inset Formula $\sqrt{n}$
\end_inset

-consistent estimation under general conditions is impossible, as shown
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "chamberlain1986asymptotic"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "manski1975maximum,manski1985semiparametric"

\end_inset

 proposed a semiparametric estimator of the binary choice model which is
 consistent provided only 
\begin_inset Formula $\textrm{med}(\epsilon_{i}|X_{i})=0$
\end_inset

 (in addition to several regularity conditions discussed in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Manski Asymptotics"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\widehat{\beta} & = & \argmax\left[\sum_{i=1}^{n}(Y_{i}-\frac{1}{2})1_{X_{i}^{T}\beta\geq0}\right],\label{eq:Manskis estimator}\\
 & = & \argmax\left[\sum_{i=1}^{n}\left(Y_{i}1_{X_{i}^{T}\beta\geq0}+(1-Y_{i})1_{X_{i}^{T}\beta<0}\right)\right].\nonumber 
\end{eqnarray}

\end_inset

Notice that the estimator maximises the number of correct predictions, which
 makes it unusually easy to interpret.
 The function 
\begin_inset Formula 
\begin{equation}
m(\beta)=\sum_{i=1}^{n}(Y_{i}-\frac{1}{2})1_{X_{i}^{T}\beta\geq0}\label{eq:Manski's objective}
\end{equation}

\end_inset

will sometimes be called 
\emph on
Manski's objective
\emph default
.
\end_layout

\begin_layout Standard
The set 
\begin_inset Formula $\{x\mid x{}^{T}\beta\geq0\}$
\end_inset

 is a half-plane in 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

.
 Colour the points where 
\begin_inset Formula $Y_{i}=1$
\end_inset

 red, and the other points blue, and classify every point in the hyperplane
 
\begin_inset Formula $\{x\mid x{}^{T}\beta\geq0\}$
\end_inset

 as red, the others as blue.
 Then Manski's estimator finds the half-planes which classifies correctly
 the largest number of observed points.
 In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Manski's estimator illustration"

\end_inset

 we illustrate this by plotting 
\begin_inset Quotes eld
\end_inset

discriminating lines
\begin_inset Quotes erd
\end_inset

 of the form 
\begin_inset Formula $x{}^{T}\beta=0$
\end_inset

.
 If our objective is to obtain good discriminating lines, as compared to
 obtaining parameter estimates for 
\begin_inset Formula $\beta$
\end_inset

, the setting changes from that of Manski's estimator to that of 
\emph on
linear discrimination
\emph default
.
 A discriminator based on 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Manskis estimator"

\end_inset

 is discussed in e.g.
 
\begin_inset CommandInset citation
LatexCommand citet
after "Section 4.5"
key "devroye2013probabilistic"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Manski/SplittingLineManskiLogit.pdf
	scale 40

\end_inset


\begin_inset Graphics
	filename OppgaveR/Manski/SolutionSets.pdf
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Manski's estimator illustration"

\end_inset

(left) Generated data according to the probit model, with 
\begin_inset Formula $\beta_{1}=-1$
\end_inset

, 
\begin_inset Formula $\beta_{2}=-\frac{1}{2}$
\end_inset

, 
\begin_inset Formula $n=40$
\end_inset

.
 (Also,  
\begin_inset Formula $\beta_{0}\stackrel{def}{=}1$
\end_inset

.) Here the green line is the true discriminating line, the orange line is
 the logistic line (from maximum likelihood), and the pink and purple lines
 are lines arising from Manski's estimator.
 Both Manski lines misclassify three points, while the logistic line misclassifi
es four points.
 (right) Another simulated data set (
\begin_inset Formula $n=30$
\end_inset

, from the same model) with Manski lines in purple and pink.
 Notice that both pink lines pass through a single blue point and form a
 
\begin_inset Quotes eld
\end_inset

double wedge
\begin_inset Quotes erd
\end_inset

.
 Every line in between the bounding lines misclassify two observations,
 and likewise for the purple lines.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For identifiability, we can postulate 
\begin_inset Formula $||\beta||=1$
\end_inset

, where 
\begin_inset Formula $||\cdot||$
\end_inset

 is the Euclidean distance.
 Such a move is required as we have not imposed any scale on the residuals
 
\begin_inset Formula $\epsilon_{i}.$
\end_inset

 Another variant is to impose 
\begin_inset Formula $\beta_{0}=-1$
\end_inset

, 
\begin_inset Formula $\beta_{0}=0$
\end_inset

 or 
\begin_inset Formula $\beta_{0}=1$
\end_inset

.
 Most of our discussion will concern the case when 
\begin_inset Formula $\beta_{0}=1$
\end_inset

, which is easier to analyse than 
\begin_inset Formula $||\beta||=1$
\end_inset

.
 If we know all the solutions for 
\begin_inset Formula $\beta_{0}=-1,0,1$
\end_inset

, it is easy to find the solutions corresponding to 
\begin_inset Formula $||\beta||=1$
\end_inset

.
 
\end_layout

\begin_layout Standard
If the assumptions of the probit model or logit model are close to being
 true, to use this estimator would be a very bad idea.
 Not only is it very inefficient, its limiting distribution is intractable,
 and requires resampling.
 But this resampling creates a huge computational burden, and behaves poorly
 when it comes to coverage and size of confidence intervals, etc.
 Additionally, the theory for the logit and probit is very well worked out,
 and its standard asymptotics under maximum likelihood makes it possible
 to use a wealth of different procedures for model selection.
 For instance the likelihood ratio test, AIC, BIC and FIC 
\begin_inset CommandInset citation
LatexCommand citep
key "claeskens2008model"

\end_inset

.
 Also, Manski's estimator gives information about the 
\begin_inset Formula $\beta$
\end_inset

s only.
 If we want to calculate functionals involving the error term 
\begin_inset Formula $\epsilon$
\end_inset

 in some way, like estimating the probability on whether a subject with
 covariates 
\begin_inset Formula $X'$
\end_inset

 will have 
\begin_inset Formula $Y'\geq0$
\end_inset

, we will require a probability model 
\begin_inset Formula $F$
\end_inset

 for the error terms.
 Since we allow for arbitrary heteroskedasticity and general 
\begin_inset Quotes eld
\end_inset

wildness
\begin_inset Quotes erd
\end_inset

 in the errors, it is impossible to consistently estimate the probability
 distributions of the errors.
\end_layout

\begin_layout Standard
A slight generalisation of the estimator allows non-zero weights 
\begin_inset Formula $w_{i}$
\end_inset

 on the observations,
\begin_inset Formula 
\begin{eqnarray}
\widehat{\beta} & = & \argmax\left[\sum_{i=1}^{n}w_{i}(Y_{i}-\frac{1}{2})1_{\beta^{T}X_{i}\geq0}\right],\label{eq:Manskis estimator (weighted)}
\end{eqnarray}

\end_inset

a variant we will devise an algorithm to solve.
 It is useful to have an algorithm for the weighted variant for practical
 reasons, in particular when performing the bootstrap, as our algorithm
 will not handle observations that aren't in general position: It is easier
 to treat two identical observations as one observation with twice the weight.
 Also, the algorithm is just as fast for the weighted variant as for the
 non-weighted, and not much more difficult to implement.
\end_layout

\begin_layout Standard
In this entire chapter we assume that the covariates are in general position:
 There are no parallel lines among the covariates, and there is no index
 
\begin_inset Formula $i$
\end_inset

 with 
\begin_inset Formula $\overline{x_{i}}=\overline{0}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Recall the equivariance properties from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Least-median-squares"

\end_inset

.
 There we defined regression, affine and scale equivariance for regression
 estimators.
 The regression and scale equivariance concepts don't make sense in the
 context of the binary response model, as they involve continuous transformation
s of the responses 
\begin_inset Formula $y_{i}$
\end_inset

.
 Still, Manski's estimator does satisfy the affine equivariance property.
\end_layout

\begin_layout Proposition
Manski's estimator is affine equivariant.
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $\widehat{\beta}=\argmax\left[\sum_{i=1}^{n}(Y_{i}-\frac{1}{2})1_{\beta^{T}X_{i}\geq0}\right]$
\end_inset

 be the set of solutions to Manski's objective function.
 The only place 
\begin_inset Formula $X_{i}$
\end_inset

 is involved in 
\begin_inset Formula $\sum_{i=1}^{n}(Y_{i}-\frac{1}{2})1_{\beta^{T}X_{i}\geq0}$
\end_inset

 is in 
\begin_inset Formula $1_{\beta^{T}X_{i}\geq0}$
\end_inset

.
 Clearly, each of these characteristic functions stay the same when substituting
 
\begin_inset Formula $AX_{i}$
\end_inset

 for 
\begin_inset Formula $X_{i}$
\end_inset

 and 
\begin_inset Formula $(A^{-1})^{T}\beta$
\end_inset

 for 
\begin_inset Formula $\beta$
\end_inset

, showing that 
\begin_inset Formula $\sum_{i=1}^{n}(Y_{i}-\frac{1}{2})1_{((A^{-1})^{T}\widehat{b})^{T}AX_{i}\geq0}=\sum_{i=1}^{n}(Y_{i}-\frac{1}{2})1_{\widehat{b}^{T}X_{i}\geq0}$
\end_inset

 whenever 
\begin_inset Formula $\widehat{b}\in\widehat{\beta}$
\end_inset

.
 Since 
\begin_inset Formula $A$
\end_inset

 is invertible, this can be done the other way around as well.
 This proves that 
\begin_inset Formula $(A^{-1})^{T}\widehat{\beta}$
\end_inset

 is the solution set of the transformed 
\begin_inset Formula $\sum_{i=1}^{n}(Y_{i}-\frac{1}{2})1_{\beta^{T}AX_{i}\geq0}$
\end_inset

.
\end_layout

\begin_layout Section
Characterisations
\end_layout

\begin_layout Standard
It is easier to understand the estimator through two equivalent characterisation
s, one algebraic and one geometric.
 Also of interest is its relation to Tukey's concept of 
\emph on
location depth, 
\emph default
a generalisation of the concept of ranks to higher dimensions.
\end_layout

\begin_layout Subsection
Algebraic formulation
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $A$
\end_inset

 be an 
\begin_inset Formula $n\times d$
\end_inset

-matrix, and 
\begin_inset Formula $b\in\mathbb{R}^{n}$
\end_inset

.
 We say that the system of linear inequalities 
\begin_inset Formula $Ax\leq b$
\end_inset

 is 
\emph on
feasible 
\emph default
if there exists a solution to it; if there is no solution, it is called
 
\emph on
infeasible.

\emph default
 These terms have the same meaning whenever 
\begin_inset Formula $C$
\end_inset

 is a collection of linear inequalities.
 Given an infeasible linear system, it is often of interest to find a maximal
 subsystem which is feasible, that is, a feasible collection 
\begin_inset Formula $C$
\end_inset

 of inequalities from 
\begin_inset Formula $Ax\leq b$
\end_inset

 of cardinality 
\begin_inset Formula $k$
\end_inset

 such that there exists no feasible collection of cardinality greater than
 
\begin_inset Formula $k$
\end_inset

.
 This problem is of importance in linear programming, as the constraints
 in such problems easily can turn out to be inconsistent.
\end_layout

\begin_layout Definition
Given a system 
\begin_inset Formula $Ax\leq b$
\end_inset

 of linear inequalities, MAX-FLS (maximal feasible linear subsystem) is
 the problem of described above.
 Its corresponding decision problem, FLS(k), decides whether there is a
 feasible linear subsystem of cardinality 
\begin_inset Formula $k$
\end_inset

.
\end_layout

\begin_layout Standard
Now we will show that solution sets for Manski's estimator 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Manskis estimator"

\end_inset

 are exactly the solution sets to a certain MAX-FLS problem.
 For this, define 
\begin_inset Formula $X_{i0}=1$
\end_inset

 for every 
\begin_inset Formula $i$
\end_inset

.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:AlgebraCharacterisation"

\end_inset

Let 
\begin_inset Formula $X_{1},\ldots,X_{n}\in\mathbb{R}^{d}$
\end_inset

 and 
\begin_inset Formula $Y_{1},\ldots,Y_{n}\in\{0,1\}$
\end_inset

.
 Let 
\begin_inset Formula $X^{*}$
\end_inset

 be the 
\begin_inset Formula $(n,d+1)-$
\end_inset

matrix with elements 
\begin_inset Formula 
\begin{equation}
x_{ij}^{*}=\begin{cases}
X_{i(j-1)} & \textrm{when }Y_{i}=1,\\
-X_{i(j-1)} & \textrm{when }Y_{i}=0.
\end{cases}\label{eq:Manskimatrix}
\end{equation}

\end_inset

Then 
\begin_inset Formula $\beta^{*}$
\end_inset

 is an inner solution to 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Manskis estimator"

\end_inset

 if and only if 
\begin_inset Formula $\beta^{*}$
\end_inset

 is a solution to the MAX-FLS of 
\begin_inset Formula $X^{*}\beta<0$
\end_inset

.
\end_layout

\begin_layout Proof
In 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Manskis estimator"

\end_inset

 we wish to maximise the amount of inequalities of the form
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray}
-\beta_{0}-\beta_{1}X_{i1}...-\beta_{d}X_{id}\leq0 & \textrm{when} & Y_{i}=1,\label{eq:geometrilikninger}\\
\beta_{0}+\beta_{1}X_{i1}+...+\beta_{d}X_{id}<0 & \textrm{when} & Y_{i}=0,\nonumber 
\end{eqnarray}

\end_inset

that are simultaneously satisfied.
 Intuitively, one satisfied inequality corresponds to one correct prediction,
 and we wish to maximise the amount of correct predictions.
 When 
\begin_inset Formula $\beta^{*}$
\end_inset

 is an inner solution to such a set of inequalities, we can substitute any
 instance of 
\begin_inset Formula $\leq$
\end_inset

 for 
\begin_inset Formula $<$
\end_inset

.
 Since 
\begin_inset Formula $X^{*}$
\end_inset

 is the representation of this collection of inequalities in matrix form,
 we are done.
\end_layout

\begin_layout Standard
In the sequel we will use the representation 
\begin_inset Formula $X^{*}\beta\leq0$
\end_inset

 instead of 
\begin_inset Formula $X^{*}\beta<0$
\end_inset

.
 This adds more solutions at the boundaries, but doing the bookkeeping on
 whether a certain inequality is strict or not is messy.
 Doing this will not cause any problems in practice.
 If we want to use the spherical scaling 
\begin_inset Formula $||\beta||=1$
\end_inset

, we would intersect the solution set with 
\begin_inset Formula $S^{d}$
\end_inset

.
 If we want to use the more restrictive scaling 
\begin_inset Formula $\beta=-1,0,1$
\end_inset

, we will instead use a different matrix (with dimensions 
\begin_inset Formula $d\times n$
\end_inset

): Namely 
\begin_inset Formula $X^{*}$
\end_inset

 such that 
\begin_inset Formula 
\[
x_{ij}^{*}=\begin{cases}
X_{ij}, & \textrm{when }Y_{i}=1,\\
-X_{ij} & \textrm{when }Y_{i}=0.
\end{cases}
\]

\end_inset

Notice that we have dropped the intercept.
 Now 
\begin_inset Formula $\beta=-1$
\end_inset

 corresponds to 
\begin_inset Formula $X^{*}\beta\leq1$
\end_inset

, 
\begin_inset Formula $\beta=0$
\end_inset

 corresponds to 
\begin_inset Formula $X^{*}\beta\leq0$
\end_inset

 and 
\begin_inset Formula $\beta=1$
\end_inset

 corresponds to 
\begin_inset Formula $X^{*}\beta\leq-1$
\end_inset

.
\end_layout

\begin_layout Standard
Perhaps the most striking about this characterisation is the fact that solutions
 are never unique, provided the observations are in general position.
 This is problematic for several reasons.
 First, it makes resampling difficult.
 It is not clear which point we will choose as a centre in the bootstrap
 or which points to choose from the resampled solutions.
 This problem is even larger than it looks, because small resampling sizes
 will often give unbounded solution regions, and we will have to use small
 samples in order to make the 
\begin_inset Formula $m$
\end_inset

-out-of-
\begin_inset Formula $n$
\end_inset

 bootstrap work.
 Second, it is possible for qualitatively very different points to be maximal.
\end_layout

\begin_layout Subsection
Geometry
\begin_inset CommandInset label
LatexCommand label
name "sub:Manski geometry"

\end_inset


\end_layout

\begin_layout Standard
Building on results in the previous section, we present the basic geometry
 of the problem.
 Recall the equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:geometrilikninger"

\end_inset

,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
-\beta_{0}-\beta_{1}X_{i1}-...-\beta_{d}X_{id}\leq0 & \textrm{when} & Y_{i}=1,\\
-\beta_{0}+\beta_{1}X_{i1}+...+\beta_{d}X_{id}<-0 & \textrm{when} & Y_{i}=0.
\end{eqnarray*}

\end_inset

These describe a collection of affine hyperplanes.
 Define 
\begin_inset Formula $H_{i}$
\end_inset

 as the halfspace corresponding to 
\begin_inset Formula $i$
\end_inset

-th observation.
 Then we have a geometric analogue to Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:AlgebraCharacterisation"

\end_inset

, namely:
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "lem:Geometry characterization"

\end_inset

A point 
\begin_inset Formula $\beta$
\end_inset

 is a solution to Manski's objective 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Manskis estimator (weighted)"

\end_inset

 if and only if there is a 
\begin_inset Formula $k$
\end_inset

 and distinct indices 
\begin_inset Formula $i_{1},...,i_{k}$
\end_inset

 such that 
\begin_inset Formula $\beta\in\bigcap_{i=1}^{k}H_{i_{k}}$
\end_inset

 and 
\begin_inset Formula $k$
\end_inset

 is maximal in the following sense: Whenever 
\begin_inset Formula $j_{1},...,\, j_{k},\, j_{k+1}$
\end_inset

is are distinct indices, 
\begin_inset Formula $\bigcap_{i=1}^{k+1}H_{i_{k}}$
\end_inset

 is empty.
\end_layout

\begin_layout Standard
The kind of set described in Proposition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "lem:Geometry characterization"

\end_inset

 will variably be called a 
\emph on
maximal non-empty intersection
\emph default
 or a solution polytope.
 When we include weights 
\begin_inset Formula $w=(w_{1},...,w_{n})$
\end_inset

, the analogue is 
\emph on

\begin_inset Formula $w$
\end_inset

-maximal non-empty intersection.
 
\emph default
A set like this is a convex polytope, potentially unbounded.
 Note that we are 
\emph on
not
\emph default
 looking for a convex polytope with a maximal number of bounding cells.
 For it is straight forward to construct a convex polytope with more bounding
 cells than any other convex polytope which isn't a maximal non-empty intersecti
on in our sense.

\emph on
 
\emph default
The entire solution set is a disjoint union of such sets (that is, disjoint
 modulo the boundaries of the planes), which might be many: There is no
 guarantee of having a unique, connected solution set even when 
\begin_inset Formula $n$
\end_inset

 is large.
 We provide an example of a solution set consisting of three polygons in
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Manski 2D many solutions"

\end_inset

.
 Frequently we will talk about coloured halplanes, where a blue half-plane
 points downwards while a red half-plane points upwards.
 The intuition behind this colouring should be clear from Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Manski 2D many solutions"

\end_inset

.
\end_layout

\begin_layout Standard
Notice that the estimator is very dependent on the values of the covariates.
 Certainly far more than, for instance, logistic regression, which only
 demands the ordinary Lindeberg conditions on the covariates distribution
 
\begin_inset Formula $G$
\end_inset

.
 In our case, it will often be very difficult to get precise estimates when
 the covariates aren't distributed 
\begin_inset Quotes eld
\end_inset

nicely
\begin_inset Quotes erd
\end_inset

 enough relatively to the actual parameter values, an issue we will discuss
 further in Section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Manski illustrations"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Manski/threeSolutionsExample7.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Manski 2D many solutions"

\end_inset

Random lines in the plane.
 The black lines delineate the solution sets.
 The red lines represents half-planes pointing upwards, while the blue lines
 represent half-planes pointing downwards.
 All points in the solution set lies in the intersection of exactly 5 half-plane
s.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Number of faces in an arrangement
\end_layout

\begin_layout Standard
The world of Manski's estimator in dimension 
\begin_inset Formula $d$
\end_inset

 contains 
\begin_inset Formula $n$
\end_inset

 coloured hyperplanes in 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

, and a matter of interest is the 
\begin_inset Formula $d$
\end_inset

-polytopes bounded by these coloured hyperplanes.
 Modulo the colours, this is a fundamental object of study in discrete and
 computational geometry 
\begin_inset CommandInset citation
LatexCommand citep
after "chapter 6"
key "matouvsek2002lectures"

\end_inset

.
 Proposition 6.1.1 from that book is illuminating.
 The faces of an arrangement are the minimal 
\begin_inset Formula $d$
\end_inset

-polytopes, polytopes that can't be made smaller by cutting it with yet
 another hyperplane from the arrangement.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:Arrangement"

\end_inset

The number of faces in a simple arrangement of 
\begin_inset Formula $n$
\end_inset

 hyperplanes 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

 (an arrangement where all hyperplanes are in general position) equals
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
\Phi_{d}(n)=\sum_{i=1}^{d}\binom{n}{i}.
\]

\end_inset


\end_layout

\begin_layout Standard
The kind of polytopes we are interested in result from the intersection
 of half-planes, and there will necessarily be fewer of them.
 It would be interesting to find an analogue of this theorem for coloured
 hyperplanes, though we would most likely have to be content with upper
 and lower bounds.
 An interesting corollary concerns resampling, 
\end_layout

\begin_layout Corollary
For any resampling procedure, the maximal amount of distinct possible solution
 sets is bounded above by 
\begin_inset Formula $\sum_{i=1}^{d}\binom{n}{i}$
\end_inset

.
\end_layout

\begin_layout Standard
This is in acute contrast with smooth estimators.
 As an example, take the mean of 
\begin_inset Formula $X_{i}\stackrel{i.i.d.}{\sim}F$
\end_inset

, 
\begin_inset Formula $i=1,...,n$
\end_inset

, where 
\begin_inset Formula $F$
\end_inset

 has a density.
 Then the non-parametric bootstrap has 
\begin_inset Formula $\binom{2n-1}{n}$
\end_inset

 distinct solutions, the subsampler has 
\begin_inset Formula $\binom{n}{m}$
\end_inset

 and 
\begin_inset Formula $m$
\end_inset

-out-of-
\begin_inset Formula $n$
\end_inset

 has 
\begin_inset Formula $\binom{n+m-1}{m}$
\end_inset

.
 This alone could give an indication of why the bootstrap tends to fail
 for estimators with cube root asymptotics.
\end_layout

\begin_layout Standard
For coloured hyperplanes and 
\begin_inset Formula $d=1$
\end_inset

, the upper bound in Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Arrangement"

\end_inset

 can be improved to
\begin_inset Formula $\lceil\frac{n}{2}\rceil$
\end_inset

, which is sharp: Let the first element be red, the second blue, third red,
 etc.
 The lower bound on the number of solution sets is 
\begin_inset Formula $1$
\end_inset

, which happens whenever the points are perfectly separated by a line (all
 red points to the left, all blue points to the right).
 This arrangement appears when the variance of 
\begin_inset Formula $\epsilon_{i}$
\end_inset

 is too small to push elements over to the wrong side.
 
\end_layout

\begin_layout Subsubsection
Selecting a solution
\end_layout

\begin_layout Standard
It has been shown that the solution sets are unions of convex polytopes.
 Clearly, we need a reasonable procedure to select a single solution from
 these.
 One possibility is to select the 
\emph on
centroid 
\emph default
of the polytope with the smallest area.
 This is not possible when all the solution polytopes are unbounded, however.
 Another option is to select the vertex with smallest Euclidean norm, which
 is what we will do.
 
\end_layout

\begin_layout Standard
Another option is to use the 
\emph on
optimal separating hyperplanes 
\emph default
from support vector machines 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 132"
key "hastie2005elements"

\end_inset

.
\end_layout

\begin_layout Subsection
Location depth
\end_layout

\begin_layout Standard
Given unidimensional data 
\begin_inset Formula $x_{1},\ldots,x_{n},$
\end_inset

 we define the 
\begin_inset Formula $n$
\end_inset

-th order statistic as the 
\begin_inset Formula $n$
\end_inset

-th element in the sorted list 
\begin_inset Formula $(x_{i_{1}},x_{i_{2}},\ldots,x_{i_{n}})$
\end_inset

.
 The rank 
\begin_inset Formula $R(x_{j})$
\end_inset

 of a point 
\begin_inset Formula $x_{j}$
\end_inset

 is its index in the preceding list.
 In 
\begin_inset CommandInset citation
LatexCommand citeyear
key "tukey1975mathematics"

\end_inset

, Tukey considered a slight modification of this concept.
 He defined what is now called the location depth, in one dimension, as
 the minimum of 
\begin_inset Formula $R(x_{j})$
\end_inset

 and 
\begin_inset Formula $n-R(x_{j})+1$
\end_inset

.
 Hence values far to the left and far to the right have small location depths,
 while those in the middle --- deep in the data --- have large location
 depths.
 Furthermore, it is clear that the median has depth 
\begin_inset Formula $\approx\frac{n}{2}$
\end_inset

, the quartiles have depth 
\begin_inset Formula $\approx\frac{n}{4}$
\end_inset

, etc.
\end_layout

\begin_layout Standard
Going further, this concept was generalised to dimensions bigger than one.
 Here the concept of ranks usually doesn't make sense, as the available
 orders, like the lexicographic ordering, don't correspond to anything of
 interest.
 
\end_layout

\begin_layout Definition
Let 
\begin_inset Formula $A=\{x_{1},\ldots,x_{n}\}\subset\mathbb{R}^{d}$
\end_inset

 for some 
\begin_inset Formula $d>0$
\end_inset

, and let 
\begin_inset Formula $y\in\mathbb{R}^{d}$
\end_inset

.
 The 
\emph on
location depth of 
\begin_inset Formula $y$
\end_inset

 relative to 
\begin_inset Formula $A$
\end_inset


\emph default
 is the minimal 
\begin_inset Formula $k\in\mathbb{N}$
\end_inset

 such that there exists closed half-plane 
\begin_inset Formula $H_{p}$
\end_inset

, with 
\begin_inset Formula $y$
\end_inset

 at its boundary, satisfying 
\begin_inset Formula $H_{p}\cap A=k$
\end_inset

.
\end_layout

\begin_layout Standard
it is easy to see that this is a generalisation of the unidimensional depth
 described in the first paragraph.
 An equivalent definition of the location depth, used in e.g.
 
\begin_inset CommandInset citation
LatexCommand citet
key "donoho1992breakdown"

\end_inset

, is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D(y;A)=\min_{||u||=1}\#\{u^{T}x_{i}\geq u^{T}y\}.
\]

\end_inset

Here 
\begin_inset Formula $u^{T}x$
\end_inset

 is the projection on the direction 
\begin_inset Formula $u$
\end_inset

.
 These definitions are equivalent, as 
\begin_inset Formula $\{x\mid u^{T}x\geq u^{T}y\}$
\end_inset

 defines a half-plane with 
\begin_inset Formula $y$
\end_inset

 on the boundary.
 While Tukey was motivated by picturing bidimensional data through drawing
 of location depth contour lines, Donoho and Gasko (ibid.) were interested
 in the robustness properties of the 
\emph on
Tukey median
\emph default
.
 It is defined as the point in 
\begin_inset Formula $A$
\end_inset

 which has the highest depth, hence it is a natural generalisation of the
 median to higher dimensions.
 They showed that its breakdown point is bounded below by 
\begin_inset Formula $\frac{1}{1+d}$
\end_inset

, where 
\begin_inset Formula $d$
\end_inset

 is the dimension of the underlying space.
 The concept of location depth has other applications as well, such as in
 the construction of bootstrap regions 
\begin_inset CommandInset citation
LatexCommand citep
key "yeh1997balanced"

\end_inset

.
 It can be used to generalise the empirical cumulative distribution function,
 and also in to generalise 
\begin_inset Formula $L$
\end_inset

-statistics: For instance, the analogue of the 
\emph on
midhinge 
\emph default
(mean of the quartiles) is the mean of all points with depth 
\begin_inset Formula $\frac{n}{4}$
\end_inset

; the 
\begin_inset Formula $\alpha$
\end_inset

-trimmed mean is the mean of all points with the 
\begin_inset Formula $(1-\alpha)\%$
\end_inset

 largest depths.
 
\end_layout

\begin_layout Standard
Now we show that computing the location depth can be reduced to MAX-FLS.
 Let 
\begin_inset Formula $x_{i}\in A\subset\mathbb{R}^{d}$
\end_inset

 be data points and consider finding 
\begin_inset Formula $D(x_{j};A)$
\end_inset

, where 
\begin_inset Formula $x_{j}\in A$
\end_inset

.
 Take note of that 
\begin_inset Formula $\min_{||u||=1}\#\{u^{T}x_{i}\geq u^{T}y\}=\max_{||u||=1}\#\{u^{T}(x_{i}-y)<0\}$
\end_inset

.
 For any sequence of 
\begin_inset Formula $i=i_{1},...,i_{k}$
\end_inset

, 
\begin_inset Formula $u^{T}(x_{i}-y)<0$
\end_inset

 for every such 
\begin_inset Formula $i$
\end_inset

 if and only if the linear inequality system 
\begin_inset Formula $Zu<\mathbf{0}$
\end_inset

 is feasible, where 
\begin_inset Formula $Z_{ij}=x_{ij}-y_{j}$
\end_inset

 and 
\begin_inset Formula $\mathbf{0}$
\end_inset

 is a 
\begin_inset Formula $k$
\end_inset

-ary vector of zeros.
 Hence it is an instance of MAX-FLS with strict inequalities.
 One difference between this problem and Manski's estimator is the focus:
 In the Manski setting, we are interested primarily in the solution set
 
\begin_inset Formula $\{u\mid\#\{u^{T}x_{i}<u^{T}y\}=\max_{||u||=1}\#\{u^{T}x_{i}<u^{T}y\}\}$
\end_inset

, while this is not of interest in the location depth setting.
 This has some consequences when it comes to algorithms.
 Since we are interested in knowing about qualitatively different solutions
 
\begin_inset Formula $u$
\end_inset

 for Manski's estimator, but not for the location depth, we need not be
 as considerate in finding every possible solution in the latter case.
 This will potentially save time and space.
 Still, this could be part of an explanation why statistics and methods
 based on the location depth aren't more popular, as the NP-completeness
 of the underlying problem guarantees that everything runs slowly.
 
\end_layout

\begin_layout Subsection
Deepest regression
\begin_inset CommandInset label
LatexCommand label
name "sub:Deepest regression"

\end_inset


\end_layout

\begin_layout Standard
In this section we discuss the deepest regression estimator of 
\begin_inset CommandInset citation
LatexCommand citet
key "rousseeuw1999regression"

\end_inset

, which is strongly related to the location depth.
 This particular estimator deserves to be included here, as it is very similar
 to Manski's estimator in several regards.
 In covariate dimension one, it has similar geometry and interpretation
 as Manski's estimator, and part of the algorithm for its computation, discussed
 in Section 4.4, is almost exactly the same.
 Furthermore, it works under similar conditions, most importantly 
\begin_inset Formula $\textrm{med}(\epsilon\mid x)=0$
\end_inset

 with arbitrary heteroskedasticity.
 Luckily, this estimator is 
\begin_inset Formula $\sqrt{n}$
\end_inset

-consistent.
 
\end_layout

\begin_layout Standard
Let the data generating mechanism be 
\begin_inset Formula $Y=\beta^{T}X+\epsilon$
\end_inset

, where 
\begin_inset Formula $\textrm{med}(\epsilon\mid x)=0$
\end_inset

, and let 
\begin_inset Formula $(y_{i},x_{i})\in A$
\end_inset

 be the data.
 For a regression line 
\begin_inset Formula $\alpha$
\end_inset

, define the 
\begin_inset Formula $i$
\end_inset

th residual as 
\begin_inset Formula $r_{i}=y_{i}-(\alpha^{T}x_{i})$
\end_inset

.
 Now we define
\emph on
 unfitness.
 
\emph default
A regression line 
\begin_inset Formula $\beta$
\end_inset

 is 
\emph on
unfit
\emph default
 to the data whenever there is a 
\begin_inset Formula $z$
\end_inset

 such that every residual has the same sign on each side of 
\begin_inset Formula $z$
\end_inset

: 
\begin_inset Formula $r_{i}<0$
\end_inset

 when 
\begin_inset Formula $\alpha^{T}x_{i}<z$
\end_inset

 and 
\begin_inset Formula $r_{i}>0$
\end_inset

 when 
\begin_inset Formula $\alpha^{T}x_{i}>z$
\end_inset

, or, 
\begin_inset Formula $r_{i}>0$
\end_inset

 when 
\begin_inset Formula $\alpha^{T}x_{i}<z$
\end_inset

 and 
\begin_inset Formula $r_{i}<0$
\end_inset

 when 
\begin_inset Formula $\alpha^{T}x_{i}>z$
\end_inset

.
 Now define 
\begin_inset Formula $\mathrm{depth}(\alpha;A)$
\end_inset

 as the minimal amount of points to be removed in order to make 
\begin_inset Formula $\alpha$
\end_inset

 unfit.
 This is the minimum number of points one would have to cross in order to
 make the hyperplane vertical, which 
\begin_inset Quotes eld
\end_inset

liberates
\begin_inset Quotes erd
\end_inset

 the line.
 Figure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:Unfit"

\end_inset

 shows two OLS lines with quite different depths compared to 
\begin_inset Formula $|A|$
\end_inset

.
 A regression line with large depth could be considered 
\emph on
balanced
\emph default
, in the sense that it is not easy to tilt it far in any direction without
 crossing many observations.
 This concept gives rise to the method of deepest regression.
 A line 
\begin_inset Formula $\alpha$
\end_inset

 is a deepest regression estimator if it solves 
\begin_inset Formula $\arg\max_{\alpha}\mathrm{depth}(\alpha;A)$
\end_inset

.
 The resulting estimator is robust, with an asymptotic breakdown point of
 
\begin_inset Formula $\frac{1}{3}$
\end_inset

.
 Its downsides are computational difficulties, in particular for dimensions
 greater than 2, and an intractable limit distribution.
 Compared to LAD (least absolute deviations) regression, this method is
 less efficient, reaching 87% efficiency for the slope and 82% for the intercept
 whenever the data is binormally distributed, see 
\begin_inset CommandInset citation
LatexCommand citet
key "van2000robustness"

\end_inset

.
 It has to my knowledge not been made any attempt at generalizing 
\begin_inset Formula $L$
\end_inset

-statistics with respect to this depth.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Manski/RegressionDepthLow.pdf
	scale 50

\end_inset


\begin_inset Graphics
	filename OppgaveR/Manski/RegressionDepthHigh.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Unfit"

\end_inset

Examples of regression lines obtained by OLS regression with low and high
 depth, respectively.
 On the plot to the left, we would only have to remove five out of fifty
 points in order to 
\begin_inset Quotes eld
\end_inset

liberate
\begin_inset Quotes erd
\end_inset

 the regression line and make it unfit to the data.
 On the other hand, the line on right is almost perfectly fit: There are
 seven points both below and above that are well inter spaced, and there
 is no way to liberate the line without removing at least five (of fourteen)
 of them.
 Notice that, if the line had been placed above the left-most green point,
 and below the rightmost blue point, we would have had to remove seven points
 instead.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Asymptotics
\begin_inset CommandInset label
LatexCommand label
name "sec:Manski Asymptotics"

\end_inset


\end_layout

\begin_layout Subsubsection
Consistency
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citeyear
key "manski1985semiparametric"

\end_inset

, Manski proved the strong consistency of his estimator under three assumptions.
 Since Manski's estimator isn't uniquely defined, it requires a more general
 form of strong consistency than usual.
 Let 
\begin_inset Formula $\widehat{B_{n}}$
\end_inset

 be the solution set.
 By strong consistency we mean the following,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
P(\lim_{n\to\infty}\sup_{\widehat{\beta}_{n}\in\widehat{B}_{n}}||\widehat{\beta}_{n}-\beta||=0)=1,
\]

\end_inset

where the supremum is needed since 
\begin_inset Formula $\widehat{B}_{n}$
\end_inset

 is a set.
 Manski's (ibid.) assumptions are:
\end_layout

\begin_layout Enumerate
The support of 
\begin_inset Formula $F_{x}$
\end_inset

 is not contained in any proper subspace of 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Both 
\begin_inset Formula $Y=1$
\end_inset

 and 
\begin_inset Formula $Y=0$
\end_inset

 is possible for any 
\begin_inset Formula $X$
\end_inset

: 
\begin_inset Formula $0<P(Y>0\mid X)<1$
\end_inset

 with probability 
\begin_inset Formula $1$
\end_inset

.
\end_layout

\begin_layout Enumerate
There is a 
\begin_inset Formula $k\in\{1,...,d\}$
\end_inset

 with 
\begin_inset Formula $\beta_{k}\neq0$
\end_inset

 such that for almost any value of 
\begin_inset Formula $(x_{1},x_{2},...,x_{k-1},x_{k+1},...,x_{d})$
\end_inset

, the distribution of 
\begin_inset Formula $X_{k}$
\end_inset

 conditioned on 
\begin_inset Formula $x_{-k}$
\end_inset

 has a positive density on 
\begin_inset Formula $\mathbb{R}$
\end_inset

.
\end_layout

\begin_layout Standard
In Section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Manski illustrations"

\end_inset

 it will be made clear that some form of assumption 3) is required.
 Assumption 1) is a full rank condition, necessary for identification.
 Assumption 2) is probably not required, and we will perform simulations
 where 2) is false in Section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Manski illustrations"

\end_inset

.
 
\end_layout

\begin_layout Subsubsection
The limit distribution
\end_layout

\begin_layout Standard
The following limit distribution is of no practical interest.
 It is very time consuming to calculate it, and it is analytically intractable.
 The exception is with one covariate in the 
\begin_inset Formula $\beta_{0}=1$
\end_inset

 setting, where we yet again get a rescaled Chernoff's distribution.
 
\end_layout

\begin_layout Standard
It was 
\begin_inset CommandInset citation
LatexCommand cite
key "kim1990cube"

\end_inset

 who were the first to find the limit distribution of Manski's estimator.
 They found the distribution under the 
\begin_inset Quotes eld
\end_inset

spherical
\begin_inset Quotes erd
\end_inset

 identifiability condition 
\begin_inset Formula $||\beta||=1$
\end_inset

.
 Instead, we will supply the limiting distribution when 
\begin_inset Formula $\beta_{0}=1$
\end_inset

, ignoring the 10 conditions for it to work.
 This theorem is taken from 
\begin_inset CommandInset citation
LatexCommand citet
after "theorem 4"
key "abrevaya2005bootstrap"

\end_inset

.
\end_layout

\begin_layout Theorem
Let assumptions MS1-MS10 (in Abrevaya et al.) hold.
 Then 
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
n^{\frac{1}{3}}(\beta_{n}-\beta_{0})\stackrel{d}{\to}\argmax_{h}\left[\frac{1}{2}h^{T}Vh+W(h)\right],
\]

\end_inset

where 
\begin_inset Formula $W$
\end_inset

 is a mean zero Gaussian process with covariance kernel
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
H(u,v)=E[\min(|X^{T}u|,|X^{T}v|)1_{[\textrm{sign}X^{T}u=\textrm{sign}X^{T}u]}g(-X^{T}\beta|X)],
\]

\end_inset

where 
\begin_inset Formula $g$
\end_inset

 is the density of 
\begin_inset Formula $X$
\end_inset

.
\end_layout

\begin_layout Section
Algorithms and complexity
\begin_inset CommandInset label
LatexCommand label
name "sec:Algorithms-and-complexity"

\end_inset


\end_layout

\begin_layout Standard
Following 
\begin_inset CommandInset citation
LatexCommand cite
key "florios2008exact"

\end_inset

, we wish to find exact solutions to maximisation problems of the form
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\argmax_{\beta\in B}\sum_{i=1}^{n}w_{i}(Y_{i}-\frac{1}{2})1_{[X_{i}^{T}\beta\geq0]},\label{eq:Weighted argmax objective}
\end{equation}

\end_inset

where 
\begin_inset Formula $w_{i}$
\end_inset

 are positive weights.
 It has already been said that this problem isn't identified --- if 
\begin_inset Formula $a>0$
\end_inset

 and 
\begin_inset Formula $\widehat{\beta}$
\end_inset

 is a solution, 
\begin_inset Formula $a\widehat{\beta}$
\end_inset

 is also a solution.
 In order to fix the scales, two approaches are used: 1.) If the intercept
 is believed to be positive, put 
\begin_inset Formula $\beta_{0}=1$
\end_inset

.
 Likewise, if the intercept is believed to be negative, put 
\begin_inset Formula $\beta_{0}=-1$
\end_inset

.
 On the other hand, if we believe than 
\begin_inset Formula $\beta_{0}=0$
\end_inset

, the scale will not be fixed, and we will have to use a method like the
 next.
 2.) Add the constraint 
\begin_inset Formula $||\beta||=1$
\end_inset

, where 
\begin_inset Formula $||\cdot||$
\end_inset

 is the Euclidean norm in 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

.
 Clearly, these approaches are not equivalent.
 For the constraint 
\begin_inset Formula $||\beta||=1$
\end_inset

 allows for more solutions that 
\begin_inset Formula $\beta_{0}=1$
\end_inset

 does, while a solution set with the 
\begin_inset Formula $||\beta||=1$
\end_inset

 constraint (where 
\begin_inset Formula $\beta_{0}>0$
\end_inset

) easily can be transformed into a solution set for the 
\begin_inset Formula $\beta_{0}=1$
\end_inset

 condition by dividing the solution by 
\begin_inset Formula $\beta_{0}$
\end_inset

.
 Also, if we solve the 
\begin_inset Formula $\argmax$
\end_inset

 for 
\begin_inset Formula $\beta_{0}=0,1,-1$
\end_inset

, we can combine the solution sets separately into a solution set consistent
 with 
\begin_inset Formula $||\beta||=1$
\end_inset

.
\end_layout

\begin_layout Subsection
Computational complexity
\end_layout

\begin_layout Standard
The computational complexity of Manski's estimator has not been considered
 in the statistical literature before, but it is known when formulated as
 MAX-FLS.
 The general problem is 
\emph on
NP
\emph default
-complete, which is quite easy to prove.
 
\end_layout

\begin_layout Definition
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Complexity classes
\end_layout

\end_inset

A decision problem is a function with boolean output.
 
\emph on
P
\emph default
 is the class of all decision problems computable in polynomial time.
 
\emph on
NP
\emph default
 is the class of all decision problems that are polynomially verifiable.
 That is, given a solution certificate which is polynomial in the size of
 the input, it takes polynomial time to verify it.
 A polynomial time reduction between decision problems 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is a polynomial time program 
\begin_inset Formula $p$
\end_inset

 which translates an instance of 
\begin_inset Formula $A$
\end_inset

 into an instance of 
\begin_inset Formula $B$
\end_inset

.
 A problem 
\begin_inset Formula $A$
\end_inset

 is NP-hard if any 
\begin_inset Formula $B\in NP$
\end_inset

 can be polynomial time reduced to 
\begin_inset Formula $A$
\end_inset

.
 A problem is NP-complete if it is in NP and is NP-hard.
\end_layout

\begin_layout Standard
These definitions are not completely spelled out.
 For more information about computational complexity theory, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "papadimitriou2003computational"

\end_inset

.
 The main point of discussing NP-completeness is roughly that NP-complete
 problems can't be solved fast unless 
\begin_inset Formula $P=NP$
\end_inset

.
 It is generally assumed that 
\begin_inset Formula $P\neq NP$
\end_inset

, but proving it is considered among the greatest unsolved problems of mathemati
cs.
 As can be seen from the definition, the theory doesn't apply to optimisation
 problems, but only to decision problems.
 When given an maximisation problem with objective function 
\begin_inset Formula $M$
\end_inset

, its decision problem variant is 
\begin_inset Quotes eld
\end_inset

is there an 
\begin_inset Formula $x$
\end_inset

 such that 
\begin_inset Formula $M(x)\geq y$
\end_inset

?
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
Now we will prove that the decision problem variant of MAX-FLS is 
\emph on
NP
\emph default
-complete.
 This has been proved in 
\begin_inset CommandInset citation
LatexCommand cite
key "amaldi1995complexity"

\end_inset

 by reducing the NP-complete problem EXACT 3-COVER.
 We use a different approach, namely a reduction of MAX-2-SAT to MAX-FLS.
 We need some definitions.
 Let 
\begin_inset Formula $\phi$
\end_inset

 be a propositional formula with variables 
\begin_inset Formula $x_{1},...,x_{m}$
\end_inset

.
 We say that 
\begin_inset Formula $\phi$
\end_inset

 is in 
\emph on
conjunctive normal form (CFN)
\emph default
, if it has the form 
\begin_inset Formula $\phi_{1}\wedge\phi_{2}\wedge\ldots\wedge\phi_{n}$
\end_inset

 for some 
\emph on
clauses
\emph default
 
\begin_inset Formula $\phi_{i}=a_{i1}\vee a_{i2}\vee...\vee a_{im}$
\end_inset

, where 
\begin_inset Formula $a_{ij}$
\end_inset

 are 
\emph on
literals
\emph default
.
 A propositional formula 
\begin_inset Formula $a$
\end_inset

 is a literal if it has the form 
\begin_inset Formula $a=\neg x$
\end_inset

 or 
\begin_inset Formula $a=x$
\end_inset

 for a variable 
\begin_inset Formula $x$
\end_inset

.
 It is known that every propositional formula can be written in conjunctive
 normal form 
\begin_inset CommandInset citation
LatexCommand cite
after "p. 22"
key "mendelson2009introduction"

\end_inset

.
 We say that a propositional formula is 
\emph on
satisfiable
\emph default
 if there exists an assignment of the variables 
\begin_inset Formula $x_{1},\ldots,x_{k}$
\end_inset

 that makes it true, e.g.
 
\begin_inset Formula $(x_{1}\vee\neg x_{2})\wedge(\neg x_{1}\vee x_{2})$
\end_inset

 is satisfiable: It is true when both 
\begin_inset Formula $x_{1}$
\end_inset

and 
\begin_inset Formula $x_{2}$
\end_inset

 are true.
 An unsatisfiable formula is a contradiction --- it is always false.
 A formula 
\begin_inset Formula $\phi$
\end_inset

 is in 
\emph on
2-CNF 
\emph default
if every clause contains at most two literals.
\end_layout

\begin_layout Definition
(MAX 2-SAT).
 Let 
\begin_inset Formula $\phi$
\end_inset

 be a formula in 2-conjunctive normal form (2-CNF).
 MAX 2-SAT is the problem of determining the maximal number of clauses which
 can be simultaneously satisfied.
 The corresponding decision problem is: Given a 
\begin_inset Formula $k\in\mathbb{N}$
\end_inset

, is there a collection of 
\begin_inset Formula $k$
\end_inset

 clauses that are simultaneously satisfiable?
\end_layout

\begin_layout Standard
It is known that MAX 2-SAT(k) is 
\begin_inset Formula $NP$
\end_inset

-complete 
\begin_inset CommandInset citation
LatexCommand cite
key "garey1976some"

\end_inset

.
 This can be proved through a reduction of 3-SAT, the problem of establishing
 whether a 3-CNF formula is satisfiable, which i
\emph on
s 
\emph default
one of the
\emph on
 
\emph default
core 
\begin_inset Formula $NP$
\end_inset

-complete problems 
\begin_inset CommandInset citation
LatexCommand cite
after "chap. 9"
key "papadimitriou2003computational"

\end_inset

.
\end_layout

\begin_layout Proposition
The decision problem MAX-FLS is NP-complete.
\end_layout

\begin_layout Proof
We show that MAX 2-SAT can be polynomial-time reduced to MAX-FLS.
 Let 
\begin_inset Formula $m$
\end_inset

 be the number of variables in 
\begin_inset Formula $\phi$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 be its number of clauses.
 Also, define 
\begin_inset Formula $a_{ij}$
\end_inset

 as the 
\begin_inset Quotes eld
\end_inset

sign
\begin_inset Quotes erd
\end_inset

 of the 
\begin_inset Formula $j$
\end_inset

-th variable in the 
\begin_inset Formula $i$
\end_inset

-th clause: For example, if the 
\begin_inset Formula $i$
\end_inset

-th clause is 
\begin_inset Formula $(x_{5}\wedge\neg x_{9})$
\end_inset

, then 
\begin_inset Formula $a_{i5}=1$
\end_inset

, 
\begin_inset Formula $a_{i9}=-1$
\end_inset

 and 
\begin_inset Formula $a_{ij}=0$
\end_inset

 for all 
\begin_inset Formula $j\neq5,9$
\end_inset

.
 Let 
\begin_inset Formula $A$
\end_inset

 be the matrix with 
\begin_inset Formula $a_{ij}$
\end_inset

 as its 
\begin_inset Formula $(i,j)$
\end_inset

-th element and let 
\begin_inset Formula $x$
\end_inset

 be an 
\begin_inset Formula $m$
\end_inset

-dimensional vector having only 
\begin_inset Formula $0$
\end_inset

 and 
\begin_inset Formula $1$
\end_inset

 as elements.
 Then there are 
\begin_inset Formula $k$
\end_inset

 satisfiable clauses if and only if there is a subsystem 
\begin_inset Formula $A'$
\end_inset

 with 
\begin_inset Formula $k$
\end_inset

 rows such that 
\begin_inset Formula $A'x\geq\mathbf{1}$
\end_inset

, where 
\begin_inset Formula $\mathbf{1}$
\end_inset

 is the appropriately sized vector with only ones.
 Now add the constraints 
\begin_inset Formula $x_{i}=0$
\end_inset

 and 
\begin_inset Formula $x_{i}=1$
\end_inset

, each 
\begin_inset Formula $n+1$
\end_inset

 times.
 (These can be implemented as two inequalities of the form 
\begin_inset Formula $\leq$
\end_inset

 and 
\begin_inset Formula $\geq$
\end_inset

).
 Then we effectively force the 
\begin_inset Formula $x$
\end_inset

-vector to be integral by adding an additional 
\begin_inset Formula $4m(n+1)$
\end_inset

 constraints.
 The resulting system is ready to be solved by a MAX-FLS(k) solver, and
 its solution is clearly the same as for MAX-SAT(k).
 Since the input size is polynomial in the input size of MAX 2-SAT, the
 problem is 
\begin_inset Formula $NP$
\end_inset

-hard.
 MAX-FLS(k) is in NP: Given a solution, it can be verified in polynomial
 time simply by checking each inequality.
\end_layout

\begin_layout Standard
Notice that, while MAX-FLS is NP-hard, it is only so when the number of
 inequality constraints and variables are considered at the same time.
 Soon we will describe an algorithm which runs in 
\begin_inset Formula $O(n^{d}\log(n))$
\end_inset

 time, where 
\begin_inset Formula $n$
\end_inset

 is the number of constraints and 
\begin_inset Formula $d$
\end_inset

 is the number of variables.
 This translates into 
\begin_inset Formula $n$
\end_inset

 observations and covariate dimension 
\begin_inset Formula $d$
\end_inset

 in our setting, and since we think of the dimension 
\begin_inset Formula $d$
\end_inset

 as something constant (or a parameter), the algorithm could well be understood
 as polynomial in 
\begin_inset Formula $d$
\end_inset

 --- which is considered 
\begin_inset Quotes eld
\end_inset

fast
\begin_inset Quotes erd
\end_inset

 in this context.
 But outside this specific problem, the amount of variables (that is 
\begin_inset Formula $d$
\end_inset

) is not necessarily constant.
 
\end_layout

\begin_layout Standard
Due to its connection with linear programming, there has been devoted some
 resources to finding algorithms for this problem.
 Many of those are described in 
\begin_inset CommandInset citation
LatexCommand cite
after "chap. 7"
key "chinneck2007feasibility"

\end_inset

, and the most prominent is described in the next section.
\end_layout

\begin_layout Subsection
Earlier work
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "pinkse1993computation"

\end_inset

 described the first exact algorithm for Manski's estimator.
 He proposed to iteratively check the function value on every corner of
 the candidate solution polytopes.
 There are 
\begin_inset Formula $\binom{n}{d}\approx(d!)^{-1}n^{d}$
\end_inset

 possible corners to check, and it takes around 
\begin_inset Formula $O(d^{3})$
\end_inset

 time to invert a matrix.
 (This is done in order to obtain the coordinates of the corners.) In addition,
 finding the value of the objective function is 
\begin_inset Formula $O(nd)$
\end_inset

, giving an algorithm with time complexity 
\begin_inset Formula $O(n^{d+1})$
\end_inset

.
 Pinkse also discussed a variety of approximation algorithms.
 
\begin_inset CommandInset citation
LatexCommand citet
key "manski1986operational"

\end_inset

 introduced the approximate 
\begin_inset Quotes eld
\end_inset

great circle search
\begin_inset Quotes erd
\end_inset

 algorithm, but this algorithm does not perform very well, see the computational
 results of 
\begin_inset CommandInset citation
LatexCommand citet
key "florios2008exact"

\end_inset

.
 Florios and Skouras (ibid.) were the first to propose a workable exact algorithm
 for the weighted Manski's objective 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Weighted argmax objective"

\end_inset

 in the statistical literature, an algorithm based on mixed integer programming
 
\begin_inset CommandInset citation
LatexCommand citep
before "see eg"
key "conforti2014integer"

\end_inset

.
 A mixed integer program is a linear program where some of the variables
 can be constrained to be integers, and most natural combinatorial optimisation
 problems can be represented as an integer program.
 We present a slightly modified variant of their program, taken from 
\begin_inset CommandInset citation
LatexCommand citet
after "section 7.1.1"
key "chinneck2007feasibility"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\min\sum_{i=1}^{n}w_{i}z_{i} &  & \textrm{such that}\\
\\
-x_{i}\beta & \leq & 1+Mz_{i},\textrm{ when }Y_{i}=1,\\
x_{i}\beta & < & -1+Mz_{i},\textrm{ when }Y_{i}=0,\\
 &  & z_{i}\in\{0,1\},\\
 &  & \beta\in\mathbb{R}^{d}.
\end{eqnarray*}

\end_inset

The constraints run over every 
\begin_inset Formula $i=1,...,n$
\end_inset

, and 
\begin_inset Formula $M$
\end_inset

 is a large constant.
 In order to see that this is the right formulation, take a subset 
\begin_inset Formula $z_{i_{1}},z_{i_{2}},...,z_{i_{k}}$
\end_inset

 and 
\begin_inset Formula $\beta_{1},\beta_{2},...$
\end_inset

 which satisfies it.
 An equation of the form 
\begin_inset Formula $-x_{i}\beta\leq1+Mz_{i}$
\end_inset

 will have 
\begin_inset Formula $z_{i}=1$
\end_inset

 iff 
\begin_inset Formula $-x_{i}\beta\leq1$
\end_inset

 is unsatisfied; the same goes for 
\begin_inset Formula $x_{i}\beta\leq-1+Mz_{i}$
\end_inset

.
 The objective 
\begin_inset Formula $\min\sum_{i=1}^{n}w_{i}z_{i}$
\end_inset

 assures that we include the minimal weighted number of unsatisfied constraints,
 yielding a solution to the maximal problem.
 The role of 
\begin_inset Formula $M$
\end_inset

 is to loosen the constraint so much that they are always satisfied.
 This can be chosen to be 
\begin_inset Formula $Bd\max_{i,j}x_{ij}$
\end_inset

, where 
\begin_inset Formula $B$
\end_inset

 is a reasonable upper bound on the absolute value of the 
\begin_inset Formula $\beta_{i}$
\end_inset

s, while 
\begin_inset Formula $\max_{i,j}x_{ij}$
\end_inset

 is the maximal recorded covariate value in any index.
 
\end_layout

\begin_layout Standard
We implement this program 
\begin_inset Formula $\mathtt{R}$
\end_inset

 through the use of 
\begin_inset Formula $\mathtt{Rglpk}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Rglpk"

\end_inset

, an 
\series bold
R
\series default
 interface to the 
\series bold
G
\series default
NU 
\series bold
l
\series default
inear 
\series bold
p
\series default
rogramming 
\series bold
k
\series default
it.
 The computation speed is slow, which is not surprising, as mixed integer
 programming in general is NP-hard.
 Smart algorithms for solving them have been well studied: The main algorithm
 is called 
\begin_inset Quotes eld
\end_inset

Branch-and-cut
\begin_inset Quotes erd
\end_inset

, which operates by sequentially relaxing the integer program into ordinary
 linear programs, which can be solved quickly through the simplex method.
 For a thorough introduction, see 
\begin_inset CommandInset citation
LatexCommand cite
key "conforti2014integer"

\end_inset

.
 In this thesis, our attention is restricted to 
\begin_inset Formula $d=1$
\end_inset

 and 
\begin_inset Formula $d=2$
\end_inset

, and it might be that the integer programming formulation is faster than
 the complete enumeration algorithm when 
\begin_inset Formula $d$
\end_inset

 is sufficiently large.
 
\end_layout

\begin_layout Standard
An important fact is the following inapproximability result of 
\begin_inset CommandInset citation
LatexCommand citet
key "amaldi1994approximability,amaldi1995complexity"

\end_inset

, which warns us that it may be futile to search for a general purpose approxima
tion algorithm for Manski's estimator.
 Let 
\begin_inset Formula $M$
\end_inset

 be the real maximum and 
\begin_inset Formula $M'$
\end_inset

 be an approximate maximum.
 We say that a maximisation problem is 
\begin_inset Formula $d$
\end_inset

-approximable if 
\begin_inset Formula $\frac{M}{M'}\leq d$
\end_inset

 for every instance of the problem.
 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:MAX-FLS-is-2-approximable"

\end_inset

MAX-FLS is 2-approximable, but not approximable within any factor unless
 
\begin_inset Formula $P=NP$
\end_inset

.
 (That is, MAX-FLS is APX-complete with approximation factor bounded by
 2 
\begin_inset CommandInset citation
LatexCommand citep
after "chapter 8"
key "wegener2005complexity"

\end_inset

).
\end_layout

\begin_layout Standard
In the next section we describe an 
\begin_inset Formula $O(n^{d}\log n$
\end_inset

) enumeration algorithm for finding the entire solution set.
\end_layout

\begin_layout Subsection
An enumeration algorithm
\end_layout

\begin_layout Standard
The algorithms of this section were invented and analysed by me.
 After the work on them was finished, it was discovered that an algorithm
 with runtime 
\begin_inset Formula $O(n^{d}\log n$
\end_inset

) was already described in 
\begin_inset CommandInset citation
LatexCommand citet
key "johnson1977densest"

\end_inset

.
 Still, this section describes the first reasonably fast algorithm for the
 computation of Manski's algorithm in the
\emph on
 statistical
\emph default
 literature.
 First we will explore the case 
\begin_inset Formula $d=1$
\end_inset

, which corresponds to an intercept and one covariate.
 The focus is on the identification of the whole solution set, unscaled.
 This is done by identifying solutions corresponding to 
\begin_inset Formula $\beta=-1,0,1$
\end_inset

, rescale them to the unit circle, and expand them along rays.
 This effectively reduces the problem to a one-dimensional one.
 
\end_layout

\begin_layout Standard
As already mentioned, we want to find the 
\begin_inset Formula $w$
\end_inset

-maximal non-empty intersections between half-planes 
\begin_inset Formula $H_{i}$
\end_inset

.
 Such a set is always the area between two rays on the same side of 
\begin_inset Formula $x=0$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Plots/manski1dexample.pdf
	scale 50

\end_inset


\begin_inset Graphics
	filename OppgaveR/Plots/manski1dexamplepoints.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:(left)-Geometry-of"

\end_inset

(left) Geometry of the problem in covariate dimension one.
 The blue lines signify half-planes pointing downwards, while the red lines
 point upward.
 In this example, all half-planes have weights equal to one, and the unique
 solution set is the pink area, which is the intersection of nine half-planes.
 The only half-plane not included in the intersection is the red half-plane
 with the steepest slope.
 (right) Points on the line corresponding to the rays left of 
\begin_inset Formula $\beta_{0}=0$
\end_inset

.
 The purple segment is the solution set intersected with the line 
\begin_inset Formula $\beta_{0}=1$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset

Figure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:(left)-Geometry-of"

\end_inset

 illustrates the setting, and points to an important fact: When we have
 found a solution set for 
\begin_inset Formula $\beta=1$
\end_inset

, it can be expanded to the whole solution set, by simply identifying the
 lines that give rise to the solutions.
 Hence we can reduce the problem to finding 
\begin_inset Formula $w$
\end_inset

-maximal non-empty intersections of intervals, first to the left of 
\begin_inset Formula $\beta_{0}=0$
\end_inset

, then to the right of 
\begin_inset Formula $\beta_{0}=0$
\end_inset

.
 In the following we impose the constraint 
\begin_inset Formula $\beta_{0}=1$
\end_inset

.
\end_layout

\begin_layout Definition
Let 
\begin_inset Formula $(y_{i},x_{i})$
\end_inset

, 
\begin_inset Formula $i=1,...,n$
\end_inset

 be observations from a binary response model with 
\begin_inset Formula $d=1$
\end_inset

.
 The colour of a point 
\begin_inset Formula $-\frac{1}{x_{i}}$
\end_inset

 is defined by
\end_layout

\begin_layout Definition
\begin_inset Formula 
\[
\mbox{col}(-\frac{1}{x_{i}})=\begin{cases}
\mathrm{red} & \textrm{when }(x_{i}>0\mbox{ and }y_{i}=1)\textrm{ or }(x_{i}<0\mbox{ and }y_{i}=0),\\
\mathrm{blue} & \textrm{when }(x_{i}<0\mbox{ and }y_{i}=1)\textrm{ or }(x_{i}>0\mbox{ and }y_{i}=0).
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
We make use of the function 
\begin_inset Formula $\mbox{col}$
\end_inset

 any more, but simple call points red or blue depending on which of the
 two conditions is satisfied.
 As for the motivation for this colouring, recall the algebraic characterisation
 of Manski's objective in Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:AlgebraCharacterisation"

\end_inset

.
 When formulated for 
\begin_inset Formula $d=1,$
\end_inset

 we get
\begin_inset Formula 
\begin{eqnarray}
-\beta_{1}x_{i}\leq1 & \textrm{when} & Y_{i}=1,\label{eq:One d inequalites}\\
\beta_{1}x_{i}<-1 & \textrm{when} & Y_{i}=0.\nonumber 
\end{eqnarray}

\end_inset

If 
\begin_inset Formula $x_{i}>0$
\end_inset

, the these inequalities are equivalent to 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\beta_{1}\geq-\frac{1}{x_{i}} & \textrm{when} & Y_{i}=1,\\
\beta_{1}<-\frac{1}{x_{i}} & \textrm{when} & Y_{i}=0,
\end{eqnarray*}

\end_inset

while 
\begin_inset Formula $x_{i}<0$
\end_inset

 gives 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\beta_{1}\leq-\frac{1}{x_{i}} & \textrm{when} & Y_{i}=1,\\
\beta_{1}>-\frac{1}{x_{i}} & \textrm{when} & Y_{i}=0.
\end{eqnarray*}

\end_inset

Accordingly a point is 
\begin_inset Formula $-\frac{1}{x_{i}}$
\end_inset

 is blue when its corresponding equation is satisfied for every 
\begin_inset Formula $\beta_{1}<-\frac{1}{x_{i}}$
\end_inset

, and similarly for red points.
 In the following proposition, we denote Manski's objective 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Manski's objective"

\end_inset

 
\begin_inset Formula 
\[
m(z)=\sum_{i=1}^{n}(Y_{i}-\frac{1}{2})1_{1+zx_{i}\geq0}.
\]

\end_inset


\end_layout

\begin_layout Proposition
Denote 
\begin_inset Formula $z_{i}=-\frac{1}{x_{i}}$
\end_inset

, let 
\begin_inset Formula $z\in\mathbb{R}$
\end_inset

 and define 
\begin_inset Formula 
\begin{eqnarray*}
r_{l}(z) & = & \textrm{number of red points to the left of }z,\\
b_{r}(z) & = & \textrm{number of blue points to the right of }z,
\end{eqnarray*}

\end_inset

both quantities being inclusive.
 Then 
\begin_inset Formula $m(z)$
\end_inset

 equals 
\begin_inset Formula $r_{l}(z)+b_{r}(z)$
\end_inset

.
\end_layout

\begin_layout Proof
The objective function 
\begin_inset Formula $m(z)$
\end_inset

 counts the number of satisfied inequalities in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:One d inequalites"

\end_inset

.
 By the reasoning above, the inequality belonging to a blue point 
\begin_inset Formula $z_{i}$
\end_inset

 is satisfied by 
\begin_inset Formula $z$
\end_inset

 iff 
\begin_inset Formula $z_{i}$
\end_inset

 is to the right of 
\begin_inset Formula $z$
\end_inset

.
 Similarly, an inequality belonging to a red point 
\begin_inset Formula $z_{j}$
\end_inset

 is satisfied iff 
\begin_inset Formula $z_{j}$
\end_inset

 is to the left 
\begin_inset Formula $z$
\end_inset

.
 The result follows.
\end_layout

\begin_layout Standard
We can use this proposition to identify the solution sets.
 Recall from the geometric characterisation (Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:Geometry characterization"

\end_inset

) that the solution sets are maximal disjoint convex polytopes, which in
 
\begin_inset Formula $\mathbb{R}$
\end_inset

 means disjoint intervals.
 If 
\begin_inset Formula $[z_{i},z_{j}]$
\end_inset

 is a maximal bounded solution interval, 
\begin_inset Formula $z_{i}$
\end_inset

 must be red and 
\begin_inset Formula $z_{j}$
\end_inset

 blue.
 For if 
\begin_inset Formula $z_{i}$
\end_inset

 is blue, either there is red point 
\begin_inset Formula $z_{l}$
\end_inset

 to its left with 
\begin_inset Formula $m(z_{l})=m(z_{i})$
\end_inset

, or there is no point at all, which implies 
\begin_inset Formula $m(z)=m(z_{i})$
\end_inset

 for every 
\begin_inset Formula $z<z_{i}$
\end_inset

.
 This contradicts the maximality of 
\begin_inset Formula $[z_{i},z_{j}]$
\end_inset

.
 
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:1d solution characterization"

\end_inset

Assume the list 
\begin_inset Formula $z_{i}=-\frac{1}{x_{i}}$
\end_inset

 is sorted, and also add two non-coloured points 
\begin_inset Formula $z_{0}=-\infty$
\end_inset

 and 
\begin_inset Formula $z_{n+1}=\infty$
\end_inset

.
 A solution interval is of the form 
\begin_inset Formula $[z_{i},z_{i+1}]$
\end_inset

, where 
\begin_inset Formula $z_{i}$
\end_inset

 is either red or 
\begin_inset Formula $-\infty$
\end_inset

 and 
\begin_inset Formula $z_{i+1}$
\end_inset

 is either blue or 
\begin_inset Formula $\infty$
\end_inset

.
\end_layout

\begin_layout Proof
it is impossible to have three adjacent 
\begin_inset Formula $z_{i},z_{i+1},z_{i+2}$
\end_inset

 with 
\begin_inset Formula $m(z_{i})=m(z_{i+1})=m(z_{i+2})$
\end_inset

: For if 
\begin_inset Formula $z_{i+1}$
\end_inset

 is blue, 
\begin_inset Formula $m(z_{i})>m(z_{i+2})$
\end_inset

, and if 
\begin_inset Formula $z_{i+1}$
\end_inset

 is red, 
\begin_inset Formula $m(z_{i})<m(z_{i+2})$
\end_inset

.
 
\end_layout

\begin_layout Standard
What happens if 
\begin_inset Formula $\beta_{0}=-1$
\end_inset

 instead? Then all the points swap colours and signs, and the same argument
 applies.
 Now we're ready to describe an algorithm for computing the estimator.
 Essentially we sort the elements 
\begin_inset Formula $z_{i}=-\frac{1}{x_{i}}$
\end_inset

, find their colour, and sequentially calculate 
\begin_inset Formula $r_{l}(z_{i})+b_{r}(z_{i})$
\end_inset

, starting from the left.
 Using this algorithm, we only have to visit each point twice, because 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
r_{l}(z_{i+1}) & = & r_{l}(z_{i})+1_{col(z_{i+1})=\textrm{red}},\\
b_{r}(z_{i+1}) & = & b_{r}(z_{i})-1_{col(z_{i})=\textrm{blue}},
\end{eqnarray*}

\end_inset

and both 
\begin_inset Formula $r_{l}(z_{1})$
\end_inset

 and 
\begin_inset Formula $b_{l}(z_{1})$
\end_inset

 can be calculated in by visiting every point one time.
 The output is the list of values 
\begin_inset Formula $r_{l}(z_{i})$
\end_inset

 and 
\begin_inset Formula $b_{l}(z_{i})$
\end_inset

 for every 
\begin_inset Formula $z_{i}$
\end_inset

, and the solution sets can then be identified by Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:1d solution characterization"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithm}
\end_layout

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\begin_layout Plain Layout


\backslash
Require a list of colored $z_{i}$s
\end_layout

\begin_layout Plain Layout


\backslash
Ensure $r_{l}(z_{i})$ and $b_{r}(z_{i})$ for each $z_{i}$s
\end_layout

\begin_layout Plain Layout


\backslash
Procedure{RedBlue}{$points$}
\end_layout

\begin_layout Plain Layout

	
\backslash
State sort the points by value
\end_layout

\begin_layout Plain Layout

	
\backslash
State Calculate $r_{l}(z_{1})$ 
\end_layout

\begin_layout Plain Layout

	
\backslash
For{$i = 1 ; i 
\backslash
leq n; i++$}
\end_layout

\begin_layout Plain Layout

		
\backslash
State $r_{l}(z_{i+1}) = r_{l}(z_{i})+1_{col(z_{i+1})=
\backslash
textrm{red}}$
\end_layout

\begin_layout Plain Layout

        
\backslash
State $b_{r}(z_{i+1}) = b_{r}(z_{i})-1_{col(z_{i})=
\backslash
textrm{blue}}$
\end_layout

\begin_layout Plain Layout

	
\backslash
EndFor
\end_layout

\begin_layout Plain Layout


\backslash
EndProcedure
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\begin_layout Plain Layout


\backslash
protect
\backslash
caption{RedBlue}
\end_layout

\begin_layout Plain Layout


\backslash
end{algorithm}
\end_layout

\end_inset


\end_layout

\begin_layout Proposition
The procedure RedBlue in Algorithm 1 is correct.
 Its asymptotic runtime is 
\begin_inset Formula $\Theta(n\log n$
\end_inset

).
\begin_inset Foot
status open

\begin_layout Plain Layout
This means that the algorithm is both 
\begin_inset Formula $O(n\log n)$
\end_inset

 and 
\begin_inset Formula $\Omega(n\log n$
\end_inset

).
 That is, it is asymptotically bounded both above and below by 
\begin_inset Formula $n\log n$
\end_inset

.
\end_layout

\end_inset

.
\end_layout

\begin_layout Proof
As the algorithm is correct by the preceding discussion, we will calculate
 the runtime.
 As for the runtime, it is well known that sorting is 
\begin_inset Formula $O(n\log n)$
\end_inset

 .
 The amount of arithmetic operations done is 
\begin_inset Formula $O(n)$
\end_inset

 for the first element and 
\begin_inset Formula $4$
\end_inset

 for each of the other elements.
 Therefore the algorithm is 
\begin_inset Formula $O(n\log n)+O(n)=O(n\log n$
\end_inset

).
 As for the lower bound, it is also known that comparison-based sort has
 the asymptotic lower bound 
\begin_inset Formula $\Omega(n\log n)$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 58"
key "dasgupta2006algorithms"

\end_inset

.
 Knowing the solution to this problem one can clearly find the sorted list
 in 
\begin_inset Formula $O(n\log n)$
\end_inset

 operations, by sorting on the 
\begin_inset Formula $r_{l}(z_{i})$
\end_inset

, and then the 
\begin_inset Formula $b_{r}(z_{i})$
\end_inset

.
 From this we arrive at the lower bound.
\end_layout

\begin_layout Standard
Clearly, the algorithm can easily be extended to work for the weighted 
\begin_inset Formula $m$
\end_inset

 as well.
 If we maximise for both 
\begin_inset Formula $\beta_{0}=1$
\end_inset

 and 
\begin_inset Formula $\beta_{0}=-1$
\end_inset

 simultaneously, this algorithm is the same as the algorithm 
\begin_inset Formula $rdepth$
\end_inset

 for the calculation of the regression depth in 
\begin_inset CommandInset citation
LatexCommand citet
key "rousseeuw1999regression"

\end_inset

, except they are minimising instead of maximising.
 To maximise for 
\begin_inset Formula $\beta_{0}=-1$
\end_inset

, we'd substitute 
\begin_inset Formula $r_{l}(z)$
\end_inset

 for 
\begin_inset Formula $r_{r}(z)$
\end_inset

 and 
\begin_inset Formula $b_{r}(z)$
\end_inset

 for 
\begin_inset Formula $b_{l}(z)$
\end_inset

, where 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $r_{r}$
\end_inset

 and 
\begin_inset Formula $b_{l}$
\end_inset

 have the obvious meanings.

\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 Note that if the elements are pre-sorted, this is an 
\begin_inset Formula $O(n)$
\end_inset

-algorithm.
 
\end_layout

\begin_layout Standard
This algorithm has been implemented in 
\begin_inset Formula $\mathtt{C++}$
\end_inset

, with a link to 
\begin_inset Formula $\mathtt{R}$
\end_inset

 through 
\begin_inset Formula $\mathtt{Rcpp}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Rcpp"

\end_inset

 and runs very fast, comparable to 
\begin_inset Formula $\mathtt{sort}$
\end_inset

 in 
\begin_inset Formula $\mathtt{R}$
\end_inset

.
 A comparison is provided in Figure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:RedBlue speed"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Manski/Manski1DSpeed.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RedBlue speed"

\end_inset

The speed of some 
\begin_inset Formula $\mathtt{R}$
\end_inset

 procedures, in microseconds.
 The speeds are measured by 
\begin_inset Formula $\mathtt{microbenchmark}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citet
key "microbenchmark"

\end_inset

, on a Windows 10, Intel Core i7-4790 3.60 GHz, 
\begin_inset Formula $\mathtt{R}$
\end_inset

 version 
\begin_inset Quotes eld
\end_inset

Pumpkin Helmet
\begin_inset Quotes erd
\end_inset

.
 Curiously, RedBlue is faster than sorting for small 
\begin_inset Formula $n$
\end_inset

s, something which can only be explained by a bad implementation of 
\begin_inset Formula $\mathtt{sort}$
\end_inset

 in 
\begin_inset Formula $\mathtt{R}$
\end_inset

.
 The performance of 
\begin_inset Formula $\mathtt{mean}$
\end_inset

 is plotted for comparisons sake.
 The timings were obtained through the package 
\begin_inset Formula $\mathtt{microbenchmark}$
\end_inset

 and the smoothing is done by the package 
\begin_inset Formula $\mathtt{locfit}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
If we are only interested in finding one solution, not the entire solution
 set, it might be possible to improve the runtime of this algorithm by using
 an approach similar to that of the Quickselect algorithm: The reason why
 our algorithm isn't linear time is because we presort the entire list,
 something which is not necessary when we only need one maximum.
 By using the concept of colour depth from Section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Manski Robustness"

\end_inset

, one can attempt to create a sophisticated branch-and-bound algorithm in
 order to prune the computation tree of QuickSort.
 It is unknown whether such an idea would work out or not.
\end_layout

\begin_layout Subsubsection
Two dimensions
\end_layout

\begin_layout Standard
An approach to solving this problem is to iteratively apply the RedBlue
 algorithm: For each half-plane 
\begin_inset Formula $H_{i}$
\end_inset

 with boundary 
\begin_inset Formula $L_{i}$
\end_inset

, we can calculate the value of 
\begin_inset Formula $m(\beta_{1},\beta_{2})$
\end_inset

 (Manski's objective, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Manski's objective"

\end_inset

) for every 
\begin_inset Formula $\beta_{1},\beta_{2}\in L_{i}$
\end_inset

 by using the RedBlue algorithm.
 This is done by calculating the intersection point 
\begin_inset Formula $z_{j}=L_{i}\cap L_{j}$
\end_inset

 for every 
\begin_inset Formula $j\neq i$
\end_inset

, and decide on whether 
\begin_inset Formula $z_{i}$
\end_inset

 is blue or red.
 We walk along 
\begin_inset Formula $L_{i}$
\end_inset

 from right to left.
 When we encounter another line 
\begin_inset Formula $L_{j}$
\end_inset

, we observe whether the half-plane 
\begin_inset Formula $H_{i}$
\end_inset

 covers the ground we've already passed or not, if it is covered, 
\begin_inset Formula $z_{i}$
\end_inset

 is coloured red; if it doesn't, it is coloured blue.
 Be aware that 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $H_{i}$
\end_inset

 covers the ground we've already passed
\begin_inset Quotes erd
\end_inset

 is 
\emph on
not 
\emph default
the same as 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $H_{i}$
\end_inset

 is red
\begin_inset Quotes erd
\end_inset

, where the colour of hyperplanes are defined as in Section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sub:Manski geometry"

\end_inset

.
 It depends on the relation between the slopes of 
\begin_inset Formula $L_{i}$
\end_inset

 and 
\begin_inset Formula $L_{j}$
\end_inset

 in addition to the colour, as illustrated in the figure.
 Let 
\begin_inset Formula $s_{i}$
\end_inset

 be the slope of 
\begin_inset Formula $L_{i}$
\end_inset

 and 
\begin_inset Formula $s_{j}$
\end_inset

 be the slope of 
\begin_inset Formula $L_{j}$
\end_inset

.
 If 
\begin_inset Formula $s_{j}<s_{i}$
\end_inset

, let 
\begin_inset Formula $z_{j}$
\end_inset

 be coloured oppositely of 
\begin_inset Formula $H_{i}$
\end_inset

, and if 
\begin_inset Formula $s_{i}<s_{j}$
\end_inset

, keep its colour.
 How this works is illustrated in Figure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:Angles of  intersection"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Manski/ConfigurationExample.pdf
	scale 80

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Angles of  intersection"

\end_inset

Different angles between 
\begin_inset Formula $L_{i}$
\end_inset

(black) and 
\begin_inset Formula $L_{j}$
\end_inset

 (coloured).
 The colour of the point is used in the RedBlue algorithm.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

If we do this for every line 
\begin_inset Formula $L_{i}$
\end_inset

, we get a table of 
\begin_inset Formula $m(z_{j}^{i})$
\end_inset

 for 
\begin_inset Formula $j\neq i$
\end_inset

.
 The maxima of all these will come in pairs corresponding to intervals on
 some 
\begin_inset Formula $L_{i}$
\end_inset

, hence they will form line segments.
 These line segments will, by the geometric characterisation, form convex
 polygons in the plane, and the solution set is the union of these polygons.
 Running through the procedure, we visit 
\begin_inset Formula $n$
\end_inset

 lines and check 
\begin_inset Formula $n-1$
\end_inset

 intersections for each of them.
 Since RedBlue runs in 
\begin_inset Formula $O(n\log n)$
\end_inset

 time, the runtime of this two dimensional algorithm is 
\begin_inset Formula $O(n^{2}\log n)$
\end_inset

.
 It has been implemented in 
\begin_inset Formula $\mathtt{C++},$
\end_inset

 with a link to 
\begin_inset Formula $\mathtt{R}$
\end_inset

 through 
\begin_inset Formula $\mathtt{Rcpp}$
\end_inset

, just like the RedBlue algorithm.
 The code is in Appendix 
\begin_inset CommandInset ref
LatexCommand eqref
reference "chap:Manski's estimator"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Higher dimensions
\end_layout

\begin_layout Standard
We can recursively apply the same idea in covariate dimensions 
\begin_inset Formula $d>2$
\end_inset

.
 Assuming we can solve MAX-FLS in 
\begin_inset Formula $d-1$
\end_inset

 dimensions in 
\begin_inset Formula $n^{d-1}\log n$
\end_inset

 time, we can iterate through all hyperplanes 
\begin_inset Formula $1+X_{i}^{T}\beta$
\end_inset

 in order to find the optimal 
\begin_inset Formula $(d-1)$
\end_inset

-dimensional facets there.
 As an example, consider 
\begin_inset Formula $d=3$
\end_inset

.
 In this case, the solution sets are polyhedra.
 In order to find the 
\begin_inset Formula $w$
\end_inset

-maximal polyhedra, we identify the 
\begin_inset Formula $w$
\end_inset

-maximal faces.
 For a single plane 
\begin_inset Formula $1+X_{i}^{T}\beta$
\end_inset

, we cam find its optimal faces by running the 2-dimensional algorithm on
 the arrangement arising from 
\begin_inset Formula $1+X_{i}^{T}\beta$
\end_inset

 intersected with 
\begin_inset Formula $\left\{ 1+X_{j}^{T}\beta\right\} _{j\neq i}$
\end_inset

.
 If we do this for each 
\begin_inset Formula $i,$
\end_inset

 we will uncover the maximal faces, from which we can construct the maximal
 polytopes.
 This procedure is 
\begin_inset Formula $O(n^{3}\log n)$
\end_inset

, as it runs through 
\begin_inset Formula $n$
\end_inset

 different 2-dimensional algorithms with run-time 
\begin_inset Formula $O(n^{2}\log n)$
\end_inset

.
 This can clearly be generalised to arbitrary dimensions, yielding the general
 run time 
\begin_inset Formula $O(n^{d}\log n)$
\end_inset

.
 Alas, we have not found time to implement the algorithm for 
\begin_inset Formula $d>2$
\end_inset

.
\end_layout

\begin_layout Section
Robustness
\begin_inset CommandInset label
LatexCommand label
name "sec:Manski Robustness"

\end_inset


\end_layout

\begin_layout Standard
The robustness of Manski's estimator has not been studied before.
 As has been alluded to in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Deepest regression"

\end_inset

, the geometry of Manski's estimator is quite similar to that of the deepest
 regression estimator 
\begin_inset CommandInset citation
LatexCommand citep
key "rousseeuw1999regression"

\end_inset

.
 We will borrow, and change slightly, concepts from the literature on that
 estimator.
 A particularly important concept is the generalisation of the concept of
 
\emph on
undirected depth
\emph default
 to our 
\begin_inset Quotes eld
\end_inset

coloured
\begin_inset Quotes erd
\end_inset

 domain.
 
\end_layout

\begin_layout Standard
Why study robustness? The reason why robust estimators are important is
 that basic, convenient assumptions might not hold.
 Typically, robustness is studied in the parametric context, with the archetypic
al example being the estimation of the expectation 
\begin_inset Formula $\mu$
\end_inset

 when we 
\emph on
think 
\emph default
that 
\begin_inset Formula $X_{1},...,X_{n}\stackrel{i.i.d.}{\sim}N(\mu,1)$
\end_inset

.
 It is well known that the sample mean is the maximum likelihood estimator,
 which is efficient, easy to compute, easy to interpret, and incidentally
 very easy to find the distribution of.
 Despite these qualities, it is very sensitive to 
\emph on
single outliers 
\emph default
in the following sense: Given 
\begin_inset Formula $n$
\end_inset

 
\begin_inset Quotes eld
\end_inset

good
\begin_inset Quotes erd
\end_inset

 observations 
\begin_inset Formula $X_{1},...,X_{n}$
\end_inset

 from 
\begin_inset Formula $N(\mu,1)$
\end_inset

, we can add another 
\begin_inset Formula $X_{n+1}$
\end_inset

 and set its value to 
\begin_inset Formula $x$
\end_inset

.
 Denote 
\begin_inset Formula $\overline{X}=\frac{1}{n}\sum_{i=1}^{n}X_{i}$
\end_inset

 and 
\begin_inset Formula $\overline{X}'=\frac{1}{n+1}\sum_{i=1}^{n}X_{i}+\frac{1}{n+1}X_{n+1}$
\end_inset

.
 Clearly, 
\begin_inset Formula $\frac{1}{n+1}\sum_{i=1}^{n}X_{i}\approx\frac{1}{n}\sum_{i=1}^{n}X_{i}$
\end_inset

, but by sending 
\begin_inset Formula $x$
\end_inset

 off to infinity, we can make the 
\begin_inset Quotes eld
\end_inset

bad
\begin_inset Quotes erd
\end_inset

 mean arbitrarily large by adding just one outlier.
 Generally, if 
\begin_inset Formula $T$
\end_inset

 is a statistical functional, this kind of analysis can be formalized, asymptoti
cally, by the concept of 
\emph on
influence curves.
 
\emph default
Also, in the finite sample domain, we have the far less popular concept
 of sensitivity curve.
 
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:Influence curve"

\end_inset


\begin_inset CommandInset citation
LatexCommand citep
after "section 3.1"
key "maronna2006robust"

\end_inset

Let 
\begin_inset Formula $T$
\end_inset

 be a statistical functional, 
\begin_inset Formula $F$
\end_inset

 be a distribution and 
\begin_inset Formula $\delta_{x}$
\end_inset

 be the unit mass on 
\begin_inset Formula $x$
\end_inset

.
 The influence curve of 
\begin_inset Formula $T$
\end_inset

 at 
\begin_inset Formula $x$
\end_inset

 is 
\begin_inset Formula $IF(x;F)=\lim_{\epsilon\searrow0}\frac{T((1-\epsilon)F+\epsilon\delta_{x})-T(F)}{\epsilon}$
\end_inset

.
 If 
\begin_inset Formula $F_{n}$
\end_inset

 is the empirical cdf obtained from 
\begin_inset Formula $n$
\end_inset

 observations, the sensitivity curve is 
\begin_inset Formula $SF_{n}(x;F_{n})=(n+1)T(\frac{n}{n+1}F_{n}+\frac{1}{n+1}\delta_{x})-T(F_{n})$
\end_inset

.
\end_layout

\begin_layout Standard
The influence curve tells us about the behaviour of 
\begin_inset Formula $T$
\end_inset

 when 
\begin_inset Formula $F$
\end_inset

 is infinitesimally contaminated by 
\begin_inset Formula $\delta_{x}$
\end_inset

.
 The definition looks strikingly much like that of the ordinary derivative,
 and it can often be used as such in Taylor expansions of statistical functional
s, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
after "chapter 20"
key "van2000asymptotic"

\end_inset

.
 We say that an estimator is robust against single outliers if it has a
 bounded influence curve.
 Examples of estimators with bounded influence curve for 
\begin_inset Formula $\mu$
\end_inset

 is the 
\begin_inset Formula $\alpha$
\end_inset

-trimmed mean and the median.
 We will not discuss the influence curve more.
 For more information about the influence curve and related concepts, see
 any book on robust statistics, for instance 
\begin_inset CommandInset citation
LatexCommand cite
key "huber2011robust"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "maronna2006robust"

\end_inset

.
\end_layout

\begin_layout Standard
The influence curve does not quantify resistance to multiple outliers.
 There are several measures that do this, but we will focus on the breakdown
 point, introduced in 
\begin_inset CommandInset citation
LatexCommand cite
key "donoho1983notion"

\end_inset

.
\end_layout

\begin_layout Definition
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Breakdown point
\end_layout

\end_inset

Let 
\begin_inset Formula $T$
\end_inset

 be a statistical functional and 
\begin_inset Formula $F$
\end_inset

 be a distribution.
 The (asymptotic) 
\emph on
breakdown point
\emph default
 is defined by 
\begin_inset Formula $\epsilon^{*}(T,F)=\inf\left\{ \epsilon\mid\sup_{G}||T((1-\epsilon)F+\epsilon G)-T(F)||=\infty\right\} .$
\end_inset


\end_layout

\begin_layout Standard
The breakdown point also has a finite sample analogue, the finite sample
 breakdown point 
\begin_inset Formula $\epsilon_{f}^{*}(T,F_{n})$
\end_inset

.
 This can be defined in two almost equal ways: Either the minimal number
 of observations which has to be 
\emph on
replaced 
\emph default
in order to make the estimator diverge, or the number of observation which
 has to be 
\emph on
added
\emph default
 in order to make the estimator diverge.
 Following 
\begin_inset CommandInset citation
LatexCommand cite
key "rousseeuw2005robust"

\end_inset

, we use the first definition.
 Their justification is that this is how most outliers actually arise ---
 originally good observations are contaminated by some source, for instance
 clerical errors in the entry of data.
 Another, more practical reason is that this definition is easier to work
 with in this particular problem.
\end_layout

\begin_layout Standard
This concept of finite sample breakdown point is, non-shockingly, often
 sample dependent, though this is not always the case.
 For instance the least median of squares estimator has a finite sample
 breakdown point of 
\begin_inset Formula $\frac{\lceil n/2\rceil+d-1}{n}$
\end_inset

 independent of the sample 
\begin_inset CommandInset citation
LatexCommand citep
key "rousseeuw2005robust"

\end_inset

.
 The breakdown point of Manski's estimator is extremely sample dependent,
 as we will see soon.
 Everything in the two next section is our original work.
\end_layout

\begin_layout Subsection
Breakdown in one dimension
\end_layout

\begin_layout Standard
Recall that the setting of Manski's estimator in one dimension is a line
 with several blue and red points.
 If our observations are 
\begin_inset Formula $x_{1},...x_{n}$
\end_inset

 and 
\begin_inset Formula $y_{1},...,y_{n}$
\end_inset

, the red points are the points 
\begin_inset Formula $-\frac{1}{x_{i}}$
\end_inset

 where either both 
\begin_inset Formula $y_{i}=1$
\end_inset

 and 
\begin_inset Formula $x_{i}>0$
\end_inset

 or both 
\begin_inset Formula $y_{i}=0$
\end_inset

 and 
\begin_inset Formula $x_{i}<0$
\end_inset

.
 The rest of the points are blue.
 Given such a set of coloured points on the line, we can find the 
\emph on
colour depth
\emph default
 of a point.
\end_layout

\begin_layout Definition
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Colour depth
\end_layout

\end_inset

Let 
\begin_inset Formula $z\in\mathbb{R}$
\end_inset

.
 Define 
\begin_inset Formula $r_{l}(z),r_{r}(z),b_{l}(z),b_{r}(z)$
\end_inset

 as the amount of red points to the left of 
\begin_inset Formula $z$
\end_inset

, red points to the right of 
\begin_inset Formula $z$
\end_inset

, blue points to the left of 
\begin_inset Formula $z$
\end_inset

 and blue points to the right of 
\begin_inset Formula $z$
\end_inset

, respectively.
 All of this is inclusive.
 We define the colour depth of 
\begin_inset Formula $z$
\end_inset

, denoted 
\begin_inset Formula $\mathfrak{C}(z)=\min\left\{ r_{l}(z)-b_{l}(z),b_{r}(z)-r_{r}(z)\right\} $
\end_inset

.
 Also let 
\begin_inset Formula $\mathfrak{M}=\max_{z\in\mathbb{R}}\mathfrak{C}(z)$
\end_inset

 be the 
\emph on
maximal colour depth
\emph default
.
 If 
\begin_inset Formula $\mathfrak{C}(z)=\mathfrak{M}$
\end_inset

, 
\begin_inset Formula $z$
\end_inset

 is a 
\emph on
witness
\emph default
 to the maximal colour depth.
\end_layout

\begin_layout Standard
The following lemma indicates why this is an important concept: To maximise
 the colour depth is equivalent to the maximisation of Manski's objective
 function 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Manski's objective"

\end_inset

, which we denote 
\begin_inset Formula $m$
\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:Maximality Condition, d = 1"

\end_inset

A point 
\begin_inset Formula $z\in\mathbb{R}$
\end_inset

 is a solution to Manski's objective if and only if it is of maximal colour
 depth.
 
\end_layout

\begin_layout Proof
Assume 
\begin_inset Formula $z$
\end_inset

 is of non-maximal colour depth, and assume wlog there is a point 
\begin_inset Formula $z'$
\end_inset

 of greater colour depth to its right.
 Now count of blue 
\begin_inset Formula $(b)$
\end_inset

 and red 
\begin_inset Formula $(r)$
\end_inset

 points between 
\begin_inset Formula $z$
\end_inset

 and 
\begin_inset Formula $z'$
\end_inset

.
 We have three cases: If 
\begin_inset Formula $r>b$
\end_inset

, then 
\begin_inset Formula $m(z)=b_{r}(z)+r_{l}(z)=b+b_{r}(z')+r_{l}(z)<r+b_{r}(z')+r_{l}(z)=m(z')$
\end_inset

.
 If 
\begin_inset Formula $r=b$
\end_inset

, both 
\begin_inset Formula $r_{l}(z')-b_{l}(z')=r_{l}(z)-b_{l}(z)$
\end_inset

 and 
\begin_inset Formula $b_{r}(z')-r_{r}(z')=b_{r}(z)-r_{r}(z)$
\end_inset

 and 
\begin_inset Formula $z'$
\end_inset

 hasn't greater colour depth than 
\begin_inset Formula $z$
\end_inset

.
 Lastly, if 
\begin_inset Formula $r<b$
\end_inset

, then 
\begin_inset Formula $r_{l}(z')-b_{l}(z')<r_{l}(z)-b_{l}(z)$
\end_inset

 and 
\begin_inset Formula $b_{r}(z')-r_{r}(z')<b_{r}(z)-r_{r}(z)$
\end_inset

, again contradicting that 
\begin_inset Formula $z'$
\end_inset

 has greater colour depth.
 From this both claims follows: The first implication 
\begin_inset Formula $(\Rightarrow)$
\end_inset

 is proved contrapositively, while the second 
\begin_inset Formula $(\Leftarrow)$
\end_inset

 by assuming another point is maximal and reaching a contradiction.
  
\end_layout

\begin_layout Standard
In order to make the estimator break down, we will have to add and remove
 strategically chosen lines such that 1.) every point 
\begin_inset Formula $z$
\end_inset

 of maximal colour depth loses that status and 2.) there is a new set of
 points with maximal colour depth placed arbitrarily far out.
 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "lem:Finite sample breakdown, d = 1"

\end_inset

The finite sample breakdown point of Manski's estimator with 
\begin_inset Formula $d=1$
\end_inset

 is 
\begin_inset Formula $\lceil\frac{\mathfrak{M}}{2}\rceil/n$
\end_inset

.
\end_layout

\begin_layout Proof
We begin with 
\begin_inset Formula $\epsilon^{*}\leq\lceil\frac{\mathfrak{M}}{2}\rceil/n$
\end_inset

.
 Let 
\begin_inset Formula $z$
\end_inset

 have maximal colour depth, and assume wlog the minimal weight is on its
 right.
 In that case, there are 
\begin_inset Formula $\mathfrak{M}$
\end_inset

 surplus blues on its right.
 Now change the colour of these 
\begin_inset Formula $\lceil\frac{\mathfrak{M}}{2}\rceil$
\end_inset

 points, starting from the rightmost one.
 Let 
\begin_inset Formula $z'$
\end_inset

 be the rightmost of the red points, with 
\begin_inset Formula $m(z')=r_{l}(z)+r_{r}(z)+\lceil\frac{\mathfrak{M}}{2}\rceil$
\end_inset

.
 Also, 
\begin_inset Formula $m(z)=r_{l}(z)+b_{r}(z)-\lceil\frac{\mathfrak{M}}{2}\rceil$
\end_inset

.
 But since 
\begin_inset Formula $r_{r}(z)+\frac{\mathfrak{M}}{2}=b_{r}(z)-\frac{\mathfrak{M}}{2}$
\end_inset

 by definition, the rightmost point is a solution and we have attained a
 breakdown.
\end_layout

\begin_layout Proof
Now assume 
\begin_inset Formula $\epsilon^{*}<\lceil\frac{\mathfrak{M}}{2}\rceil/n$
\end_inset

, and let the points be reconfigured such that a breakdown has been attained
 in less than 
\begin_inset Formula $\lceil\frac{\mathfrak{M}}{2}\rceil$
\end_inset

 steps.
 Without loss of generality, assume that the rightmost element of the new
 configuration is red.
 Since this point is a solution, it has maximal colour depth.
 Furthermore, the maximal colour depth is equal to zero, as there are 
\begin_inset Formula $0$
\end_inset

 points to the right of it.
 Let 
\begin_inset Formula $z$
\end_inset

 be any other point, which automatically satisfies 
\begin_inset Formula $\mathfrak{C}(z)\leq0$
\end_inset

.
 If 
\begin_inset Formula $z$
\end_inset

 is a witness to the the maximal colour depth of the original configuration,
 we must be able to recover this number by replacing 
\begin_inset Formula $\lceil\frac{\mathfrak{M}}{2}\rceil$
\end_inset

 points.
 Since an element can increase its maximal colour depth with at most two
 for each rearrangement of a single point, we have 
\begin_inset Formula $\mathfrak{C}(z)<2\lceil\frac{\mathfrak{M}}{2}\rceil$
\end_inset

.
 If 
\begin_inset Formula $\mathfrak{M}$
\end_inset

 is even, this is contrary to hypothesis.
 If 
\begin_inset Formula $\mathfrak{M}$
\end_inset

 is odd, notice that since 
\begin_inset Formula $\lfloor\frac{\mathfrak{M}}{2}\rfloor=\lceil\frac{\mathfrak{M}}{2}\rceil+1$
\end_inset

, we would have to be able to recover 
\begin_inset Formula $\mathfrak{C}(z)$
\end_inset

 in at least 
\begin_inset Formula $2\lfloor\frac{\mathfrak{M}}{2}\rfloor$
\end_inset

.
 But this gives 
\begin_inset Formula $\mathfrak{C}(z)\leq2\lfloor\frac{\mathfrak{M}}{2}\rfloor<\mathfrak{M}$
\end_inset

.
 
\end_layout

\begin_layout Standard
A special case occurs when 
\begin_inset Formula $\mathfrak{M}=0,$
\end_inset

 which gives a breakdown point of 
\begin_inset Formula $0$
\end_inset

.
 This is not an error.
 When the 
\begin_inset Formula $\mathfrak{M}$
\end_inset

 is 
\begin_inset Formula $0$
\end_inset

, the solution set is unbounded either to the right or to the left, hence
 it has already broke down.
 To see why, assume we have a configuration which has 
\begin_inset Formula $\mathfrak{M=}0$
\end_inset

.
 Choice a maximal point 
\begin_inset Formula $z$
\end_inset

 and assume its minimal colour depth occurs to its right.
 Clearly, there are equally many, say 
\begin_inset Formula $k$
\end_inset

, blues and reds on that side.
 If the rightmost point is red, the solution set is unbounded, so assume
 it is not.
 If the rightmost point is blue, choose the red point closest to it, named
 
\begin_inset Formula $z'$
\end_inset

.
 Then 
\begin_inset Formula $m(z')\geq r_{l}(z)+k+1$
\end_inset

, as it covers all the red points 
\begin_inset Formula $z$
\end_inset

 covers, all the red points to its right and at least one blue point.
 But this contradicts the maximality of 
\begin_inset Formula $z$
\end_inset

, as 
\begin_inset Formula $m(z)=r_{l}(z)+k$
\end_inset

.
 This happens with non-zero probability in familiar settings when 
\begin_inset Formula $n=100$
\end_inset

, as we can see in Figure 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:Simulated-breakdown-points"

\end_inset

.
\end_layout

\begin_layout Remark
Since solutions aren't unique, it is not entirely clear how to define the
 breakdown point.
 Two different choices can be made.
 We can think of the estimator as broken down whenever there is a solution
 with unbounded absolute value, which is our choice here.
 On the other hand, we could also think of the estimator as broken when
 there are no 
\begin_inset Quotes eld
\end_inset

small
\begin_inset Quotes erd
\end_inset

 solutions at all: If for all 
\begin_inset Formula $n\in\mathbb{N}$
\end_inset

 there are some points such that the absolute value of the new configuration's
 minimal solution is greater than 
\begin_inset Formula $n$
\end_inset

.
 In order to make the second definition work, the breakdown point would
 be 
\begin_inset Formula $(\lfloor\frac{\mathfrak{M}}{2}\rfloor+1)/n$
\end_inset

 instead.
 We will use the first definition as it makes proofs slightly easier: When
 replacing points, we will only have to think about switching colours, not
 changing coordinates.
\end_layout

\begin_layout Standard
From Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:Finite sample breakdown, d = 1"

\end_inset

 we get the following rough upper bound on the asymptotic breakdown point.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:The-breakdown-point"

\end_inset

The breakdown point of Manski's estimator with 
\begin_inset Formula $d=1$
\end_inset

 is bounded above by 
\begin_inset Formula $\nicefrac{1}{4}$
\end_inset

.
\end_layout

\begin_layout Proof
The best possible value of 
\begin_inset Formula $\mathfrak{M}$
\end_inset

 is 
\begin_inset Formula $n/2$
\end_inset

, which is attained iff the points are perfectly separated into a set of
 red elements only on the left and a set blue elements on the right.
 Pass 
\begin_inset Formula $n$
\end_inset

 to the limit in order to get the result.
\end_layout

\begin_layout Standard
Given covariates 
\begin_inset Formula $X_{i}\sim G$
\end_inset

 and an error distribution 
\begin_inset Formula $F$
\end_inset

, we can calculate the asymptotic analogues of 
\begin_inset Formula $r_{l}(\widehat{\beta}),b_{r}(\widehat{\beta})$
\end_inset

 etc.
 through substituting 
\begin_inset Formula $\beta$
\end_inset

 for 
\begin_inset Formula $\widehat{\beta}$
\end_inset

 and then calculating their exact distributions.
 If we denote the exact distributions 
\begin_inset Formula $r_{l}^{\infty}(\beta),b_{r}^{\infty}(\beta)$
\end_inset

 etc., we see that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
r_{l}^{\infty}(\beta) & = & P(Y=0,X<0,-\frac{1}{X}<\beta)+P(Y=1,X\geq0,-\frac{1}{X}<\beta),\\
b_{l}^{\infty}(\beta) & = & P(Y=1,X<0,-\frac{1}{X}<\beta)+P(Y=0,X\geq0,-\frac{1}{X}<\beta),\\
b_{r}^{\infty}(\beta) & = & P(Y=1,X<0,-\frac{1}{X}>\beta)+P(Y=0,X\geq0,-\frac{1}{X}>\beta),\\
r_{r}^{\infty}(\beta) & = & P(Y=0,X<0,-\frac{1}{X}>\beta)+P(Y=1,X\geq0,-\frac{1}{X}>\beta).
\end{eqnarray*}

\end_inset

These equations follow directly from the definitions of blue and red points.
 As corollary of this observation and the preceding proposition, we get
\end_layout

\begin_layout Corollary
The breakdown point of Manski's estimator (
\begin_inset Formula $d=1$
\end_inset

) is
\end_layout

\begin_layout Corollary
\begin_inset Formula 
\[
\mathcal{B}=\frac{1}{2}\min\left(r_{l}^{\infty}(\beta)-b_{l}^{\infty}(\beta),b_{r}^{\infty}(\beta)-r_{r}^{\infty}(\beta)\right)
\]

\end_inset


\end_layout

\begin_layout Standard
Now we provide some illustrations of these results.
 Using numerical integration, it is not hard to calculate the asymptotic
 breakdown points, which we do for a handful of covariate and error distribution
s in Figure 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:Breakdown-point-plot"

\end_inset

.
 In Figure 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:Simulated-breakdown-points"

\end_inset

 we show simulated maximal colour depths for the case of standard logistic
 errors and normal covariates, a case close to ordinary logistic regression.
 
\end_layout

\begin_layout Standard
Contrary to most estimators for linear regression, this estimator has the
 bad properties of being both sample dependent (in the finite sample case)
 and dependent on the data generating mechanism.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Manski/AsymptoticBreakdown1D.pdf
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Breakdown-point-plot"

\end_inset

Breakdown point plot for several different error distributions.
 The exponential and log normal errors have been normalized to have median
 equal to 
\begin_inset Formula $0$
\end_inset

.
 (Subtract 
\begin_inset Formula $\log(2)$
\end_inset

 and 
\begin_inset Formula $1$
\end_inset

 respectively).
 The corresponding covariate distribution are logistic, normal, normal,
 Cauchy and normal, respectively.
 When the errors are exponential, the breakdown point is nearly 
\begin_inset Formula $\nicefrac{1}{4}$
\end_inset

 when 
\begin_inset Formula $\beta$
\end_inset

 is small, which indicates near-perfect separation.
 This comes as no surprise; the exponential distribution has a median of
 
\begin_inset Formula $\log(2)$
\end_inset

, hence the error-term accounts is 
\begin_inset Formula $1-\log(2)$
\end_inset

 at minimum, a value it is difficult to overcome for 
\begin_inset Formula $\beta X$
\end_inset

 when 
\begin_inset Formula $\beta$
\end_inset

 is small; this reasoning makes it clear that the breakdown point converges
 to 
\begin_inset Formula $0.25$
\end_inset

 when 
\begin_inset Formula $\beta\to0$
\end_inset

 for both the log normal and exponential errors.
 Similar considerations explain the other features of the plot, for instance
 that Cauchy/Cauchy has a smaller breakdown points than Normal/Normal.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Manski/BreakdownLogistic.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Simulated-breakdown-points"

\end_inset

Simulated breakdown points together with asymptotic breakdown points for
 standard normally distributed covariates and logistic error distribution.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Breakdown in several dimensions
\end_layout

\begin_layout Standard
We extend to concept of colour depth to 
\begin_inset Formula $d>1$
\end_inset

.
 The challenge is to find the right generalisation, as there is no suitable
 total order in higher dimensions.
 We rectify this by using projections.
 In the following definition, 
\begin_inset Formula $\mathcal{H}$
\end_inset

 is the set of half-planes induced by the data set 
\begin_inset Formula $(y_{1},x_{1}),(y_{2},x_{2}),...,(y_{n},x_{n})$
\end_inset

.
 
\end_layout

\begin_layout Definition
Let 
\begin_inset Formula $l$
\end_inset

 be a line, and define the colour depth of a line 
\begin_inset Formula $l$
\end_inset

 as the maximal colour depth of the configuration induced by 
\begin_inset Formula $\left\{ H\cap l\mid H\in\mathcal{H}\right\} $
\end_inset

.
 Let 
\begin_inset Formula $p\in\mathbb{R}^{d}$
\end_inset

, and define 
\begin_inset Formula $L_{p}$
\end_inset

 to be the set of all directed lines passing through 
\begin_inset Formula $p$
\end_inset

.
 Then 
\begin_inset Formula $\mathfrak{C}(p)$
\end_inset

 is 
\begin_inset Formula $\min_{l\in L_{p}}\left\{ \mathfrak{C}(l)\right\} $
\end_inset

; the minimal colour depth (at 
\begin_inset Formula $p)$
\end_inset

 of all lines passing through 
\begin_inset Formula $p$
\end_inset

.
 The maximal directed colour depth is 
\begin_inset Formula $\mathfrak{M}=\max_{p\in\mathbb{R}^{d}}\mathfrak{C}(p)$
\end_inset

.
\end_layout

\begin_layout Standard
This is the 
\begin_inset Quotes eld
\end_inset

coloured
\begin_inset Quotes erd
\end_inset

 variant of the notion of 
\emph on
undirected depth
\emph default
, used in the analysis of the deepest regression estimator 
\begin_inset CommandInset citation
LatexCommand citet
key "rousseeuw1999depth"

\end_inset

.
 The concept is deeper and more difficult to analyse.
 The following is a natural generalisation of Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:Maximality Condition, d = 1"

\end_inset

.
\end_layout

\begin_layout Conjecture
A point has 
\begin_inset Formula $p$
\end_inset

 is of maximal colour depth iff it is a solution to Manski's objective.
\end_layout

\begin_layout Standard
Given 
\begin_inset Formula $n$
\end_inset

 points, which configuration of coloured planes would give the highest breakdown
 point? It appears likely that this is a 
\emph on
d-simplex
\emph default
 where each face has 
\begin_inset Formula $\frac{n}{d+1}$
\end_inset

 planes of the same colour stacked on the top of one another.
 A 
\begin_inset Formula $d-$
\end_inset

simplex is 
\begin_inset Formula $d$
\end_inset

-polytope with the smallest possible number of faces, namely 
\begin_inset Formula $d+1$
\end_inset

.
 Assume 
\begin_inset Formula $n=(d+1)k$
\end_inset

 for a 
\begin_inset Formula $k$
\end_inset

, and observe that the maximal colour depth of this configuration is 
\begin_inset Formula $k$
\end_inset

.
 Furthermore, its breakdown is easily seen to be 
\begin_inset Formula $\frac{k}{2}$
\end_inset

; one would need to replace half of the planes adjacent to one of the faces
 with planes of the opposite colour.
 This gives rise to the following conjecture, which generalises Corollary
 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:The-breakdown-point"

\end_inset

.
\end_layout

\begin_layout Conjecture
The breakdown point of Manski's estimator in covariate dimension 
\begin_inset Formula $d$
\end_inset

 is bounded above by 
\begin_inset Formula $\frac{1}{2(1+d)}.$
\end_inset


\end_layout

\begin_layout Standard
The generalisation of Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:Finite sample breakdown, d = 1"

\end_inset

 is likely false.
 The reason is that a point of maximal colour depth can have 
\begin_inset Quotes eld
\end_inset

independent
\begin_inset Quotes erd
\end_inset

 witnessing lines, in the sense that swapping the colours of 
\begin_inset Formula $\mathfrak{M}/2$
\end_inset

 points on one witnessing line doesn't necessarily make every other witnessing
 line get its colour depth pushed down to 
\begin_inset Formula $0$
\end_inset

.
 However, that the finite sample breakdown point is bounded 
\emph on
below
\emph default
 by 
\begin_inset Formula $\mathfrak{M}/2$
\end_inset

 is probably easy to show.
\end_layout

\begin_layout Conjecture
The finite sample breakdown point of Manski's estimator in covariate dimension
 
\begin_inset Formula $d$
\end_inset

 is bounded below by 
\begin_inset Formula $\mathfrak{M}/2$
\end_inset

.
\end_layout

\begin_layout Standard
The breakdown point will probably be very close to this in any case.
 It seems difficult to analyse how and when the phenomenon above occurs,
 and how bad it could be.
 We leave attempted proofs or disproofs of these conjectures to another
 time, but we're not entirely done with the topic of robustness, as empirical
 robustness studies are included in the next section.
\end_layout

\begin_layout Section
Illustrations and simulations
\begin_inset CommandInset label
LatexCommand label
name "sec:Manski illustrations"

\end_inset


\end_layout

\begin_layout Subsection
The role of the covariates' distribution
\end_layout

\begin_layout Standard
Manski's estimator (in 
\begin_inset Formula $d=1$
\end_inset

) has large problems estimating values of 
\begin_inset Formula $\beta_{1}$
\end_inset

 that are close to 
\begin_inset Formula $0$
\end_inset

.
 Essentially, this is because the candidate intervals 
\begin_inset Formula $<-\frac{1}{x_{i}},-\frac{1}{x_{j}}>$
\end_inset

 require some very large 
\begin_inset Formula $x_{i}$
\end_inset

s in order to get close to 
\begin_inset Formula $0$
\end_inset

.
 Assume 
\begin_inset Formula $X_{i}\stackrel{i.i.d.}{\sim}N(0,1)$
\end_inset

, 
\begin_inset Formula $Y=1_{[1+0\cdot X_{i}+\epsilon_{i}\geq0]}$
\end_inset

, and for simplicity that the optimal set is 
\begin_inset Formula $<-\frac{1}{x_{i}},-\frac{1}{x_{j}}>$
\end_inset

, with 
\begin_inset Formula $x_{i}=\max X_{i}$
\end_inset

.
 Say we want an 
\begin_inset Formula $n$
\end_inset

 such that the lower bound 
\begin_inset Formula $0>-\frac{1}{x_{i}}>-0.20$
\end_inset

 holds with probability at least 
\begin_inset Formula $0.5$
\end_inset

.
 This requires at least one observation greater than 5, and this happens
 with probability greater than 
\begin_inset Formula $0.5$
\end_inset

 for 
\begin_inset Formula $n\approx2418000$
\end_inset

.
 If the 
\begin_inset Formula $X_{i}$
\end_inset

s are Cauchy, the lower bound is 
\begin_inset Formula $n=11$
\end_inset

, an enormous difference.
\begin_inset Foot
status open

\begin_layout Plain Layout
For both these observations we use that the distribution of the maximum
 is 
\begin_inset Formula $F(x)^{n}$
\end_inset

, hence 
\begin_inset Formula $P(\max X_{i}>a)=1-F(a)^{n}=0.5$
\end_inset

.
 The values can then be found using logarithms and 
\begin_inset Formula $\mathtt{R}$
\end_inset

.
\end_layout

\end_inset

 Note that the estimator will, correctly, find an optimal set covering 
\begin_inset Formula $0$
\end_inset

, but it will take an absurdly large 
\begin_inset Formula $n$
\end_inset

 to get this interval small.
 This also shows that a form of assumption 2c (at the beginning of Section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Manski Asymptotics"

\end_inset

) is required for consistency: If the covariates were uniformly distributed
 on 
\begin_inset Formula $[-a,a]$
\end_inset

, for instance, the infimal modulus of a candidate solution is 
\begin_inset Formula $\frac{1}{a}$
\end_inset

, which will not be enough to assure consistency whenever 
\begin_inset Formula $\beta_{1}<\frac{1}{a}$
\end_inset

.
 
\end_layout

\begin_layout Standard
As seen in Figure 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:Pretty figure"

\end_inset

, there are similar problems in covariate dimensions greater than 
\begin_inset Formula $1$
\end_inset

.
 For a line in the dual plane to come close to a 
\begin_inset Formula $\beta\sim(0,0)$
\end_inset

, it will require an intercept close to 
\begin_inset Formula $0$
\end_inset

, which can happen only if 
\begin_inset Formula $x_{2}$
\end_inset

 is very large.
 This reasoning clearly extends to arbitrary dimensions.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Manski/NoSolution.pdf
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Pretty figure"

\end_inset

Line plot for the model 
\begin_inset Formula $Y_{i}=1_{[1+0.05X_{1i}+0.05X_{2i}+\epsilon_{i}]}$
\end_inset

, where 
\begin_inset Formula $\epsilon_{i}\sim N(0,1)$
\end_inset

.
 The true betas are grey dots.
 (left) Standard normal covariates, which need very large 
\begin_inset Formula $n$
\end_inset

 in order to make the gap small, (right) Cauchy distribution covariates,
 which have no problem closing the gap.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Horowitz' distributions
\end_layout

\begin_layout Standard
Since Manski's estimator has cube root asymptotics, we expect it to perform
 very badly in the MSE-sense versus probit or logit whenever the assumptions
 on probit and logit are almost true.
 We simulate the MSE for several choices of covariate and error distributions
 when 
\begin_inset Formula $d=2$
\end_inset

.
 Also, we study the relative robustness properties under the 
\begin_inset Formula $\epsilon$
\end_inset

-contamination model.
 For all simulations in this section we select the first computed vertex
 of the solution set as an estimate.
 We compute the ML estimator for the logistic regression model (logit),
 so that we have something to compare the results to.
 Due to the very high variance of Manski's estimator, its only fair shot
 at overpowering the logit is for its bias to be much smaller.
 When 
\begin_inset Formula $n$
\end_inset

 is very small, the variance will dominate the bias.
 Still, we report the 
\begin_inset Formula $MSE$
\end_inset

, variance and bias for completeness.
 
\end_layout

\begin_layout Standard
First we consider the the setups 
\begin_inset Formula $L,U,T_{3}$
\end_inset

 and 
\begin_inset Formula $H$
\end_inset

 from 
\begin_inset CommandInset citation
LatexCommand cite
key "horowitz1992smoothed"

\end_inset

, which were also used Delgado et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "delgado2001subsampling"

\end_inset

 in their study of subsampling.
 Here 
\begin_inset Formula $d=2$
\end_inset

, 
\begin_inset Formula $X_{1i}\stackrel{i.i.d.}{\sim}N(0,1)$
\end_inset

, 
\begin_inset Formula $X_{2i}\stackrel{i.i.d.}{\sim}N(1,1)$
\end_inset

, and the errors are distributed as follows:
\end_layout

\begin_layout Itemize
\begin_inset Formula $L$
\end_inset

: logistic with mean 
\begin_inset Formula $\mu=0$
\end_inset

 and variance 
\begin_inset Formula $1$
\end_inset

; scale 
\begin_inset Formula $s=\sqrt{\frac{3}{\pi^{2}}}$
\end_inset

 (i.e.
 rescaled logistic regression)
\end_layout

\begin_layout Itemize
\begin_inset Formula $U$
\end_inset

: Uniform on 
\begin_inset Formula $[-\sqrt{3},\sqrt{3}]$
\end_inset

; mean 
\begin_inset Formula $0$
\end_inset

 and variance 
\begin_inset Formula $1$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $T_{3}$
\end_inset

: 
\begin_inset Formula $t$
\end_inset

-distributed with 
\begin_inset Formula $\nu=3$
\end_inset

, normalized to have variance 
\begin_inset Formula $1$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $H$
\end_inset

: 
\begin_inset Formula $\frac{1}{4}(1+2z^{2}+z^{4})v$
\end_inset

, where 
\begin_inset Formula $z=X_{1i}+X_{2i}$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 is logistic with 
\begin_inset Formula $\mu=0$
\end_inset

 and 
\begin_inset Formula $s=s=\sqrt{\frac{3}{\pi^{2}}}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
after "p. 517"
key "horowitz1992smoothed"

\end_inset

 works in the rather peculiar setting of 
\begin_inset Formula $Y=1_{[X_{1i}+\beta X_{2i}\geq0]}$
\end_inset

, 
\begin_inset Formula $\beta=1$
\end_inset

, a choice made to please the slow computers at that time.
 It only requires a small modification of the one-dimensional algorithm
 to accommodate to this change.
 While Horowitz compared Manski's estimator, logistic regression and his
 own smoothed maximum score estimator, we compare Manski's estimator and
 logistic regression.
 Initially we calculated the values for probit regression as well, but as
 they are very similar to logit they are omitted.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center

\size scriptsize
\begin_inset Tabular
<lyxtabular version="3" rows="14" columns="9">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Logit
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Manski
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
MSE
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Variance
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Bias
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
MSE
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Variance
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Bias
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\frac{MSE_{l}}{MSE_{m}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $250$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $L$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01630
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01627
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00621
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06972
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06872
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.03162
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.23379
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $500$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00792
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00791
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00238
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04193
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04121
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.02679
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.18889
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $1000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00397
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00397
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00209
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02552
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02524
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.01676
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.15556
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $250$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $U$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01916
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01897
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01381
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.12154
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.12083
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.02674
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.15764
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $500$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00935
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00926
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00933
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.07138
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.07093
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.02123
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.13099
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $1000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00461
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00455
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00815
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04490
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04479
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.01058
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.10267
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $250$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $T_{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01736
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01058
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.08235
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.05404
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.05096
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.05553
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.32124
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $500$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00615
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00615
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.00076
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02689
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02614
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.02753
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.22871
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $1000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00311
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00310
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.00202
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01711
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01685
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.01612
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.18177
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $250$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $H$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.25814
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.38534
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.93424
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.14850
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.14684
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04071
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
8.47232
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $500$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.91018
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.14515
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.87466
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.05876
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.05850
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01593
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
15.48979
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $1000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.78567
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06512
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.84885
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03044
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03032
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01093
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
25.81045
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Horowitz table"

\end_inset

Mean square errors, variances and biases for Horowitz' choice of error distribut
ions.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results in Figure 
\begin_inset CommandInset ref
LatexCommand vref
reference "tab:Horowitz table"

\end_inset

 are similar to those of Horowitz, with the exception of logit is MSE for
 
\begin_inset Formula $H$
\end_inset

.
 Horowitz obtained much higher values here, which might be explained by
 the fact that he used 
\begin_inset Formula $N=1,000$
\end_inset

 replications and we used 
\begin_inset Formula $N=10,000$
\end_inset

.
 As it turns out, Horowitz' choice of distributions, covariates and 
\begin_inset Formula $\beta$
\end_inset

s does not paint of an unbiased picture of the situation.
 Some cases of interest are not covered, most notably non-symmetric distribution
s, extremely heavy-tailed distributions and combinations of heteroskedasticity
 with these features.
 we will study these wild distributions in the next section.
\end_layout

\begin_layout Subsection
Wild distributions
\end_layout

\begin_layout Standard
We extend the Monte Carlo study to cover a non-symmetric distribution with
 support bounded to the left (adjusted standard log normal), an extremely
 heavytailed distribution (the Cauchy distribution), a skewed distribution
 with support on 
\begin_inset Formula $(-\infty,\infty)$
\end_inset

, the skewed 
\begin_inset Formula $t$
\end_inset

-distribution (
\begin_inset Formula $\nu=3$
\end_inset

,
\begin_inset Formula $\gamma=3$
\end_inset

, adjusted to have median equal to 
\begin_inset Formula $0$
\end_inset

), and a bimodal equal weight mixture of 
\begin_inset Formula $N(-1,1)$
\end_inset

 and 
\begin_inset Formula $N(1,1)$
\end_inset

.
 In addition, we will consider homoskedastic and heteroskedastic variants
 of the log-normal, Cauchy and the bimodal mixture.
 The heteroskedasticity will be of the form 
\begin_inset Formula $\sqrt{X_{1i}^{2}+X_{2i}^{2}}$
\end_inset

 and 
\begin_inset Formula $\exp\left(-X_{1}\right)$
\end_inset

.
 The results are found in Table 
\begin_inset CommandInset ref
LatexCommand vref
reference "tab:Wild distributions"

\end_inset

.
 The reduced bias of Manski's estimator is large enough to compensate for
 its increased variance in some cases, most notably for the heteroskedastic
 log-normals.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center

\size scriptsize
\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="9">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Logit
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Manski
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
MSE
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Var
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Bias
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
MSE
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Var
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Bias
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\frac{MSE_{l}}{MSE_{m}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Cauchy
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02319
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02105
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.04624
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06289
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06202
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02962
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.36875
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Log-normal
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.052
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00511
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.21654
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03951
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03943
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.0089
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.31611
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Skew 
\begin_inset Formula $t$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02917
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01613
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.11418
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.18617
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.17794
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.09076
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.15666
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Bimodal
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01457
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01403
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.02305
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.094
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.09032
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06068
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.15496
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\sqrt{X_{1i}^{2}+X_{2i}^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Cauchy
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.10741
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01509
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.30383
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.07596
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.07591
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00661
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.41404
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\exp-X_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Cauchy
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03224
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01426
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.13406
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06229
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06227
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00429
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.5175
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\sqrt{X_{1i}^{2}+X_{2i}^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Log-normal
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.11836
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00461
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.33727
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04408
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04308
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.0316
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2.68543
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\exp-X_{1}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Log-normal
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.1194
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00571
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.33718
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03803
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03749
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.02333
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
3.13947
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\sqrt{X_{1i}^{2}+X_{2i}^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Bimodal
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03102
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01626
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.12147
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.19252
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.18382
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.09329
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.16112
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\exp-X_{1}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Bimodal
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03079
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01232
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.13587
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.13821
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.13372
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06701
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.22274
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Wild distributions"

\end_inset

Mean square errors, variances and biases for our set of wild distributions,
 
\begin_inset Formula $n=800$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Contaminated data
\end_layout

\begin_layout Standard
We perform a small Monte Carlo study on contaminated data.
 The basic setup is 
\begin_inset Formula $Y_{i}=1_{[1+\beta_{1}X_{1i}+\beta_{2}X_{2i}+\epsilon_{i}]},$
\end_inset

 where the covariates are standard normal and the 
\begin_inset Formula $\epsilon_{i}$
\end_inset

s are standard logistic.
 We consider three different forms of contamination:
\end_layout

\begin_layout Enumerate
(
\begin_inset Formula $Y$
\end_inset

-contamination).
 The contaminated data comes from the same model, but with the 
\begin_inset Formula $Y_{i}$
\end_inset

s swapped.
 The contamination rate is denoted 
\begin_inset Formula $\epsilon$
\end_inset

.
\end_layout

\begin_layout Enumerate
(
\begin_inset Formula $X$
\end_inset

-contamination).
 The contaminated data is from the same model, but a random covariate is
 multiplied by 10.
 The contamination rate is denoted 
\begin_inset Formula $\delta$
\end_inset

.
\end_layout

\begin_layout Enumerate
A combination of these two: A< fraction 
\begin_inset Formula $\epsilon$
\end_inset

 of the the data is 
\begin_inset Formula $Y$
\end_inset

-contaminated and a fraction 
\begin_inset Formula $\delta$
\end_inset

 of the data is 
\begin_inset Formula $X$
\end_inset

-contaminated.
 
\end_layout

\begin_layout Standard
Both kinds of contaminations can be though of as clerical errors; in the
 second case, a decimal is misplaced, while the first corresponds to pressing
 the one wrong button out of two.
 Also, these different forms of contamination can be seen as logistic regression
 analogues of outliers in the 
\begin_inset Formula $y$
\end_inset

-direction and outliers in the 
\begin_inset Formula $x$
\end_inset

-direction from regression analysis, discussed in 
\begin_inset CommandInset citation
LatexCommand citet
after "introduction"
key "rousseeuw2005robust"

\end_inset

.
\end_layout

\begin_layout Standard
We will let 
\begin_inset Formula $(\beta_{1},\beta_{2})=(1,1)$
\end_inset

, and will only report 
\begin_inset Formula $\widehat{\beta_{1}}$
\end_inset

 due to readability and the symmetry involved here: There is no systematic
 difference between 
\begin_inset Formula $\widehat{\beta_{1}}$
\end_inset

 and 
\begin_inset Formula $\widehat{\beta_{2}}$
\end_inset

.
 we will consider 
\begin_inset Formula $\epsilon=0,0.05,0.1.0.2$
\end_inset

 and 
\begin_inset Formula $\delta=0,0.1,0.5$
\end_inset

.
 The contamination rate of 
\begin_inset Formula $0$
\end_inset

 is taken into the analysis in order to have a baseline we can compare with,
 while the other choices of 
\begin_inset Formula $\epsilon$
\end_inset

 and 
\begin_inset Formula $\delta$
\end_inset

 are sort of arbitrary.
 It should be clear that too large values of 
\begin_inset Formula $\epsilon$
\end_inset

, for instance 
\begin_inset Formula $\epsilon\approx0.5$
\end_inset

, aren't worth studying, especially with the breakdown point of Manski‚Äôs
 estimator in mind.
 We settle on 
\begin_inset Formula $\epsilon=0.4$
\end_inset

 and expect things to go wrong.
 We let 
\begin_inset Formula $n=800$
\end_inset

, typical of mid-large scale logistic setup.
 Also, the replication count is 
\begin_inset Formula $N=10,000$
\end_inset

, which might be too small to catch all that is happening.
 Nonetheless, the results, reported in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Robust table"

\end_inset

, are illustrating.
 Not surprisingly, things go out of control with 
\begin_inset Formula $\epsilon=0.4$
\end_inset

.
 As can be seen, 
\begin_inset Formula $Y$
\end_inset

-contamination alone has little effect on the bias of the logistic regression
 estimator, though the variance increases.
 Hence it is still able to see the signal under these circumstances.
 Since the variance of logit is very much smaller than the base variance
 of Manski's estimator, Manski's estimator has to perform very well on the
 bias side of things in order to out-perform logit MSE-wise.
 Luckily for Manski's estimator, it does better than logit for any combination
 where 
\begin_inset Formula $\epsilon\neq0,0.4$
\end_inset

, which suggests usefulness as a robust estimator in practice.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center

\size scriptsize
\begin_inset Tabular
<lyxtabular version="3" rows="14" columns="9">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<column alignment="right" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Logit
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Manski
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\epsilon$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\delta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
MSE
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Var
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Bias
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
MSE
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Var
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Bias
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\frac{MSE_{l}}{MSE_{m}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00897
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00846
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.02259
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04385
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04274
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03338
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.20450 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.24801
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01529
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.48242
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04568
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04523
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02114
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
5.42964
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.7396
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00031
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.85982
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.1101
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.09839
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.10823
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
6.71742
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02095
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01681
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.06438
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06347
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06165
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04271
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.33009
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.02071
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00132
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.00964
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.05438
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.05267
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04135
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
18.7709
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.82658
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00032
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.90899
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.07552
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.0748
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.02681
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
10.9453
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.04433
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.03462
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.09857
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.11281
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.10869
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.06418
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.393
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.09034
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00191
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.04328
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.08905
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.08604
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.05483
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
12.2446
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.90703
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00045
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.95214
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.09005
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.08983
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01485
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
10.0723 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
456.735
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
456.731
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.07046
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
443725
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
443629
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
9.81226
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00103
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
290.959
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
288.945
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.41915
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1068.18
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1068.15
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.16433
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.27239
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $0.5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
18.2414
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
16.6176
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.27425
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.62646
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.01987
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.26751
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
11.2154
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Robust table"

\end_inset

Mean square errors, variances and biases for contaminated data.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Chapter
\begin_inset CommandInset label
LatexCommand label
name "chap:histograms"

\end_inset

Density estimation on the unit interval
\end_layout

\begin_layout Quote
\noindent
\align right
The continuous differentiable function is losing its preeminence as a paradigm
 of knowledge and prediction.
 
\end_layout

\begin_layout Quote
\noindent
\align right
- Jean-Fran√ßois Lyotard in 
\emph on
The Postmodern Condition
\end_layout

\begin_layout Standard
As per Lyotard's dictum, we study density estimation on the unit interval
 by means of step functions.
 The object of our attention is the
\emph on
 irregular histogram
\emph default
, the main worked-out example of cube root asymptotics in this thesis.
 The study of this histogram is easiest when restricted to the unit interval,
 whence the name of this chapter.
 We start out by discussing the important class of density estimators known
 as 
\emph on
kernel density estimators
\emph default
 (KDEs), with special focus on the 
\emph on
Gaussian copula KDE
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "jones2007miscellanea"

\end_inset

.
 In Section 2 we define a rather large class of histogram estimators defined
 through the minimisation of statistical divergences.
 Our focus will be on the Kullback-Leibler divergence, and the 
\begin_inset Formula $L_{2}$
\end_inset

-divergence will also have a role to play.
 Section 3 is a tiny one, being entirely about regular histograms.
 Section 4 is devoted to the question of 
\begin_inset Formula $L_{1}$
\end_inset

-consistency of the histograms.
 In Section 5, the longest section of this thesis, we will prove consistency
 of the irregular histograms introduced in Section 2, under certain conditions,
 using the theory developed in Chapter 2.
 In particular we will make use of a 
\begin_inset Formula $\delta>0$
\end_inset

 in order to uniformly bound the maximised objective function.
 We will also use the rate theorem in order to establish the cube root rate
 of convergence for the split points and weights of these histograms.
 In Section 6 we discuss algorithms for the computation of irregular histograms
 given some data 
\begin_inset Formula $x_{1},x_{2},...,x_{n}$
\end_inset

.
 As was the case with Manski's estimator, the usual tools of gradient descent
 will not be available, and we will be forced to find other ways to deal
 with the problem.
 In the process, we show that the histograms are computable in 
\begin_inset Formula $O(n^{2}k)$
\end_inset

 time.
 In Section 7 we describe a frequent anomaly encountered when using these
 histograms, and a potential remedy.
 The penultimate section is devoted to an illustration of the histogram
 on some examples of real data, including an application of the subsampling
 bootstrap in order to get confidence intervals for the split points.
 Finally, the last section is devoted to the description and investigation
 of the 
\emph on
CIC 
\emph default
(Hjort in 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 33"
key "hjortCIC"

\end_inset

)
\emph on
, 
\emph default
a generalisation of AIC to the setting of irregular histograms.
 It turns out that the bias term is difficult to estimate, but a subsampling
 approach appears to work fine.
 
\end_layout

\begin_layout Section
Kernel density estimators
\begin_inset CommandInset label
LatexCommand label
name "sec:Kernel-density-estimators"

\end_inset


\end_layout

\begin_layout Subsection
Introduction
\end_layout

\begin_layout Standard
An important class of non-parametric density estimators are the kernel density
 estimators (KDEs), which we now describe.
 Let 
\begin_inset Formula $X_{1},\ldots,X_{n}\sim F$
\end_inset

, where 
\begin_inset Formula $F$
\end_inset

 has a strictly positive smooth density 
\begin_inset Formula $f$
\end_inset

 on 
\begin_inset Formula $\mathbb{R}$
\end_inset

.
 Let 
\begin_inset Formula $K$
\end_inset

 be a function which is symmetric around 
\begin_inset Formula $0$
\end_inset

 and positive.
 The kernel density estimate of 
\begin_inset Formula $f$
\end_inset

 is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\widehat{f}(x)=\frac{1}{n}\sum_{i=1}^{n}\frac{1}{h}K\left(\frac{x-X_{i}}{h}\right),
\]

\end_inset

where 
\begin_inset Formula $h$
\end_inset

 is the (data dependent) bandwidth.
 Choices for 
\begin_inset Formula $K$
\end_inset

 include any density function symmetric around 
\begin_inset Formula $0$
\end_inset

, e.g the standard normal distribution, the Epanechnikov kernel and the tricube
 kernel 
\begin_inset CommandInset citation
LatexCommand citep
after "chapter 6.1"
key "hastie2005elements"

\end_inset

.
 As it turns out, in the present setting of strictly positive smooth densities
 on 
\begin_inset Formula $\mathbb{R}$
\end_inset

, the choice of kernel is unimportant 
\begin_inset CommandInset citation
LatexCommand cite
after "p. 28"
key "wand1994kernel"

\end_inset

.
 Note that 
\begin_inset Formula $\widehat{f}$
\end_inset

 is a density of an actual random variable, namely 
\begin_inset Formula $\sum_{i=1}^{n}\xi_{i}\frac{1}{h}K(\frac{x-X_{i}}{h})$
\end_inset

, where 
\begin_inset Formula $\xi$
\end_inset

 is a multinomial vector with equal cell probabilities.
 This makes it very easy to do Monte Carlo simulations, which can be of
 interest in pre-smoothing and the smoothed bootstrap.
\end_layout

\begin_layout Standard
Under 
\emph on
no
\emph default
 conditions on 
\begin_inset Formula $f$
\end_inset

, the kernel density estimator is 
\begin_inset Formula $L_{1}$
\end_inset

-consistent whenever 
\begin_inset Formula $nh\to\infty$
\end_inset

 as 
\begin_inset Formula $h\to0$
\end_inset

, provided the kernel 
\begin_inset Formula $K$
\end_inset

 has integral 
\begin_inset Formula $1$
\end_inset

 and is everywhere positive 
\begin_inset CommandInset citation
LatexCommand citet
after "chapter 3, theorem 1"
key "devroye1985nonparametric"

\end_inset

.
 We will discuss this concept in the context of histograms in Section 4.4.
 A widely used criterion for selecting the bandwidth is to minimise the
 
\emph on
integrated mean squared error
\emph default
, that is 
\begin_inset Formula $\int E(f(x)-\widehat{f}(x))^{2}dx$
\end_inset

.
 As usual, the mean squared error is used mainly due its mathematical tractabili
ty, and the interpretation is simple enough.
 By Fubini's theorem it equals 
\begin_inset Formula $E\int(f(x)-\hat{f}(x))dx$
\end_inset

, which gives rise to its acronym, MISE (mean integrated squared error).
 Note that 
\begin_inset Formula $\hat{f}$
\end_inset

 is a random function, hence 
\begin_inset Formula $\widehat{f}(x)$
\end_inset

 is the random variable we're taking expectations with regards to.
 From a given criterion, like the MISE or pointwise MSE, the optimal bandwidth
 is the bandwidth 
\begin_inset Formula $h_{n}$
\end_inset

 which minimises the criterion.
 For these criteria (which are the ones we will consider), the optimal bandwidth
 can be understood as making a balanced trade-off between variance and bias.
 Through asymptotics and straightforward calculations we find that the optimal
 bandwidth has order 
\begin_inset Formula $n^{-\frac{1}{5}}$
\end_inset


\begin_inset CommandInset citation
LatexCommand citep
after "p. 28"
key "wand1994kernel"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
h_{n}=n^{-\frac{1}{5}}\left[\frac{\int K(x)^{2}dx}{(\int x^{2}K(x)dx)^{2}\int(f''(x))^{2}dx}\right]^{\frac{1}{5}}.\label{eq:Optimal bandwidth in KDEs. General.}
\end{equation}

\end_inset

Let 
\begin_inset Formula $K$
\end_inset

 be the standard normal density.
 If we approximate 
\begin_inset Formula $f$
\end_inset

 by a normal density and let 
\begin_inset Formula $\widehat{\sigma}$
\end_inset

 be a consistent estimator of 
\begin_inset Formula $\sigma$
\end_inset

, we get the ready to use formula 
\begin_inset CommandInset citation
LatexCommand cite
after "p. 47"
key "silverman1986density"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
h_{n}=1.059\widehat{\sigma}n^{-\frac{1}{5}},
\]

\end_inset

this is the
\emph on
 normal reference rule
\emph default
 for bandwidth selection.
\end_layout

\begin_layout Standard
Several methods are used to compare different density estimation procedures,
 where by procedure we understand a method which does everything automatically,
 including the selection of a bandwidth.
 An example of such a procedure is the normal reference rule for KDEs with
 Gaussian kernels.
 Perhaps the most prominent method of comparison is the use of 
\begin_inset Formula $L_{2}$
\end_inset

-distances and Hellinger distances, obtained through simulations on a suitable
 selection of prototype densities.
 
\end_layout

\begin_layout Standard
As it turns out, this sort of density estimator is not appropriate when
 studying densities on the unit interval.
 Assume our density looks like the one in the plot: It has high density
 close to the boundary at 
\begin_inset Formula $0$
\end_inset

.
 Since there is no data to the left of 
\begin_inset Formula $0$
\end_inset

, 
\begin_inset Formula $\widehat{f}(x)$
\end_inset

 will tend to underestimate 
\begin_inset Formula $f(x)$
\end_inset

 whenever 
\begin_inset Formula $x$
\end_inset

 is close to 
\begin_inset Formula $0$
\end_inset

, while assigning positive mass to the 
\begin_inset Quotes eld
\end_inset

forbidden region
\begin_inset Quotes erd
\end_inset

 to the left of 
\begin_inset Formula $0$
\end_inset

.
 This phenomenon is called 
\emph on
boundary bias 
\emph default
and is explained further in 
\begin_inset CommandInset citation
LatexCommand cite
after "chap. 6"
key "hastie2005elements"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/boundary_bias.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Illustration of boundary bias.
 
\begin_inset Formula $100$
\end_inset

 observations were drawn from 
\begin_inset Formula $\beta(2,7)$
\end_inset

.
 The blue curve is the true density, while the red curve is a kernel density
 estimate using the normal reference rule.
 The green curve is the Gaussian copula kernel estimate described below.
\end_layout

\end_inset


\end_layout

\end_inset

There are many methods designed to deal with the boundary bias issue, for
 a brief review see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "chen1999beta"

\end_inset

.
 we will describe a few, with speciel emphasis on the Gaussian copula density
 estimator.
\end_layout

\begin_layout Paragraph
Beta kernels
\end_layout

\begin_layout Standard
Seemingly, the source of boundary bias is that symmetric kernels can't take
 into account that there exists regions with no data whatsoever.
 A reasonable solution is to use a semi-flexible non-symmetric kernel which
 continuously manipulates the support.
 Chen's 
\begin_inset CommandInset citation
LatexCommand cite
key "chen1999beta"

\end_inset

 proposal is to use,
\begin_inset Formula 
\[
\widehat{f}(x)=\frac{1}{n}\sum_{i=1}^{n}K_{x/b+1,(1-x)/b+1}(X_{i}),
\]

\end_inset

where 
\begin_inset Formula $K_{a,b}$
\end_inset

 is the Beta density with shape parameters 
\begin_inset Formula $a,b$
\end_inset

.
 This is not a bona fide density, however, for 
\begin_inset Formula $x$
\end_inset

 appears as a 
\emph on
parameter
\emph default
 in the Beta-density, not as an argument.
 This makes the estimator difficult to interpret and to sample from.
 
\begin_inset CommandInset citation
LatexCommand cite
key "jones2007web"

\end_inset

 explored the possibility of switching these roles.
 Also, 
\begin_inset CommandInset citation
LatexCommand citet
key "chen1999beta"

\end_inset

 proposes a superior bias-corrected version, which has proven to be quite
 popular and exhibits good performance.
\end_layout

\begin_layout Paragraph
Probit-transformed local likelihood
\end_layout

\begin_layout Standard
Through any quantile function for a strictly positive density on 
\begin_inset Formula $\mathbb{R}$
\end_inset

, we can transform data from 
\begin_inset Formula $[0,1]$
\end_inset

 to 
\begin_inset Formula $\mathbb{R}$
\end_inset

, apply an ordinary kernel density estimator there, and back-transform the
 results.
 A downside is that this method can induce serious bias unless care is taken.
 
\begin_inset CommandInset citation
LatexCommand cite
key "geenens2014probit"

\end_inset

 proposal is to use the probit transform in this manner, but instead of
 using an ordinary kernel density estimator, he uses a local likelihood
 approach, which is known to reduce bias 
\begin_inset CommandInset citation
LatexCommand citep
key "hjort1996locally"

\end_inset

.
 This estimate is neither a bona fide density or easy to sample from, but
 has superior performance.
\end_layout

\begin_layout Subsection
Gaussian copula kernels
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand cite
key "jones2007miscellanea"

\end_inset

 proposed an elegant modification of the beta kernel approach.
 The idea is to use the conditionals of a bivariate Gaussian copula as kernels.
 The bivariate Gaussian copula is a random variable of one parameter 
\begin_inset Formula $\rho$
\end_inset

, defined in the following manner: Let 
\begin_inset Formula $(Z_{1},Z_{2})\sim N_{2}(0,\Sigma)$
\end_inset

, with 
\begin_inset Formula $\Sigma=\left[\begin{array}{cc}
1 & \rho\\
\rho & 1
\end{array}\right],$
\end_inset

 and put 
\begin_inset Formula $(X_{1},X_{2})=(\Phi(Z_{1}),\Phi(Z_{2}))$
\end_inset

.
 Its density is given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
c(x_{1},x_{2};\rho)=\frac{1}{\sqrt{1-\rho^{2}}}\exp\left(-\frac{\left[\rho^{2}(\Phi^{-1}(x_{1})^{2}-2\rho\Phi^{-1}(x_{1})\Phi^{-1}(x_{2})+\rho^{2}(\Phi^{-1}(x_{2}))^{2}\right]}{2(1-\rho^{2})}\right).
\]

\end_inset

The basic feature of a copula is that the marginals are uniform, but the
 conditionals can be very rich.
 
\end_layout

\begin_layout Definition
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Gaussian copula kernel density estimator
\end_layout

\end_inset

Let 
\begin_inset Formula $\left\{ X_{i}\right\} _{i=1}^{n}\stackrel{i.i.d.}{\sim}f$
\end_inset

 for some density 
\begin_inset Formula $f:[0,1]\to\mathbb{R}$
\end_inset

, 
\begin_inset Formula $\left\{ Y_{i}\right\} _{i=1}^{n}$
\end_inset

 be independent Gaussian copulas, and 
\begin_inset Formula $h=\sqrt{1-\rho}$
\end_inset

 be a (data driven) bandwidth.
 The Gaussian copula kernel estimator is the mixture 
\begin_inset Formula $\sum_{i=1}^{n}\xi_{i}\left[Y_{i}|y_{2}=X_{i}\right]$
\end_inset

, where 
\begin_inset Formula $\xi=(\xi_{1},\xi_{2},...,\xi_{n})$
\end_inset

 is a multinomial vector with equal cell probabilities.
 This variable has density
\end_layout

\begin_layout Definition
\begin_inset Formula 
\[
\widehat{f}(x)=\frac{1}{n}\sum_{i=1}^{n}c(x,X_{i};1-h^{2}).
\]

\end_inset


\end_layout

\begin_layout Standard
For use in pre-smoothing of histograms (Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Presmoothing-and-instability"

\end_inset

), we will need to sample from this estimator.
 As a first step, we must sample from the conditional distribution 
\begin_inset Formula $c(x_{1}\mid X_{2};\rho)$
\end_inset

.
 Recall the formulas for the conditional mean and variance in a bivariate
 normal 
\begin_inset Formula $(Z_{1},Z_{2})$
\end_inset

,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\mu_{1}|Z_{2} & = & \mu_{1}+\frac{\rho}{\sigma_{2}^{2}}(Z_{2}-\mu_{2}),\\
\sigma_{1}^{2}|Z_{2} & = & \sigma_{1}^{2}-\frac{\rho^{2}}{\sigma_{2}^{2}},
\end{eqnarray*}

\end_inset

which in our setting translates to 
\begin_inset Formula $\mu|Z_{2}=\rho Z_{2}$
\end_inset

 and 
\begin_inset Formula $\sigma^{2}|Z_{2}=1-\rho^{2}$
\end_inset

.
 Using these formulas together with the fact that the conditional distributions
 are normal, we sample from 
\begin_inset Formula $Z_{X_{2}}\sim N(\rho\Phi^{-1}(X_{2}),1-\rho^{2})$
\end_inset

 and apply 
\begin_inset Formula $\Phi$
\end_inset

, so that 
\begin_inset Formula $X_{1}|X_{2}\sim\Phi(Z_{X_{2}})$
\end_inset

.
 It is now straight forward to sample from the Gaussian copula density estimator.
 
\end_layout

\begin_layout Standard
The Gaussian copula KDE has several nice features,
\end_layout

\begin_layout Enumerate
It results in a bona fide density,
\end_layout

\begin_layout Enumerate
it is easy to interpret and fast to calculate,
\end_layout

\begin_layout Enumerate
easy to sample from,
\end_layout

\begin_layout Enumerate
has good Hellinger and MISE performance in many different settings.
\end_layout

\begin_layout Standard
In this thesis we will use this density estimator whenever nothing else
 in mentioned, together with a normal reference rule, giving the bandwidth
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
h=\widehat{\sigma}(2\widehat{\mu}^{2}\widehat{\sigma}^{2}+3(1-\widehat{\sigma}^{2}))^{-\frac{1}{5}}n^{-\frac{1}{5}},
\]

\end_inset

where 
\begin_inset Formula $\widehat{\sigma},$
\end_inset

 
\begin_inset Formula $\widehat{\mu}$
\end_inset

 are the maximum likelihood estimates of the probit-transformed data (see
 
\begin_inset CommandInset citation
LatexCommand citet
key "jones2007web"

\end_inset

).
 A natural extension of the Gaussian copula KDE to the realm of derivatives
 is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\widehat{f'}(x;h)=\frac{1}{n}\sum_{i=1}^{n}\frac{d}{dx}c(x,X_{i};1-h^{2}).
\]

\end_inset

Here the optimal rate for the bandwidth has been reduced from 
\begin_inset Formula $n^{-\frac{1}{5}}$
\end_inset

 to 
\begin_inset Formula $n^{-\frac{1}{7}}$
\end_inset

.
 This is not surprising, as there is seemingly a larger inherent difficulty
 involved in the estimating derivatives 
\emph on
vis-√†-vis
\emph default
 estimating the density.
 This manifests itself through a much larger pointwise variance as a function
 of 
\begin_inset Formula $h$
\end_inset

.
 The rate 
\begin_inset Formula $n^{-\frac{1}{7}}$
\end_inset

 is conjectured from a result on ordinary kernel density estimators, see
 
\begin_inset CommandInset citation
LatexCommand citealt
after "section 2.12"
key "wand1994kernel"

\end_inset

.
\end_layout

\begin_layout Section
General histograms
\end_layout

\begin_layout Standard
A general histogram on 
\begin_inset Formula $[0,1]$
\end_inset

 is a density of the form
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
h(x)=\sum_{i=1}^{k}\frac{w_{i}}{a_{i}-a_{i-1}}1_{[a_{i-1},a_{i})}(x),\label{eq:general_histogram}
\end{equation}

\end_inset

where 
\begin_inset Formula $a_{0}=0$
\end_inset

, 
\begin_inset Formula $a_{k}=1$
\end_inset

, 
\begin_inset Formula $a_{i}<a_{i+1}$
\end_inset

 for each 
\begin_inset Formula $i$
\end_inset

, and 
\begin_inset Formula $w_{i}<0$
\end_inset

 are weights summing to one; that is, 
\begin_inset Formula $\sum_{i=1}^{k}w_{i}=1$
\end_inset

.
 Let 
\begin_inset Formula $\mathcal{F}$
\end_inset

 be a suitable class of densities on the unit interval.
 The exact nature of 
\begin_inset Formula $\mathcal{F}$
\end_inset

 will vary from problem to problem, and isn't very important right now.
 Later on, when we derive our limiting distributions, the exact nature of
 
\begin_inset Formula $\mathcal{F}$
\end_inset

 
\emph on
is 
\emph default
important --- it contains only smooth densities and no densities with the
 shape of a histogram.
 Whenever we have a 
\begin_inset Formula $P\in\mathcal{F}$
\end_inset

, with associated density 
\begin_inset Formula $f$
\end_inset

, we can define its 
\emph on
best approximating histogram
\emph default
 through the minimisation of statistical divergences, which we will also
 call statistical distances.
 A statistical divergence is defined as follows: Let 
\begin_inset Formula $\mathcal{P}$
\end_inset

 be space of probability measures with common support.
 If 
\begin_inset Formula $d:\mathcal{P}^{2}\to\mathbb{R}$
\end_inset

 is a function such that 
\begin_inset Formula $d(f,g)\geq0$
\end_inset

 for any 
\begin_inset Formula $f,g\in\mathcal{P}$
\end_inset

 and 
\begin_inset Formula $d(f,g)=0$
\end_inset

 iff 
\begin_inset Formula $f=g$
\end_inset

.
 
\end_layout

\begin_layout Standard
We will consider two divergences:
\end_layout

\begin_layout Paragraph*
1.) Kullback-Leibler divergence.
 
\end_layout

\begin_layout Standard
The quantity is defined as 
\begin_inset Formula $d_{KL}(f,h)=\int f(x)\log\frac{f(x)}{h(x)}dx$
\end_inset

.
 In ordinary parametric statistics, minimising this distance is equivalent
 to finding the maximum likelihood estimate.
 It is an information theoretic distance, and is difficult to understand
 visually.
 Accordingly, it can be argued that it is inappropriate for histograms.
 As we will see, it is equivalent to 
\begin_inset Formula $L_{2}$
\end_inset

-minimisation in regular histograms, and it is asymptotically equivalent
 to the minimisation of the Hellinger distance, which is more easily interpretab
le visually, and is arguably more adequate than the 
\begin_inset Formula $L_{2}$
\end_inset

-distance.
 The minimisation of the Kullback-Leibler divergence is equivalent to the
 maximisation of 
\begin_inset Formula $\int f(x)\log h(x)dx=P\log h$
\end_inset

.
 Since 
\begin_inset Formula $h(x)=\sum_{i=1}^{k}\frac{w_{i}}{a_{i-1}-a}1_{[a_{i-1},a_{i})}(x)$
\end_inset

, we get the criterion function 
\begin_inset Formula 
\begin{equation}
m_{(a,w)}^{KL}=\sum_{i=1}^{k}\log\frac{w_{i}}{a_{i}-a_{i-1}}1_{[a_{i-1},a_{i})}(x),\label{eq:KL objective}
\end{equation}

\end_inset

and the desired argmax objective
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Pm_{(a,w)}^{KL}=\sum_{i=1}^{k}\log\frac{w_{i}}{a_{i}-a_{i-1}}P[a_{i-1},a_{i}).
\]

\end_inset


\end_layout

\begin_layout Paragraph*
2.) 
\begin_inset Formula $L_{2}$
\end_inset

-distance.
 
\end_layout

\begin_layout Standard
This is the ordinary 
\begin_inset Formula $L_{2}$
\end_inset

-norm, defined by 
\begin_inset Formula $\int(f(x)-h(x))^{2}dx=\int f(x)^{2}dx-2\int f(x)h(x)+\int h(x)^{2}dx$
\end_inset

.
 This is a classical distance measure which is easy to interpret, but it
 weights small distances too little.
 For histograms, to minimise the expression above is equivalent to the maximisat
ion of 
\begin_inset Formula 
\[
Pm_{(a,w)}^{L_{2}}=\sum_{i=1}^{k}w_{i}\frac{(2P[a_{i-1},a_{i})-w_{i})}{a_{i}-a_{i-1}},
\]

\end_inset

with underlying criterion function 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
m_{(a,w)}^{L_{2}}=\sum_{i=1}^{k}\left[\frac{2w_{i}}{a_{i}-a_{i-1}}1_{[a_{i-1},a_{i})}(x)-\frac{w_{i}^{2}}{a_{i}-a_{i-1}}\right],\label{eq:L2 objective}
\end{equation}

\end_inset

as can be seen by straight forward calculations.
 We require the assumption 
\begin_inset Formula $f\in L_{2}$
\end_inset

 for this to work.
\end_layout

\begin_layout Paragraph*
Special mention: The Hellinger distance.
 
\end_layout

\begin_layout Standard
The Hellinger distance is defined by 
\begin_inset Formula $d(f,h)=\frac{1}{2}\int(\sqrt{f(x)}-\sqrt{h(x)})^{2}dx$
\end_inset

, which behaves asymptotically like Kullback-Leibler.
 Compared to the Kullback-Leibler divergence, it has the nice property of
 being an actual metric, and it is easier to understand visually.
 When taking roots, values below one are pushed upwards, and values above
 one are pushed downwards.
 This makes the distance perhaps more appropriate for histograms than 
\begin_inset Formula $L_{2}$
\end_inset

, which weight differences when densities are high more than differences
 when densities are small.
 To minimise the Hellinger distance is equivalent to maximising
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\sum_{i=1}^{k}\sqrt{\frac{w_{i}}{a_{i}-a_{i-1}}}\int_{a_{i-1}}^{a_{i}}\sqrt{f(x)}dx,
\]

\end_inset

which requires an estimate 
\begin_inset Formula $\hat{f}(x)$
\end_inset

 of 
\begin_inset Formula $f(x)$
\end_inset

, for instance a Gaussian copula kernel density estimate.
 However, this is hardly an argument against the use of the Hellinger distance,
 as it is convenient to use kernel density estimates for all sorts of histograms.
\end_layout

\begin_layout Paragraph*
Kinds of histograms.
\end_layout

\begin_layout Standard
Given a statistical distance, we can define three forms of histograms.
 Their forms are decided by which quantities we allow to vary and which
 we force to be constant.
 
\emph on
Regular histogram
\emph default
 are histograms with a fixed bin width and variable weight, which in this
 case equals height times the bin width.
 These are the objects we usually associate with histograms.
 
\emph on
Irregular histograms 
\emph default
are usually understood as histograms with variable bin width and variable
 weight, but we will also consider irregular histograms with fixed weight
 and variable bin width.
 We will sometimes call these irregular histograms 
\emph on
quantile histograms.
 
\emph default
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Kinds of histograms"

\end_inset

 illustrates the main graphical differences between these three kinds of
 histograms, and Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Pros-and-cons"

\end_inset

 compares gives a summary of their pros and cons.
 In Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Presmoothing-and-instability"

\end_inset

 we do a small simulation study comparing their MISEs and Hellinger distances.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Plots/Kindsofhistograms.pdf
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Kinds of histograms"

\end_inset

Three different best approximating histograms and one 
\begin_inset Formula $k$
\end_inset

-spacing estimator with 
\begin_inset Formula $k=10$
\end_inset

 and underlying distribution 
\begin_inset Formula $\beta(9,5)$
\end_inset

 (upper left) Irregular histogram obtained from KL, (upper right) quantile
 histogram (KL), (lower left) regular histogram, (lower right) the 
\begin_inset Formula $k$
\end_inset

-spacing estimator described in the next section.
 Notice the following about the quantile histogram: Since it cannot flexibly
 manipulate the height of the left-most bar, it has been forced to become
 too tall.
 The same goes for the the middle section, since it cannot manipulate the
 weights, it is forced to underestimate the density, even tough it approximates
 its shape quite well.
 The same mechanism forces the bin widths to be small around the high regions,
 explaining the difference between its looks and that of the irregular histogram
s to its left.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features rotate="0" tabularvalignment="middle">
<column alignment="left" valignment="top" width="10text%">
<column alignment="left" valignment="top" width="40text%">
<column alignment="left" valignment="top" width="40text%">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pros
\begin_inset VSpace defskip
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cons
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Regular
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Well known and easy to interpret.
 
\begin_inset Formula $L_{2}$
\end_inset

 and 
\begin_inset Formula $KL$
\end_inset

 histograms are equivalent, and so is the usual histogram construction.
 It has smaller variance than the other histogram procedures.
 The limiting distribution of the weights is multivariate normal, and converges
 with the rate 
\begin_inset Formula $n^{\frac{1}{2}}$
\end_inset

.
\begin_inset VSpace defskip
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
They fail to capture the structure of the data well when there are few bins
 and relatively large sections of small density, which leads to bias.
 If a bin contains 
\begin_inset Formula $0$
\end_inset

 observations, 
\begin_inset Formula $d_{KL}(f,h)=\infty$
\end_inset

 under the assumption that 
\begin_inset Formula $f$
\end_inset

 is everywhere non-zero.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Irregular
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Is a classical histogram in the sense that each bin has weight corresponding
 to the amount of observations in it.
 Can match any histogram-shaped density exactly.
 Has smaller bias than the other forms.
\end_layout

\begin_layout Plain Layout
\begin_inset VSpace defskip
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
It is costly to construct, yields unstable estimates and converges at a
 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

-rate.
 Every bin will contain at least one observation.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Quantile
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Each 
\begin_inset Formula $a_{i}$
\end_inset

 corresponds to the 
\begin_inset Formula $\frac{i}{k}$
\end_inset

th quantile of distribution 
\begin_inset Formula $h(x)$
\end_inset

 defined by the histogram.
 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
It is costly to construct, yields unstable estimates and converges at a
 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

-rate.
 It is difficult to interpret.
 Also, it can be seriously biased upwards in sections of small density,
 often giving a wrong impression of the data.
 The same kind bias also occurs in sections of high density.
 (See figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Kinds of histograms"

\end_inset

).
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Pros-and-cons"

\end_inset

Pros and cons of the different kinds of histograms.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Proposition
For regular histograms, minimisation of 
\begin_inset Formula $L_{2}$
\end_inset

 and Kullback-Leibler divergences are equivalent.
\end_layout

\begin_layout Proof
(
\begin_inset Formula $L_{2}$
\end_inset

) Recall that the objective function for minimisation is 
\begin_inset Formula 
\[
f(w)=-2\sum_{i=1}^{k}P(a_{i-1},a_{i})w_{i}+\sum_{i=1}^{k}w_{i}^{2},
\]

\end_inset

where 
\begin_inset Formula $a_{0}=0$
\end_inset

, 
\begin_inset Formula $a_{k}=1$
\end_inset

, together with the constraint 
\begin_inset Formula $\sum_{i=1}^{k}w_{i}=1$
\end_inset

 and 
\begin_inset Formula $w_{i}\geq0$
\end_inset

 for all 
\begin_inset Formula $i$
\end_inset

.
 Using Lagrange multipliers, with constraint 
\begin_inset Formula $g=\sum_{i=1}^{k}w_{i}=1,$
\end_inset

 we find that 
\begin_inset Formula $\frac{\partial(f+g)(w)}{\partial w_{i}}=-2P(a_{i-1},a_{i})+2w_{i}+\lambda$
\end_inset

.
 Leave 
\begin_inset Formula $\lambda$
\end_inset

 alone on the right hand side and sum over 
\begin_inset Formula $i$
\end_inset

 to get 
\begin_inset Formula $\lambda=0$
\end_inset

, which yields the unique solution 
\begin_inset Formula $w_{i}=P(a_{i-1},a_{i})$
\end_inset

.
 Note that the constraint 
\begin_inset Formula $w_{i}\geq0$
\end_inset

 is automatically fulfilled.
 As for Kullback-Leibler, we use the same method on 
\begin_inset Formula $f(w)=\sum_{i=1}^{k}P(a_{i-1},a_{i})\log w_{i}$
\end_inset

 to get 
\begin_inset Formula $\frac{\partial(f+g)(w)}{\partial w_{i}}=P(a_{i-1},a_{i})\frac{1}{w_{i}}+\lambda$
\end_inset

, which gives 
\begin_inset Formula $\lambda=-1$
\end_inset

 and the maximum 
\begin_inset Formula $w_{i}=P(a_{i-1},a_{i})$
\end_inset

.
\end_layout

\begin_layout Standard
By using the finite sample analogue 
\begin_inset Formula $P_{n}(a_{i-1},a_{i})$
\end_inset

 for 
\begin_inset Formula $P(a_{i-1},a_{i})$
\end_inset

, we see that both the 
\begin_inset Formula $L_{2}$
\end_inset

 and 
\begin_inset Formula $KL$
\end_inset

 regular histograms correspond to the ordinary regular histograms we know
 from elementary school.
 The following corollary tells us that 
\begin_inset Formula $KL$
\end_inset

 and 
\begin_inset Formula $L_{2}$
\end_inset

 irregular histograms (with variable weights) are histograms as we know
 them.
 
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "prop:Good histograms"

\end_inset

Let 
\begin_inset Formula $P$
\end_inset

 be a probability measure on 
\begin_inset Formula $[0,1]$
\end_inset

.
 The optimal weights for both the 
\begin_inset Formula $L_{2}$
\end_inset

 and 
\begin_inset Formula $KL$
\end_inset

 irregular histograms are 
\begin_inset Formula $P([a_{i-1},a_{i}))$
\end_inset

, where 
\begin_inset Formula $a_{i}$
\end_inset

 are the optimal split points.
\end_layout

\begin_layout Proof
Given the split points, the problem reduces to that of the previous proposition.
\end_layout

\begin_layout Standard
We call this, colloquially, the 
\begin_inset Quotes eld
\end_inset

good histogram property
\begin_inset Quotes erd
\end_inset

.
 In addition to making the resulting histograms correspond to ordinary histogram
s as we know them, the property effectively reduces the dimension of the
 objective function.
\end_layout

\begin_layout Standard
Now that we have defined the best approximating histogram for the underlying
 distribution 
\begin_inset Formula $F$
\end_inset

, we will discuss their estimation.
 This estimation is carried out by using the 
\begin_inset Quotes eld
\end_inset

plug in estimator
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $P_{n}$
\end_inset

 in place of 
\begin_inset Formula $P$
\end_inset

.
 Thus
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
(\widehat{a},\widehat{w})=\argmax_{(a,w)}P_{n}m_{(a,w)},
\]

\end_inset

where 
\begin_inset Formula $m_{(a,w)}=m_{(a,w)}^{L_{2}}$
\end_inset

 if we want to minimise the 
\begin_inset Formula $L_{2}$
\end_inset

 distance, and 
\begin_inset Formula $m_{(a,w)}=m_{(a,w)}^{KL}$
\end_inset

 for Kullback-Leibler.
 For ease of exposition, we always include both 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $w$
\end_inset

 in the arguments of 
\begin_inset Formula $m$
\end_inset

, even tough we are allowed to pre-specify their values, a choice that hopefully
 will not cause confusion.
 Note that this is the setting of 
\begin_inset Formula $M$
\end_inset

-estimation, discussed Section 2.2.
 
\end_layout

\begin_layout Standard
Other divergences that might be considered are the BHHJ divergences 
\begin_inset CommandInset citation
LatexCommand cite
key "basu1998robust"

\end_inset

, a parametrized family of divergences defined by 
\begin_inset Formula 
\[
d_{\alpha}(f,g)=\int\left[f^{1+\alpha}(z)-(1+\frac{1}{\alpha})g(z)f^{\alpha}(z)+\frac{1}{\alpha}g^{1+\alpha}(z)\right]dz
\]

\end_inset

for 
\begin_inset Formula $\alpha>0$
\end_inset

 and 
\begin_inset Formula $d_{0}(f,g)=d_{KL}(f,g)$
\end_inset

.
 These divergences were developed for outlier robust statistics, and don't
 seem very relevant for the case at hand.
 Nonetheless, they will allow us make a finer trade-off between the features
 of the Kullback-Leibler histograms and 
\begin_inset Formula $L_{2}$
\end_inset

-histograms, and would connect the limiting distributions of these two in
 a unifying manner.
 Still, the rather similar behaviour of the Kullback-Leibler and 
\begin_inset Formula $L_{2}$
\end_inset

-histograms, illustrated in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Presmoothing-and-instability"

\end_inset

, makes it seem like this isn't worth the effort.
 Finally, there are other important distances we have not investigated at
 all, for instance the Kolmogorov distance defined by 
\begin_inset Formula $d_{K}(F,G)=\sup_{x}|F(x)-G(x)|$
\end_inset

, and the 
\begin_inset Formula $L_{1}$
\end_inset

-distance, 
\begin_inset Formula $d_{L_{1}}=\int|f(x)-g(x)|dx$
\end_inset

.
 The Kolmogorov is a global distance measure, and isn't appropriate for
 density estimation.
 While the 
\begin_inset Formula $L_{1}$
\end_inset

-distance is arguably the most appropriate distance measure between densities,
 it is difficult to work with.
 By Scheff√©'s identity (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:L1-consistency"

\end_inset

 on 
\begin_inset Formula $L_{1}$
\end_inset

-consistency), minimising the 
\begin_inset Formula $L_{1}$
\end_inset

 criterion is equivalent to the minimisation of the 
\emph on
total variational distance, 
\begin_inset Formula $d_{TV}(f,g)=\sup_{B\in\mathscr{B}}|\int_{B}f(x)dx-\int_{B}g(x)dx|$
\end_inset

, 
\emph default
where 
\begin_inset Formula $\mathscr{B}$
\end_inset


\emph on
 
\emph default
is the Borel 
\begin_inset Formula $\sigma$
\end_inset

-algebra on 
\begin_inset Formula $[0,1]$
\end_inset

.
 This is particularly attractive, as it minimises the maximal error of 
\begin_inset Formula $|\widehat{P}(A)-P(A)|$
\end_inset

 across 
\emph on
every 
\emph default
measurable set 
\begin_inset Formula $A$
\end_inset

.
 Furthermore, 
\begin_inset CommandInset citation
LatexCommand citealp
after "chapter 6"
key "devroye2012combinatorial"

\end_inset

 argue that both the 
\begin_inset Formula $KL$
\end_inset

- and 
\begin_inset Formula $L_{2}$
\end_inset

-distances are fundamentally inappropriate as criteria for density estimation,
 but their examples of bad properties for these two distances only hold
 for unbounded intervals.
 Nevertheless, minimising 
\begin_inset Formula $d_{TV}(f,g)=\sup_{B\in\mathscr{B}}|\int_{B}f(x)dx-\int_{B}g(x)dx|$
\end_inset

 is likely not amenable to the techniques described in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:M-estimation"

\end_inset

 on M-estimation.
\end_layout

\begin_layout Section
Regular histograms
\end_layout

\begin_layout Standard
Regular histograms are considerably easier to analyse and understand than
 irregular histograms, so they are a convenient starting point for our discussio
n.
 We will also discuss the so-called 
\begin_inset Formula $k$
\end_inset

-spacing estimator 
\begin_inset CommandInset citation
LatexCommand citep
key "lugosi1996consistency"

\end_inset

, a kind of histogram reminiscent of the 
\begin_inset Formula $KL/L_{2}$
\end_inset

-histograms with constant weights.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $k+1$
\end_inset

 be the bin count and 
\begin_inset Formula $a_{i}-a_{i-1}$
\end_inset

 be the predefined bin widths and 
\begin_inset Formula $F$
\end_inset

 be an arbitrary distribution supported on 
\begin_inset Formula $[0,1]$
\end_inset

.
 The estimates of interest are 
\begin_inset Formula 
\[
\widehat{\theta}_{n}=(P_{n}[0,a_{1}),P_{n}[a_{1},a_{2}),...,P_{n}[a_{k},1]).
\]

\end_inset

The vector 
\begin_inset Formula $n\widehat{\theta}_{n}$
\end_inset

 is multinomially distributed with 
\begin_inset Formula $n$
\end_inset

 trials and cell probabilities 
\begin_inset Formula $P(a_{i-1},a_{i})$
\end_inset

.
 Let 
\begin_inset Formula $n\to\infty$
\end_inset

, and 
\begin_inset Formula $\sqrt{n}\widehat{\theta}_{n}$
\end_inset

 can be approximated by the multivariate normal distribution with mean 
\begin_inset Formula $\mu=(P[a_{0},a_{1}),P[a_{1},a_{2}),...,P[a_{k},1])$
\end_inset

 and covariance matrix 
\begin_inset Formula $\Sigma_{ij}=P(a_{i-1},a_{i})P(a_{j-1},a_{j})$
\end_inset

 when 
\begin_inset Formula $i\neq j$
\end_inset

 and 
\begin_inset Formula $\Sigma_{ii}=P(a_{i-1},a_{i})(1-P(a_{i-1},a_{i}))$
\end_inset

 otherwise.
 Hence 
\begin_inset Formula $\sqrt{n}(\widehat{\theta}_{n}-\mu)\tod N_{k}(0,\Sigma)$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $k$
\end_inset

-spacing estimator
\end_layout

\begin_layout Standard
A variant of histograms not yet discussed is the density 
\begin_inset Formula 
\begin{eqnarray*}
h(x) & = & \sum_{i=1}^{k}\frac{k^{-1}}{q_{i}-q_{i-1}}1_{[q_{i-1},q_{i})}(x),\\
 & = & \sum_{i=1}^{k}\frac{P[q_{i-1},q_{i})}{q_{i}-q_{i-1}}1_{[q_{i-1},q_{i})}(x).
\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $q_{i}$
\end_inset

 is the 
\begin_inset Formula $\frac{i}{k}$
\end_inset

th quantile of 
\begin_inset Formula $P$
\end_inset

.
 This histogram is sometimes called the 
\begin_inset Formula $k$
\end_inset

-spacing estimator 
\begin_inset CommandInset citation
LatexCommand citep
key "lugosi1996consistency"

\end_inset

, and was first investigated by 
\begin_inset CommandInset citation
LatexCommand citet
key "van1973histogram"

\end_inset

.
 While it looks similar to our quantile histograms, it is not the result
 of KL or 
\begin_inset Formula $L_{2}$
\end_inset

minimisation of the histogram objective function in equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:general_histogram"

\end_inset

.
 Interestingly, it has constant weights but also satisfies the good histogram
 property, for 
\begin_inset Formula $k^{-1}=P_{n}[q_{i-1},q_{i})$
\end_inset

 by construction.
 Let 
\begin_inset Formula $\widehat{q}_{i}$
\end_inset

 be the 
\begin_inset Formula $\frac{i}{k}$
\end_inset

-th quantile of the empirical distribution 
\begin_inset Formula $P_{n}$
\end_inset

, and define 
\begin_inset Formula $\widehat{h}(x)=\sum_{i=1}^{k}\frac{k^{-1}}{\widehat{q}_{i}-\widehat{q}_{i-1}}1_{[\widehat{q}_{i-1},\widehat{q}_{i})}(x)$
\end_inset

.
 Now we're interested in the limiting distribution of 
\begin_inset Formula $(\widehat{q}_{1},...,\widehat{q}_{k})$
\end_inset

.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:Histograms on quantiles"

\end_inset

Let 
\begin_inset Formula $F$
\end_inset

 be a distribution with density 
\begin_inset Formula $f$
\end_inset

, 
\begin_inset Formula $X_{1},...,X_{n}\stackrel{i.i.d.}{\sim}F$
\end_inset

 and let 
\begin_inset Formula $q=(q_{1},...,q_{k-1}),$
\end_inset

 
\begin_inset Formula $\widehat{q}=(\widehat{q}_{1},...,\widehat{q}_{k-1})$
\end_inset

 be the 
\begin_inset Formula $\frac{i}{k}$
\end_inset

th quantiles and sample quantiles, respectively.
 Then 
\end_layout

\begin_layout Proposition
\begin_inset Formula 
\[
\sqrt{n}(\widehat{q}-q)\tod N(0,\Sigma),
\]

\end_inset

where 
\begin_inset Formula $\Sigma_{ij}=\frac{i(k-j)}{k^{2}f(q_{(j)})f(q_{(i)})}$
\end_inset

 for 
\begin_inset Formula $j\geq i$
\end_inset

.
\end_layout

\begin_layout Standard
A proof is found in e.g.
 
\begin_inset CommandInset citation
LatexCommand citet
after "theorem 2.1"
key "babu1988joint"

\end_inset

.
 We could also use the ideas of Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:M-estimation"

\end_inset

, or more specifically the rate theorem 
\begin_inset CommandInset ref
LatexCommand vref
reference "thm:rate theorem"

\end_inset

 to find the limiting covariance structure and the Hessian 
\begin_inset Formula $V$
\end_inset

.
 In order to put quantile estimation into this, we could use the loss function
\begin_inset Formula 
\[
d_{p}(x,q)=\begin{cases}
(1-p)|x-q| & \textrm{when }x<q,\\
p|x-q| & \textrm{when }x\geq q.
\end{cases}
\]

\end_inset

This function has the property that 
\begin_inset Formula $\argmin_{q}Ed_{p}(X,q)=F^{-1}(p)$
\end_inset

 (see e.g.
 
\begin_inset CommandInset citation
LatexCommand citet
after "p. 21"
key "hao2007quantile"

\end_inset

).
 Thus 
\begin_inset Formula $m_{p}=\sum_{i=1}^{k}d_{p_{i}}(\cdot,q_{i})$
\end_inset

 is a suitable objective function, where 
\begin_inset Formula $p$
\end_inset

 is constrained to be an increasing vector in 
\begin_inset Formula $(0,1)$
\end_inset

.
 Notice that when 
\begin_inset Formula $k=2$
\end_inset

 and 
\begin_inset Formula $p=\frac{1}{2}$
\end_inset

, 
\begin_inset Formula $q$
\end_inset

 is the median.
 The objective function is 
\begin_inset Formula $d_{\frac{1}{2}}(x;q)\propto|x-q|$
\end_inset

, which was used when we established the limiting distribution of the median,
 recall Theorem 
\begin_inset CommandInset ref
LatexCommand vref
reference "thm:median theorem"

\end_inset

.
 It would be interesting to find out whether there is a statistical divergence
 
\begin_inset Formula $d$
\end_inset

 such that 
\begin_inset Formula $\argmax_{q}d(h(x;q,k^{-1}),f(x))$
\end_inset

 equals the 
\begin_inset Formula $k$
\end_inset

-spacing estimate.
\end_layout

\begin_layout Standard
This method can clearly be extended to choices of non-equally spaced quantiles.
 This variant of the quantile histogram is probably better than what we
 obtain through 
\begin_inset Formula $L_{2}$
\end_inset

 and 
\begin_inset Formula $KL$
\end_inset

 minimisation.
 It retains the positive property of quantile histograms, namely that 
\begin_inset Formula $q_{i}$
\end_inset

 corresponds to the 
\begin_inset Formula $i$
\end_inset

th quantile of 
\begin_inset Formula $h(x)$
\end_inset

, but disposes of several negative properties: It doesn't have the unstable
 estimates we soon will describe (in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Presmoothing-and-instability"

\end_inset

), the split points have 
\begin_inset Formula $\sqrt{n}$
\end_inset

-asymptotics, its limiting distribution is normal.
 It is computationally very inexpensive to construct, as finding the 
\begin_inset Formula $k$
\end_inset

 quantiles is done in 
\begin_inset Formula $O(n\log n)$
\end_inset

 time.
 Also, they look roughly the same whenever the 
\begin_inset Formula $L_{2}$
\end_inset

/
\begin_inset Formula $KL$
\end_inset

 histograms have been estimated properly.
 As the main purpose of histograms is visualisation, this is yet another
 point in favour of this variant.
 If the goal of constructing a histogram is compression instead, this approach
 should also be preferable, as the quantiles themselves are very well understood.
 Another point in its favour is the fact that 
\begin_inset Formula $L_{2}/KL$
\end_inset

 quantile histograms can fool us in a subtle way: In figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Kinds of histograms"

\end_inset

, notice that the quantile histograms seem to 
\begin_inset Quotes eld
\end_inset

focus
\begin_inset Quotes erd
\end_inset

 on the region around the mode.
 This makes it seem intuitive that the estimator is more accurate in exactly
 this region.
 But as we can see from the plot, this is not the case.
 The regular quantile histogram doesn't suffer from this defect.
\end_layout

\begin_layout Section
\begin_inset Formula $L_{1}$
\end_inset

-consistency
\begin_inset CommandInset label
LatexCommand label
name "sec:L1-consistency"

\end_inset


\end_layout

\begin_layout Standard
In this section we obtain a result on 
\begin_inset Formula $L_{1}$
\end_inset

-consistency for the irregular histograms we have discussed.
 A density estimate 
\begin_inset Formula $\widehat{f}_{n}$
\end_inset

 is said to be 
\begin_inset Formula $L_{1}$
\end_inset

-consistent for 
\begin_inset Formula $f$
\end_inset

 if 
\begin_inset Formula $\int|\widehat{f}_{n}(x)-f(x)|dx\to0$
\end_inset

 almost surely.
 This is sometimes called 
\emph on
strong
\emph default
 
\begin_inset Formula $L_{1}$
\end_inset

-consistency, where in 
\emph on
weak 
\begin_inset Formula $L_{1}$
\end_inset


\emph default
-consistency almost sure convergence is replaced with convergence in probability.
 We only consider 
\begin_inset Formula $L_{1}$
\end_inset

-consistency as it is, arguably, the most reasonable
\emph on
 
\emph default
criterion of consistency for density estimates, see 
\begin_inset CommandInset citation
LatexCommand citet
key "devroye1985nonparametric"

\end_inset

.
 Note that 
\begin_inset Formula $L_{1}$
\end_inset

 and 
\begin_inset Formula $L_{p}$
\end_inset

 consistency is not the same: Since 
\begin_inset Formula $\lambda([0,1])=1$
\end_inset

, 
\begin_inset Formula $\int f_{n}dx\to0$
\end_inset

 if 
\begin_inset Formula $\int f_{n}^{p}dx\to0$
\end_inset

 for any positive 
\begin_inset Formula $f$
\end_inset

 and 
\begin_inset Formula $p>2$
\end_inset

 by H√∂lder's inequality 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 178"
key "folland2013real"

\end_inset

.
 The converse if false, just take 
\begin_inset Formula $f_{n}=x^{-\frac{1}{p}}$
\end_inset

.
\end_layout

\begin_layout Standard
We show that the irregular 
\begin_inset Formula $KL/L_{2}$
\end_inset

-histograms with variable weights are 
\begin_inset Formula $L_{1}$
\end_inset

-consistent provided the condition
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbb{P}[\max_{i=1,...,k-1}P[\widehat{a_{i-1}},\widehat{a_{i}})>\gamma]\stackrel{a.s}{\to}0\mbox{ for every }\gamma>0,\label{eq:L1 consistency condition}
\end{equation}

\end_inset

is satisfied.
 This is a relatively simple corollary of Theorem 1 of the delightful paper
 
\begin_inset Quotes eld
\end_inset

Consistency of data-driven histogram methods for density estimation and
 classification
\begin_inset Quotes erd
\end_inset

 of 
\begin_inset CommandInset citation
LatexCommand citet
key "lugosi1996consistency"

\end_inset

.
 Their paper builds on previous work by 
\begin_inset CommandInset citation
LatexCommand citet
key "zhao1991almost"

\end_inset

.
 In this section, we present simplified variants of their results: The results
 
\begin_inset CommandInset citation
LatexCommand citeauthor
key "lugosi1996consistency"

\end_inset

 are far more general, 
\begin_inset Quotes eld
\end_inset

living on
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

 instead of the unit interval.
 Their proofs of Lemma 1 and Theorem 1 and are simplified for our more restricte
d setting.
 We supply some definitions from their paper.
 Let 
\begin_inset Formula $\pi$
\end_inset

 be a random partition of 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

, 
\begin_inset Formula $\lambda$
\end_inset

 be the Lebesgue measure, 
\begin_inset Formula $P_{n}$
\end_inset

 be the empirical measure of 
\begin_inset Formula $n$
\end_inset

 i.i.d.
 observations 
\begin_inset Formula $X_{1},...,X_{n}$
\end_inset

 from 
\begin_inset Formula $P$
\end_inset

 with density 
\begin_inset Formula $f$
\end_inset

, and define
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\widehat{f}(x)=\begin{cases}
\frac{P_{n}(\pi[x])}{\lambda(\pi[x])}, & \textrm{if }\lambda(\pi[x])<\infty,\\
0 & \textrm{otherwise}.
\end{cases}
\]

\end_inset

where 
\begin_inset Formula $\pi[x]$
\end_inset

 is the element 
\begin_inset Formula $A\in\pi$
\end_inset

 which contains 
\begin_inset Formula $x$
\end_inset

.
 In 
\begin_inset CommandInset citation
LatexCommand citeauthor
key "lugosi1996consistency"

\end_inset

, the partitions 
\begin_inset Formula $\pi$
\end_inset

 are any random (data driven) partitioning rules, for instance tree-based
 rules.
 
\end_layout

\begin_layout Standard
In our setting, 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

 is replaced by 
\begin_inset Formula $[0,1]$
\end_inset

 and 
\begin_inset Formula $\pi$
\end_inset

 is always a collection of disjoint intervals, which makes things simpler.
  We briefly describe what 
\begin_inset Formula $\pi$
\end_inset

 and 
\begin_inset Formula $\pi[x]$
\end_inset

 look like for our collection of histogram variants, where 
\begin_inset Formula $k$
\end_inset

 is fixed: For the irregular 
\begin_inset Formula $KL$
\end_inset

/
\begin_inset Formula $L_{2}$
\end_inset

-histograms of variable weight, 
\begin_inset Formula $\pi[x]$
\end_inset

 is the set 
\begin_inset Formula $[\widehat{a_{i-1}},\widehat{a_{i}})$
\end_inset

 which 
\begin_inset Formula $x$
\end_inset

 belongs to, where 
\begin_inset Formula $\widehat{a_{i}}$
\end_inset

s are the corresponding split point estimates, and 
\begin_inset Formula $\pi$
\end_inset

 is the collection of all of these intervals.
 For the 
\begin_inset Formula $k$
\end_inset

-spacing histograms, 
\begin_inset Formula $\pi[x]=[\widehat{q_{i-1}},\widehat{q_{i}})$
\end_inset

, where 
\begin_inset Formula $\widehat{q_{i}}$
\end_inset

s are the sample quantiles, and 
\begin_inset Formula $\pi=\left\{ [\widehat{q_{i-1}},\widehat{q_{i}})\mid i=1,..,k-1\right\} $
\end_inset

.
 The regular histogram can have any non-random partition 
\begin_inset Formula $\pi$
\end_inset

 of 
\begin_inset Formula $k$
\end_inset

 disjoint intervals, and 
\begin_inset Formula $\pi[x]$
\end_inset

 picks which one it belongs to.
 Finally, the constant weight 
\begin_inset Formula $KL$
\end_inset

/
\begin_inset Formula $L_{2}$
\end_inset

-histograms don't fit into this framework, but we will speculate on how
 to show 
\begin_inset Formula $L_{1}$
\end_inset

-consistency for these later on.
\end_layout

\begin_layout Standard
We require two technical definitions.
\end_layout

\begin_layout Definition
Let 
\begin_inset Formula $\mathscr{G}$
\end_inset

 be a family of sets in 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

.
 We define the 
\emph on
shatter coefficient by 
\begin_inset Formula 
\begin{eqnarray*}
\mathcal{S}_{n}(\mathscr{G}) & = & \max_{B\subset\mathbb{R}^{d},\:|B|=n}\left(|\left\{ B\cap C\mid C\in\mathscr{G}\right\} |\right).
\end{eqnarray*}

\end_inset


\emph default
Let 
\begin_inset Formula $\mathscr{A}$
\end_inset

 be a family of partitions of 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

.
 We define the 
\emph on
growth function of 
\begin_inset Formula $\mathscr{A}$
\end_inset

 
\emph default
by
\end_layout

\begin_layout Definition
\begin_inset Formula 
\[
\Delta_{n}^{*}(\mathscr{A})=\max_{B\subset\mathbb{R}^{d},\:|B|=n}|\left\{ \left\{ A_{1}\cap B,A_{2}\cap B,...A_{r}\cap B\right\} \mid(A_{1},A_{2},...,A_{r})\in\mathscr{A}\right\} |.
\]

\end_inset


\end_layout

\begin_layout Standard
While the shatter coefficient is a classic of VC-theory, the growth function
 is specific to this particular paper 
\begin_inset CommandInset citation
LatexCommand citep
key "lugosi1996consistency"

\end_inset

.
 Take note of the difference between these two concepts: The shatter coefficient
s finds the cardinality of a set of sets: It finds the maximal number of
 distinct subsets of an 
\begin_inset Formula $n$
\end_inset

-ary set of numbers which 
\begin_inset Formula $\mathscr{G}$
\end_inset

 can isolate.
 The growth function finds the cardinality of a set of sets of sets, namely
 the maximal number of distinct 
\emph on
partitions
\emph default
 of any 
\begin_inset Formula $n$
\end_inset

-ary set in 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

 that 
\begin_inset Formula $\mathscr{A}$
\end_inset

 can isolate.
 The concept 
\begin_inset Formula $\Delta_{n}^{*}(\mathscr{A})$
\end_inset

 is strictly speaking not needed in the sequel.
 Still we feel it is worth including, just to be true to the paper.
 Also, as it gives a better feeling for the situation.
 The following theorem is called the 
\emph on
Vapnik-Chervonenkis inequality
\emph default
 
\begin_inset CommandInset citation
LatexCommand citep
key "vapnik1971uniform"

\end_inset

, and a proof can be found in e.g.
 
\begin_inset CommandInset citation
LatexCommand citet
after "section 12.4"
key "devroye2013probabilistic"

\end_inset

.
\end_layout

\begin_layout Theorem
Let 
\begin_inset Formula $\mathscr{G}$
\end_inset

 be a family of sets, 
\begin_inset Formula $P$
\end_inset

 a probability measure, and 
\begin_inset Formula $P_{n}$
\end_inset

 the empirical measure of 
\begin_inset Formula $P$
\end_inset

.
 For every 
\begin_inset Formula $n\geq1$
\end_inset

 and 
\begin_inset Formula $\epsilon>0$
\end_inset

,
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\begin{equation}
\mathbb{P}(\sup_{A\in\mathscr{G}}|P_{n}(A)-P(A)|>\epsilon)=4\mathcal{S}_{2n}(\mathscr{G})\exp(-n\epsilon^{2}/8),\label{eq:VC-inequality}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathcal{S}_{2n}(\mathscr{G})$
\end_inset

 is the shatter coefficient of 
\begin_inset Formula $\mathscr{G}$
\end_inset

.
\end_layout

\begin_layout Standard
The following beautiful lemma is due to 
\begin_inset CommandInset citation
LatexCommand citet
key "scheffe1947useful"

\end_inset

, with the proof from 
\begin_inset CommandInset citation
LatexCommand citet
after "theorem 1"
key "devroye1985nonparametric"

\end_inset

.
 Here 
\begin_inset Formula $\mathscr{B}$
\end_inset

 is the Borel 
\begin_inset Formula $\sigma$
\end_inset

-algebra on 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

.
\end_layout

\begin_layout Lemma
For every pair of densities 
\begin_inset Formula $f,g$
\end_inset

 on 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\int|f(x)-g(x)|dx=2\sup_{B\in\mathscr{B}}|\int_{B}\left(f(x)-g(x)\right)dx|\label{eq:Scheffe}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathscr{B}$
\end_inset

 is the Borel 
\begin_inset Formula $\sigma$
\end_inset

-algebra on 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

.
 Furthermore, 
\begin_inset Formula $B=\{x\in\mathbb{R}^{d}\mid f(x)>g(x)\}$
\end_inset

 is a witness to the supremum.
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $B$
\end_inset

 be as above, and observe that
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
\int|f(x)-g(x)|dx & = & \int_{B}\left(f(x)-g(x)\right)dx+\int_{B^{c}}\left(g(x)-f(x)\right)dx.
\end{eqnarray*}

\end_inset

Since 
\begin_inset Formula $\int(f(x)-g(x))dx=0$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
\int_{B^{c}}\left(g(x)-f(x)\right)dx & = & \int(g(x)-f(x))dx-\int_{B}(g(x)-f(x)dx\\
 & = & \int_{B}(f(x)-g(x))dx,
\end{eqnarray*}

\end_inset

and 
\begin_inset Formula $\int|f(x)-g(x)|dx=2\int_{B}\left(f(x)-g(x)\right)dx$
\end_inset

.
 Thus 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Scheffe"

\end_inset

 holds with the equality replaced with 
\begin_inset Formula $"\leq"$
\end_inset

.
 
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $A\in\mathscr{B}$
\end_inset

 be arbitrary.
 Then 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
|\int_{A}(f(x)-g(x))dx| & = & |\int_{A\cap B}(f(x)-g(x))dx+\int_{A\cap B^{c}}(f(x)-g(x))dx|\\
 & \le & \max\left(\int_{A\cap B}(f(x)-g(x))dx,\int_{A\cap B^{c}}(g(x)-f(x))dx\right)\\
 & \leq & \max\left(\int_{B}(f(x)-g(x))dx,\int_{B^{c}}(g(x)-f(x))dx\right)\\
 & = & \frac{1}{2}\int|f(x)-g(x)|dx.
\end{eqnarray*}

\end_inset

And the result is proved.
\end_layout

\begin_layout Standard
Lugosi and Nobel arrive at the next result (Lemma 1) through a combination
 of the Vapnik-Chervonenkis inequality and the previous result.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:growth lemma"

\end_inset

Let 
\begin_inset Formula $\mathcal{A}$
\end_inset

 be a collection of partitions of 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

.
 For each 
\begin_inset Formula $n\geq1$
\end_inset

 and 
\begin_inset Formula $\epsilon>0$
\end_inset

,
\end_layout

\begin_layout Lemma
\begin_inset Formula 
\begin{equation}
P\left[\sup_{\pi\in\mathcal{A}_{n}}\sum_{A\in\pi}|P_{n}(A)-P(A)|>\epsilon\right]\leq4\Delta_{2n}^{*}(\mathcal{A}_{n})2^{m(\mathcal{A}_{n})}\exp(-n\epsilon^{2}/32),\label{eq:"VC"-inequality}
\end{equation}

\end_inset

where 
\begin_inset Formula $m(\mathcal{A}_{n})=\max(|\pi|\mid\pi\in\mathcal{A}_{n})$
\end_inset

.
\end_layout

\begin_layout Proof
We define 
\begin_inset Formula $f(x;\pi)=P(\pi[x])$
\end_inset

 and 
\begin_inset Formula $f_{n}(x;\pi)=P_{n}(\pi[x])$
\end_inset

, and let 
\begin_inset Formula $\mathcal{U}_{\pi}$
\end_inset

 be the set of all sets which can be written as a union of elements from
 
\begin_inset Formula $\pi$
\end_inset

.
 
\begin_inset Formula 
\begin{eqnarray*}
\sum_{A\in\pi}|P_{n}(A)-P(A)| & = & \int|f_{n}(x;\pi)-f(x;\pi)|dx\\
 & = & 2\sup_{A\in\mathcal{\mathcal{U}}}|\int_{A}\left(f_{n}(x;\pi)-f(x;\pi)\right)dx|,
\end{eqnarray*}

\end_inset

by Scheff√©'s theorem.
 Now define 
\begin_inset Formula $\mathcal{U}^{\mathcal{A}_{n}}=\cup_{\pi\in\mathcal{A}}\mathcal{U}_{\pi}$
\end_inset

, and obtain
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
\sup_{\pi\in\mathcal{A}_{n}}\sum_{A\in\pi}|P_{n}(A)-P(A)| & = & 2\sup_{A\in\mathcal{U}^{\mathcal{A}_{n}}}|\int_{U}\left(f_{n}(x;\pi)-f(x;\pi)\right)dx|\\
 & = & 2\sup_{A\in\mathcal{U}^{\mathcal{A}_{n}}}|P_{n}(A)-P(A)|.
\end{eqnarray*}

\end_inset

By the Vapnik-Chervonenkis inequality, 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\mathbb{P}(\sup_{A\in\mathcal{U}^{\mathcal{A}_{n}}}|P_{n}(A)-P(A)|>\epsilon)=4\mathcal{S}_{2n}(\mathcal{U}^{\mathcal{A}_{n}})\exp(-n\epsilon^{2}/32).
\]

\end_inset

Now we need to show that 
\begin_inset Formula $\mathcal{S}_{2n}(\mathcal{U}^{\mathcal{A}_{n}})\leq\Delta_{2n}^{*}(\mathcal{A}_{n})2^{m(\mathcal{A})}$
\end_inset

.
 Let 
\begin_inset Formula $B\subset\mathbb{R}^{d}$
\end_inset

 have cardinality 
\begin_inset Formula $n$
\end_inset

, and suppose that 
\begin_inset Formula $\max|\{B\cap U\mid U\in\mathcal{U}^{\mathcal{A}_{n}}\}|=r$
\end_inset

, with 
\begin_inset Formula $U_{1},U_{2},...,U_{r}$
\end_inset

 being witnesses to this partitioning.
 We can then assume that each 
\begin_inset Formula $U_{i}$
\end_inset

 is from a single partition.
 The number of such 
\begin_inset Formula $U_{i}$
\end_inset

s is clearly bounded by the maximal number of partitions for 
\begin_inset Formula $n$
\end_inset

 sets multiplied by the maximal cardinality of these partitions.
 
\end_layout

\begin_layout Standard
The following corollary (Corollary 1 of 
\begin_inset CommandInset citation
LatexCommand citet
key "lugosi1996consistency"

\end_inset

) is a key result, where it is stated without proof.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "pretty corollary"

\end_inset

Let 
\begin_inset Formula $X_{i}\stackrel{i.i.d.}{\sim}P$
\end_inset

 be random vectors in 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

, and let 
\begin_inset Formula $\mathcal{A}_{i}$
\end_inset

, 
\begin_inset Formula $i=1,...,n$
\end_inset

 be a sequence of partition families.
 Assume the conditions
\end_layout

\begin_layout Corollary
(a) 
\begin_inset Formula $n^{-1}m(\mathcal{A}_{n})\to0$
\end_inset

, and,
\end_layout

\begin_layout Corollary
(b) 
\begin_inset Formula $n^{-1}\log(\Delta_{n}^{*}(\mathcal{A}_{n}))\to0,$
\end_inset

 
\begin_inset Newline newline
\end_inset

hold as 
\begin_inset Formula $n\to\infty.$
\end_inset

 Then
\end_layout

\begin_layout Corollary
\begin_inset Formula 
\[
\sup_{\pi\in\mathcal{A}}\sum_{A\in\pi}|P_{n}(A)-P(A)|\stackrel{a.s}{\to}0.
\]

\end_inset


\end_layout

\begin_layout Proof
We will use the following consequence of Borel-Cantelli lemma: If for any
 
\begin_inset Formula $\epsilon>0$
\end_inset

, 
\begin_inset Formula $\sum_{i=1}^{\infty}P(|X_{i}-X|>\epsilon)<\infty$
\end_inset

, then 
\begin_inset Formula $X_{i}\stackrel{a.s.}{\to}X$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 59, corollary 5.2.2"
key "rosenthal2006first"

\end_inset

.
 By Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:growth lemma"

\end_inset

, 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\sum_{n=1}^{\infty}E_{n}=\sum_{n=1}^{\infty}4\Delta_{2n}^{*}(\mathcal{A})2^{m(\mathcal{A})}\exp(-n\epsilon^{2}/32),
\]

\end_inset

where 
\begin_inset Formula $E_{n}$
\end_inset

 is the event 
\begin_inset Formula $\left\{ \sup_{\pi\in\mathcal{A}}\sum_{A\in\pi}|P_{n}(A)-P(A)|>\epsilon\right\} $
\end_inset

.
 By the root test 
\begin_inset CommandInset citation
LatexCommand citet
after "p. 200"
key "rudin1987real"

\end_inset

, the radius of convergence 
\begin_inset Formula $R$
\end_inset

 (here 
\begin_inset Formula $\epsilon$
\end_inset

 is the variable!) is given by 
\begin_inset Formula 
\[
R^{-1}=\limsup_{n\to\infty}(4\Delta_{2n}^{*}(\mathcal{A})2^{m(\mathcal{A})})^{\frac{1}{n}}.
\]

\end_inset

Observe that
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\limsup_{n\to\infty}(4e^{2n}2^{n})^{\frac{1}{n}}=8e^{2},
\]

\end_inset

which gives 
\begin_inset Formula $R=\infty$
\end_inset

 in conjunction with 
\begin_inset Formula $a)$
\end_inset

 and 
\begin_inset Formula $b)$
\end_inset

.
 Hence the power series converges for every 
\begin_inset Formula $\epsilon>0$
\end_inset

, and the result is proved.
\end_layout

\begin_layout Standard
Now we're ready for the histogram consistency theorem! Lugosi and Nobel
 proved a more general theorem for 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

 (see their Theorem 1), which we modify for the case of our restricted setting
 on 
\begin_inset Formula $[0,1]$
\end_inset

.
 The following result also uses ideas from their Theorem 4 on the consistency
 of 
\begin_inset Formula $k$
\end_inset

-spacing histograms.
 In the next theorem, 
\begin_inset Formula $\widehat{a_{i}}$
\end_inset

 are the random split points corresponding to one of the histogram types
 discussed in the preceding sections.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:histogram consistency"

\end_inset

Let 
\begin_inset Formula $X_{1},...,X_{n}\stackrel{i.i.d.}{\sim}P$
\end_inset

, where 
\begin_inset Formula $P$
\end_inset

 is supported on 
\begin_inset Formula $[0,1]$
\end_inset

 and has a density 
\begin_inset Formula $f$
\end_inset

.
 If, as 
\begin_inset Formula $n\to\infty$
\end_inset

 and 
\begin_inset Formula $k_{n}\to\infty$
\end_inset

 the following conditions hold:
\end_layout

\begin_layout Theorem
(a) 
\begin_inset Formula $n^{-1}k_{n}\to0$
\end_inset

, and,
\end_layout

\begin_layout Theorem
(b) 
\begin_inset Formula $\mathbb{P}[\max_{i=1,...,k-1}P[\widehat{a_{i-1}},\widehat{a_{i}})>\gamma]\stackrel{a.s}{\to}0$
\end_inset

 for every 
\begin_inset Formula $\gamma>0$
\end_inset

,
\begin_inset Newline newline
\end_inset

then 
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
\int|f(x)-\widehat{f_{n}}(x)|dx\stackrel{a.s}{\to}0.
\]

\end_inset


\end_layout

\begin_layout Proof
Define 
\begin_inset Formula $f_{n}=P(\pi[x])/\lambda(\pi[x])$
\end_inset

, which is the limit histogram for the partition 
\begin_inset Formula $\pi_{n}$
\end_inset

.
 Here the partition 
\begin_inset Formula $\pi_{n}$
\end_inset

 is defined by
\begin_inset Formula 
\[
\pi_{n}=\left\{ [0,\widehat{a_{1}}),[\widehat{a_{1}},\widehat{a_{2}}),...,[\widehat{a_{k-1}},1]\right\} ,
\]

\end_inset

where the 
\begin_inset Formula $\widehat{a_{i}}$
\end_inset

s are obtained by some minimum divergence method.
 By the triangle inequality, it suffices to show that both 
\begin_inset Formula $\int|\widehat{f_{n}}(x)-f_{n}(x)|dx\to0$
\end_inset

 and 
\begin_inset Formula $\int|f_{n}(x)-f(x)|dx\to0$
\end_inset

 almost surely.
 For the first integral,
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
\int|\widehat{f_{n}}(x)-f_{n}(x)|dx & = & \int\sum_{i=1}^{k}|\frac{P(\pi[x])-P_{n}(\pi[x])}{\lambda(\pi[x])}|dx\\
 & = & \sum_{A\in\pi}|P(A)-P_{n}(A)|\\
 & \leq & \sup_{\pi\in\mathscr{A}_{n}}\sum_{A\in\pi}|P(A)-P_{n}(A)|.
\end{eqnarray*}

\end_inset

In order to use Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "pretty corollary"

\end_inset

 to conclude 
\begin_inset Formula $\int|\widehat{f_{n}}(x)-f_{n}(x)|dx\to0$
\end_inset

, we have to verify condition a) and b) of that corollary.
 a) Is true since 
\begin_inset Formula $m(\mathcal{A})=k_{n}$
\end_inset

 and 
\begin_inset Formula $k_{n}n^{-1}\to0$
\end_inset

 by assumption.
 To verify b) is slightly more involved.
 For each 
\begin_inset Formula $n$
\end_inset

, the quantity 
\begin_inset Formula $\Delta_{n}^{*}(\mathcal{A}_{n})$
\end_inset

 equals the number of ways 
\begin_inset Formula $n$
\end_inset

 points can be partitioned into 
\begin_inset Formula $k_{n}$
\end_inset

 intervals.
 It can be shown that 
\begin_inset Formula $n^{-1}\log(\Delta_{n}^{*}(\mathcal{A}_{n}))\leq2h(\frac{k}{n+k})\to0$
\end_inset

, where 
\begin_inset Formula $h$
\end_inset

 is the binary entropy function 
\begin_inset Formula $h(x)=-x\log x-(1-x)\log(1-x)$
\end_inset

 (see 
\begin_inset CommandInset citation
LatexCommand citet
after "proof of theorem 4"
key "lugosi1996consistency"

\end_inset

).
\end_layout

\begin_layout Proof
As for the other integral,
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
\int|f_{n}(x)-f(x)|dx & = & \sum_{A\in\pi}\int_{A}|f(x)-\frac{P(A)}{\lambda(A)}|dx\\
 & = & \sum_{A\in\pi}(\lambda(A))^{-1}\int_{A}|f(x)\lambda(A)-P(A)|dx\\
 & = & \sum_{A\in\pi}(\lambda(A))^{-1}\int_{A}|f(x)\int_{A}dy-\int_{A}f(y)dy|dx\\
 & = & \sum_{A\in\pi}(\lambda(A))^{-1}\int_{A}|\int_{A}(f(x)-f(y))dy|dx.
\end{eqnarray*}

\end_inset

Now we apply Fubini's theorem together with the fact that 
\begin_inset Formula $|\int fd\mu|\leq\int|f|d\mu$
\end_inset

 to get
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\int|f_{n}(x)-f(x)|dx\leq\sum_{A\in\pi}(\lambda(A))^{-1}\int_{A\times A}|f(x)-f(y)|dxdy.
\]

\end_inset

Fix an 
\begin_inset Formula $\epsilon>0$
\end_inset

 and find a 
\begin_inset Formula $\gamma>0$
\end_inset

 such that 
\begin_inset Formula $\sup_{x,y\in A}|f(x)-f(y)|<\epsilon$
\end_inset

 for any set 
\begin_inset Formula $A$
\end_inset

 with diameter bounded by 
\begin_inset Formula $\delta$
\end_inset

.
 For an 
\begin_inset Formula $A$
\end_inset

 in 
\begin_inset Formula $\pi,$
\end_inset

 either 
\begin_inset Formula $A$
\end_inset

 has diameter bounded by 
\begin_inset Formula $\gamma$
\end_inset

, whereupon
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
(\lambda(A))^{-1}\int_{A\times A}|f(x)-f(y)|dxdy\leq\epsilon\lambda(A),
\]

\end_inset

or 
\begin_inset Formula $A$
\end_inset

 has diameter greater than 
\begin_inset Formula $\gamma$
\end_inset

, which implies
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
(\lambda(A))^{-1}\int_{A\times A}|f(x)-f(y)|dxdy & \leq & (\lambda(A))^{-1}2\int_{A}f(x)dxdy\\
 & \leq & 2P(A).
\end{eqnarray*}

\end_inset

it is time to make use of assumption (b).
 Let 
\begin_inset Formula $A_{\pi}^{\star}$
\end_inset

 be the union of all 
\begin_inset Formula $A\in\pi$
\end_inset

 with diameter greater than 
\begin_inset Formula $\gamma$
\end_inset

.
 Then there are maximally 
\begin_inset Formula $\gamma^{-1}$
\end_inset

 such intervals, as more would require an interval of length greater than
 
\begin_inset Formula $1$
\end_inset

.
 Then 
\begin_inset Formula $P(A_{\pi}^{\star})\leq\frac{1}{\gamma}\max P(A)$
\end_inset

, which is almost surely less than 
\begin_inset Formula $\epsilon$
\end_inset

 in the limit (simply chose 
\begin_inset Formula $\epsilon\gamma$
\end_inset

 in assumption (b)).
 Since 
\begin_inset Formula $\lambda[0,1]=1$
\end_inset

 and 
\begin_inset Formula $\pi$
\end_inset

 is a partition, the event
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\int|f_{n}(x)-f(x)|dx\leq3\epsilon
\]

\end_inset

happens almost always for any fixed 
\begin_inset Formula $\epsilon$
\end_inset

, and the result follows.
\end_layout

\begin_layout Standard
The content of our modification is, besides the simplification to 
\begin_inset Formula $[0,1]$
\end_inset

, modified conditions for the theorem to hold.
 These conditions are more in line with the rest of our discussion.
 The original theorem replaced our conditions (a) and (b) by condition (c):
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbb{P}[x\mid\textrm{diam}(\pi[x])>\gamma]\stackrel{a.s}{\to}0,\mbox{ for every }\gamma>0,
\]

\end_inset

where 
\begin_inset Formula $\pi$
\end_inset

 is allowed to be an arbitrary partitioning, not only intervals.
 Also, condition (a) and (b) from Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "pretty corollary"

\end_inset

 were included.
\end_layout

\begin_layout Standard
It follows immediately that regular histograms with bin widths going to
 zero are 
\begin_inset Formula $L_{1}$
\end_inset

-consistent.
 The 
\begin_inset Formula $k$
\end_inset

-spacing density estimates are also consistent, which follows from the fact
 that 
\begin_inset Formula $P_{n}[\widehat{a_{i-1}},\widehat{a_{i}})=k^{-1}$
\end_inset

 by construction and 
\begin_inset Formula $\sup_{i}|P_{n}[\widehat{a_{i-1}},\widehat{a_{i}})-P[\widehat{a_{i-1}},\widehat{a}_{i})|\stackrel{a.s.}{\to}0$
\end_inset

 by the Glivenko-Cantelli theorem; hence (b) is satisfied.
 
\end_layout

\begin_layout Standard
Let's consider the 
\begin_inset Formula $KL/L_{2}$
\end_inset

-histograms with variable weights.
 It appears difficult to find simple conditions which makes condition (b)
 true.
 In the next section we will prove consistency of the split points for these
 histograms, and in the process we introduce a 
\begin_inset Formula $\delta>0$
\end_inset

 which provides bounds on how small the windows can be.
 It is natural to let 
\begin_inset Formula $\delta_{k}\to0$
\end_inset

 when 
\begin_inset Formula $k$
\end_inset

 increases, and analogously, we can provide a sequence 
\begin_inset Formula $\gamma_{k}\to0$
\end_inset

 which forces (b) to be true by the same Glivenko-Cantelli argument as above.
 We arrive at the following proposition:
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:L1 consistency"

\end_inset

Let 
\begin_inset Formula $\widehat{h}(x)$
\end_inset

 be the 
\begin_inset Formula $KL$
\end_inset

/
\begin_inset Formula $L_{2}$
\end_inset

-histogram with variable weights constructed from 
\begin_inset Formula $f$
\end_inset

.
 Then 
\begin_inset Formula $\widehat{h}\stackrel{L_{1}}{\to f}$
\end_inset

 almost surely, provided the bin widths are kept smaller than 
\begin_inset Formula $\gamma_{k}$
\end_inset

 for some 
\begin_inset Formula $\gamma_{k}\to0$
\end_inset

.
\end_layout

\begin_layout Standard
Notice that condition (b) is false for several histograms that probably
 are consistent.
 For instance, let 
\begin_inset Formula $f$
\end_inset

 be the density given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
f(x)=\alpha\begin{cases}
(1-x)^{2}, & \textrm{when }x\leq\nicefrac{1}{2},\\
\nicefrac{1}{4}, & \textrm{otherwise.}
\end{cases}
\]

\end_inset

Here 
\begin_inset Formula $\alpha=\frac{5}{12}$
\end_inset

 is the norming constant.
 The true split points of the 
\begin_inset Formula $KL$
\end_inset

/
\begin_inset Formula $L_{2}$
\end_inset

-histograms will be have 
\begin_inset Formula $\widehat{a}_{k-1}\approx0.5$
\end_inset

, when 
\begin_inset Formula $k$
\end_inset

 is large enough, but should be consistent provided 
\begin_inset Formula $f(x)=3(1-x)^{2}$
\end_inset

 is.
\end_layout

\begin_layout Standard
While the irregular histograms are as much about the placing of the split
 points as the fact that they are good histograms (recall the definition
 following Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Good histograms"

\end_inset

), Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:L1 consistency"

\end_inset

 only makes use of the fact that they are good histograms, and do not say
 anything about the limit properties of the split points.
 It appears plausible that condition 
\begin_inset Formula 
\[
\mathbb{P}[\max_{i=1,...,k-1}P[\widehat{a_{i-1}},\widehat{a_{i}})>\gamma]\stackrel{a.s}{\to}0\mbox{ for every }\gamma>0,
\]

\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:L1 consistency condition"

\end_inset

 holds when we restrict our attention to densities 
\begin_inset Formula $f$
\end_inset

 which are nowhere locally constant (
\emph on
i.e.

\emph default
 there is no 
\begin_inset Formula $x$
\end_inset

,
\begin_inset Formula $\delta$
\end_inset

 and 
\begin_inset Formula $c$
\end_inset

 such that 
\begin_inset Formula $f((x-\delta,x+\delta))=c$
\end_inset

).
 Anyhow, since the histograms are consistent for any such choice of 
\begin_inset Formula $\gamma_{k}$
\end_inset

, the question of consistency without 
\begin_inset Formula $\gamma_{k}$
\end_inset

s is not tremendously important.
 A possible approach to verifying the condition is to 1.) Prove that 
\begin_inset Formula $\max_{i=1,...,k-1}P[a_{i-1},a_{i})<\gamma$
\end_inset

, where 
\begin_inset Formula $a_{i-1},a_{i}$
\end_inset

 are the true split points of 
\begin_inset Formula $P$
\end_inset

 when 
\begin_inset Formula $k$
\end_inset

 is sufficiently large, and 2.) Find a probabilistic bound on the difference
 
\begin_inset Formula $\mathbb{P}(|P[\widehat{a_{i-1}},\widehat{a_{i}})-P[a_{i-1},a_{i})|>\epsilon)$
\end_inset

.
 An example of such a bound, albeit in a situation more akin to that of
 Manski's estimator, can be found in 
\begin_inset CommandInset citation
LatexCommand citet
after "Theorem 4.5"
key "devroye2013probabilistic"

\end_inset

.
\end_layout

\begin_layout Standard
For the 
\begin_inset Formula $KL$
\end_inset

/
\begin_inset Formula $L_{2}$
\end_inset

-histograms with constant weights, the same reasoning can't be used, since
 Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:histogram consistency"

\end_inset

 only applies to good histograms.
 One idea to explore is whether the constant weight histograms behave asymptotic
ally like good histograms in some sense.
 For instance, one could explore the 
\begin_inset Formula $L_{1}$
\end_inset

-distance between the variable weight 
\begin_inset Formula $KL$
\end_inset

 histogram evaluated at 
\begin_inset Formula $\widehat{a}$
\end_inset

, and the constant weight 
\begin_inset Formula $KL$
\end_inset

 histogram evaluated at 
\begin_inset Formula $\widehat{a}$
\end_inset

, where 
\begin_inset Formula $\,\widehat{a}$
\end_inset

 is the split point estimate of 
\begin_inset Formula $KL$
\end_inset

 with constant weights.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
|\sum_{i=1}^{k}\frac{k^{-1}-P_{n}[\widehat{a_{i-1}},\widehat{a_{i}})}{\widehat{a_{i}}-\widehat{a_{i-1}}}\log(P_{n}[\widehat{a_{i-1}},\widehat{a_{i}}))|1_{[\widehat{a_{i-1}},\widehat{a_{i}})}(x)dx & \leq\\
\sum_{i=1}^{k}|\left[k^{-1}-P_{n}[\widehat{a_{i-1}},\widehat{a_{i}})\right]\log(P_{n}[\widehat{a_{i-1}},\widehat{a_{i}}))|
\end{align*}

\end_inset

Does this converge to 
\begin_inset Formula $0$
\end_inset

 when 
\begin_inset Formula $n^{-1}k\to0$
\end_inset

 and 
\begin_inset Formula $k\to\infty$
\end_inset

? (Or at some slower rate, like 
\begin_inset Formula $n^{-1}e^{k}\to0$
\end_inset

?) Another possibility is that 
\begin_inset Formula $\widehat{a}$
\end_inset

 gets asymptotically close to the vector of 
\begin_inset Formula $k^{-1}$
\end_inset

-quantiles 
\begin_inset Formula $q_{k}$
\end_inset

 as 
\begin_inset Formula $k\to\infty$
\end_inset

.
 Finally, these options might fail, and we would need an entirely different
 consistency proof, or the estimators fail to be consistent.
\end_layout

\begin_layout Standard
Finally, recall the regression histograms mentioned in Section 
\begin_inset CommandInset ref
LatexCommand vref
reference "sec:Binary-decision-trees"

\end_inset

 on binary decision trees.
 
\begin_inset CommandInset citation
LatexCommand citet
key "nobel1996histogram"

\end_inset

 studied, in a sister paper of 
\begin_inset CommandInset citation
LatexCommand citet
key "lugosi1996consistency"

\end_inset

, sufficient conditions for data-driven regression histograms to be 
\begin_inset Formula $L_{2}$
\end_inset

-consistent, meaning that 
\begin_inset Formula $\int(\widehat{f}(x)-f(x))^{2}dP(x)\stackrel{a.s.}{\to}0$
\end_inset

, where 
\begin_inset Formula $f$
\end_inset

 is the real regression function, 
\begin_inset Formula $\widehat{f}$
\end_inset

 is the data-dependent histogram regressor, and 
\begin_inset Formula $P$
\end_inset

 is the distribution of the covariates 
\begin_inset Formula $X$
\end_inset

.
 
\end_layout

\begin_layout Section
Limit distributions
\end_layout

\begin_layout Standard
In this section we prove consistency of the split points of our irregular
 histograms and derive their limit distributions.
 Everything in this section is new work.
 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 33"
key "hjortCIC"

\end_inset

 provided the explicit formula for the limiting distribution of the irregular
 
\begin_inset Formula $KL$
\end_inset

-histogram with constant weights, which provided the starting point for
 this thesis.
\end_layout

\begin_layout Subsection
Asymptotics for the Kullback-Leibler histogram
\end_layout

\begin_layout Standard
We focus on the irregular histogram with 
\emph on
KL
\emph default
-minimisation.
 The objective function has the form
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
m_{(a,w)}=\sum_{i=1}^{k}\log\frac{w_{i}}{a_{i}-a_{i-1}}1_{[a_{i-1},a_{i})}(x),
\]

\end_inset

where 
\begin_inset Formula $(a,w)=(a_{1},...a_{k-1},w_{1},...w_{k-1})$
\end_inset

.
 When appropriate, we will consider 
\begin_inset Formula $a_{0}=0$
\end_inset

 and 
\begin_inset Formula $a_{k}=1$
\end_inset

 to be fixed parameters.
 We already know that the actual minimiser for the histogram with variable
 weights is of the form
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\sum_{i=1}^{k}\log(\frac{P([a_{i-1},a_{i}))}{a_{i}-a_{i-1}})P([a_{i-1},a_{i})).
\]

\end_inset

We define the set of feasible solutions and denote it 
\begin_inset Formula 
\[
\mathcal{S}=\left\{ (a,w)\mid a_{0}=0<a_{1}<...<a_{k-1}<a_{k}=1;\sum w_{i}=1,w_{i}<1\right\} .
\]

\end_inset


\end_layout

\begin_layout Standard
We impose the following conditions on the underlying distribution 
\begin_inset Formula $F$
\end_inset

.
\end_layout

\begin_layout Standard
(A1) It has an everywhere positive density 
\begin_inset Formula $f(x)$
\end_inset

 on 
\begin_inset Formula $(0,1)$
\end_inset

,
\end_layout

\begin_layout Standard
(A2) it is differentiable at each 
\begin_inset Formula $x\in(0,1)$
\end_inset

;
\end_layout

\begin_layout Standard
(A3) the Hessian 
\begin_inset Formula $V$
\end_inset

 of 
\begin_inset Formula $Pm_{(a,w)}$
\end_inset

 is negative definite;
\end_layout

\begin_layout Standard
(A4) there is a unique, well-separated maximiser of the objective function;
\end_layout

\begin_layout Standard
(A5) it satisfies the condition 
\begin_inset Formula $\frac{w_{i+1}}{a_{i+1}-a_{i}}\neq\frac{w_{i}}{a_{i}-a_{i-1}}$
\end_inset

 for each 
\begin_inset Formula $i$
\end_inset

.
\end_layout

\begin_layout Standard
Condition A1 and A2 can be weakened, as we strictly speaking only require
 them to be non-zero and differentiable in neighbourhoods around the points
 
\begin_inset Formula $a_{i}$
\end_inset

, 
\begin_inset Formula $i=1,...,k-1$
\end_inset

.
 But this relaxed condition is elusive and difficult to verify.
 Conditions A1 and A2 tell us which setting we're in: Most importantly,
 we are in a smooth world.
 A3 is needed in order to make the limiting distribution make sense and
 handy for making sure the estimates are consistent.
 A4 is an identifiability condition: Without it there is no unique histogram
 which minimises the distance between the underlying 
\begin_inset Formula $F$
\end_inset

 and itself, so it is a natural condition.
 A5 is necessary to ascertain 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

-convergence, in particular for condition 
\begin_inset CommandInset ref
LatexCommand vref
reference "eq:Uniformity condition"

\end_inset

 to hold.
 We will also establish a result for an alternative condition to A5, namely
\end_layout

\begin_layout Standard
(A5') 
\begin_inset Formula $F$
\end_inset

 satisfies the condition 
\begin_inset Formula $\frac{w_{i+1}}{a_{i+1}-a_{i}}=\frac{w_{i}}{a_{i}-a_{i-1}}$
\end_inset

 for each 
\begin_inset Formula $i$
\end_inset

,
\begin_inset Newline newline
\end_inset

which curiously makes everything converge at 
\begin_inset Formula $\sqrt{n}$
\end_inset

-rate to a normal distribution! 
\end_layout

\begin_layout Standard
First we will prove consistency of the estimates 
\begin_inset Formula $\widehat{a},\widehat{w}$
\end_inset

.
 Recall the Consistency Theorem 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "thm:Consistency theorem"

\end_inset

, which states that we only need to show that 
\begin_inset Formula $\mathcal{F}$
\end_inset

 is Glivenko-Cantelli for consistency to hold whenever the maximum is well-separ
ated.
 We have already assumed that the maximum is well-separated in A3, which
 seems reasonable, although we will not attempt to prove or find any necessary
 or sufficient conditions for this condition to hold in this thesis.
 In order to cope with unboundedness we slightly modify the set of allowed
 values 
\begin_inset Formula $\mathcal{S}$
\end_inset

 with the additional constraint 
\begin_inset Formula $a_{i}-a_{i-1}\geq\delta$
\end_inset

, where 
\begin_inset Formula $\delta>0$
\end_inset

 is arbitrary.
 We denote an 
\begin_inset Formula $\mathcal{S}$
\end_inset

 modified in such a way by 
\begin_inset Formula $\mathcal{S}_{\delta}$
\end_inset

 and go on to prove that the 
\begin_inset Formula $KL$
\end_inset

 histogram with constant weights is Glivenko-Cantelli for every fixed 
\begin_inset Formula $k$
\end_inset

.
 
\end_layout

\begin_layout Proposition
The class 
\begin_inset Formula $\mathcal{F}=\left\{ m_{a}=\sum_{i=1}^{k}\log\frac{k^{-1}}{a_{i}-a_{i-1}}1_{[a_{i-1},a_{i})}\mid a\in\mathcal{S_{\delta}}\right\} $
\end_inset

 is Glivenko-Cantelli for any choice of 
\begin_inset Formula $\delta$
\end_inset

.
 
\end_layout

\begin_layout Proof
By theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Bracket GC theorem"

\end_inset

 it suffices to show that 
\begin_inset Formula $N_{[]}(\epsilon,\mathcal{F},L_{1}(P))<\infty$
\end_inset

 for any 
\begin_inset Formula $\epsilon>0$
\end_inset

 sufficiently small.
 We show this in detail for 
\begin_inset Formula $k=2$
\end_inset

.
 We define the following functions 
\begin_inset Formula $l_{a,\eta}$
\end_inset

 and 
\begin_inset Formula $u_{a,\eta}$
\end_inset

 by
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
l_{a,\eta}(x) & = & -\log(a+\eta)1_{[0,a-\eta)}(x)-\log(1-a+\eta)1_{[a-\eta,1]}(x),\\
u_{a,\eta}(x) & = & -\log(a-\eta)1_{[0,a+\eta)}(x)-\log(1-a+\eta)1_{[a+\eta,1]}(x),
\end{eqnarray*}

\end_inset

when 
\begin_inset Formula $a<0.5$
\end_inset

, where the signs in the indicator functions are flipped whenever 
\begin_inset Formula $a\geq0.5$
\end_inset

.
 We have 
\begin_inset Formula $l_{a,\eta}\leq m_{a+\xi}\leq u_{a,\eta}$
\end_inset

 whenever 
\begin_inset Formula $\xi<\eta$
\end_inset

, which can be verified by inspecting the definition of 
\begin_inset Formula $m_{a}.$
\end_inset

 
\end_layout

\begin_layout Proof
The 
\begin_inset Formula $L_{1}(\lambda)$
\end_inset

-distance between these brackets is 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
 &  & \left[\log(a+\eta)-\log(a-\eta)\right](a-\eta)\\
 & + & \left[\log(1-a+\eta)-\log(a-\eta)\right]2\eta\\
 & + & \left[\log(1-a+\eta)-\log(a+\eta)\right](1-a+\eta).
\end{eqnarray*}

\end_inset

This simplifies to 
\begin_inset Formula $2\eta|\log(1-a)-\log(a)|$
\end_inset

 whenever 
\begin_inset Formula $\eta$
\end_inset

 is close to 
\begin_inset Formula $0$
\end_inset

 (higher order terms are discarded).
 Since 
\begin_inset Formula $a\geq\delta$
\end_inset

 and 
\begin_inset Formula $1-a\geq\delta$
\end_inset

 by our previously imposed constraint, the 
\begin_inset Formula $L_{1}(\lambda)$
\end_inset

-distances are bounded by 
\begin_inset Formula $\epsilon=4\eta\log(\delta^{-1})$
\end_inset

.
 Now assume 
\begin_inset Formula $P\ll\lambda$
\end_inset

, and notice that the 
\begin_inset Formula $L_{1}(P)$
\end_inset

-distance is bounded by 
\begin_inset Formula $12\eta\log(\delta^{-1})$
\end_inset

 whenever 
\begin_inset Formula $\delta$
\end_inset

 is sufficiently small.
 The increased bound is due to the fact that 
\begin_inset Formula $P$
\end_inset

 might have all its mass inbetween 
\begin_inset Formula $a-\eta$
\end_inset

 and 
\begin_inset Formula $a+\eta$
\end_inset

.
 In conclusion, we need 
\begin_inset Formula $\frac{\eta^{-1}}{2}=6\epsilon^{-1}\log(\delta^{-1})$
\end_inset

 such brackets, hence the covering number 
\begin_inset Formula $N_{[]}(\epsilon,\mathcal{F},L_{1}(P))\leq6\epsilon^{-1}\log(\delta^{-1})<\infty$
\end_inset

 for every 
\begin_inset Formula $\epsilon>0$
\end_inset

.
 
\end_layout

\begin_layout Proof
We extended this technique, not entirely rigorously, to the case of an arbitrary
 
\begin_inset Formula $k$
\end_inset

.
 We define 
\begin_inset Formula $k$
\end_inset

-variate generalisations of 
\begin_inset Formula $l_{a,\eta}$
\end_inset

 and 
\begin_inset Formula $u_{a,\eta}$
\end_inset

 in a similar manner as above: We let 
\begin_inset Formula $l_{a,\eta}(x)=\sum_{i=1}^{k}\log\frac{k^{-1}}{a_{i}-a_{i-1}+\eta}1_{A_{i}^{\eta}},$
\end_inset

 where 
\begin_inset Formula $A_{1}^{\eta}=[0,a_{1}+\eta)$
\end_inset

 when 
\begin_inset Formula $a_{1}>a_{2}-a_{1}$
\end_inset

 and 
\begin_inset Formula $A_{1}^{\eta}=[0,a_{1}-\eta)$
\end_inset

 otherwise.
 In general, 
\begin_inset Formula $A_{i}^{\eta}=[b_{i-1},b_{i})$
\end_inset

 where 
\begin_inset Formula $b_{i-1}=a_{i-1}+\eta$
\end_inset

 if 
\begin_inset Formula $a_{i}-a_{i-1}>a_{i-1}-a_{i-2}$
\end_inset

 and 
\begin_inset Formula $b_{i-1}=a_{i-1}-\eta$
\end_inset

 otherwise.
 The point is that 
\begin_inset Formula $l_{a,\eta}$
\end_inset

 lies below 
\begin_inset Formula $m_{a+\overline{\eta}}$
\end_inset

 for any vector of deviations 
\begin_inset Formula $\overline{\eta}$
\end_inset

 pointwise bounded by 
\begin_inset Formula $\eta$
\end_inset

.
 
\end_layout

\begin_layout Proof
The 
\begin_inset Formula $L_{1}(P)$
\end_inset

-distance between 
\begin_inset Formula $l_{a,\eta}$
\end_inset

 and 
\begin_inset Formula $u_{a,\eta}$
\end_inset

 is bounded by 
\begin_inset Formula $4\eta(k+1)\log(\delta^{-1})$
\end_inset

 by the same argument as above.
 We need 
\begin_inset Formula $O(\eta^{-k+1})$
\end_inset

 such brackets.
 We can partition 
\begin_inset Formula $[0,1]$
\end_inset

 into 
\begin_inset Formula $\frac{1}{2\eta}$
\end_inset

 sets of length 
\begin_inset Formula $\eta$
\end_inset

, 
\begin_inset Formula $\left\{ [0,2\eta),[2\eta,4\eta),...\right\} $
\end_inset

 where each tuple of midpoints 
\begin_inset Formula $\alpha_{1},...\alpha_{k}$
\end_inset

 covers every 
\begin_inset Formula $m_{a}$
\end_inset

 with 
\begin_inset Formula $a=\alpha_{1}+\xi_{1},...\alpha_{k}+\xi_{k}$
\end_inset

 with 
\begin_inset Formula $\xi_{i}<\eta$
\end_inset

.
 It follows that 
\begin_inset Formula $N_{[]}(\epsilon,\mathcal{F},L_{1}(P))\leq K\epsilon^{-k+1}$
\end_inset

, for some 
\begin_inset Formula $K$
\end_inset

 independent of 
\begin_inset Formula $\epsilon$
\end_inset

, and the result follows.
\end_layout

\begin_layout Standard
The preceding bound also works on the 
\begin_inset Formula $L_{2}$
\end_inset

 bracketing entropy 
\begin_inset Formula $N_{[]}(\epsilon,\mathcal{F},L_{2}(P))$
\end_inset

.
 For when 
\begin_inset Formula $\eta$
\end_inset

 is small, the 
\begin_inset Formula $L_{2}$
\end_inset

-distance between 
\begin_inset Formula $l_{a,\eta}$
\end_inset

 and 
\begin_inset Formula $u_{a,\eta}$
\end_inset

 is bounded above by 
\begin_inset Formula $K\eta^{2}$
\end_inset

 for some 
\begin_inset Formula $K$
\end_inset

, hence they are clearly bounded by 
\begin_inset Formula $K'\eta$
\end_inset

 for some 
\begin_inset Formula $K'$
\end_inset

 as well.
 We claim without proof that this construction can be extended to the other
 two types of histograms.
 The choice of a 
\begin_inset Formula $\delta>0$
\end_inset


\emph on
 may be
\emph default
 unnecessary, as we could conceivable have used features of the distribution
 
\begin_inset Formula $P$
\end_inset

 instead.
 A good choice of 
\begin_inset Formula $\delta$
\end_inset

 is of paramount importance in practice, as it avoids the 
\begin_inset Quotes eld
\end_inset

Dirac catastrophe
\begin_inset Quotes erd
\end_inset

 described in Section 
\begin_inset CommandInset ref
LatexCommand vref
reference "sec:Presmoothing-and-instability"

\end_inset

.
\end_layout

\begin_layout Standard
Since 
\begin_inset Formula $\log N_{[]}(\epsilon,\mathcal{F},L_{2}(P))=0$
\end_inset

 when 
\begin_inset Formula $\epsilon$
\end_inset

 is sufficiently large, we can bound the bracketing integral by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
J_{[]}(\delta,F,L_{2}(P)) & = & \int_{0}^{\infty}\sqrt{\log N_{[]}(\epsilon,\mathcal{F},L_{2}(P))}d\epsilon\\
 & = & \int_{0}^{1}\sqrt{K_{1}\log\epsilon}d\epsilon+K_{2}\\
 & = & \frac{1}{2}\sqrt{\pi K_{1}}+K_{2}.
\end{eqnarray*}

\end_inset

Where 
\begin_inset Formula $K_{1},K_{2}$
\end_inset

 are constants and the value of 
\begin_inset Formula $\int_{0}^{1}\sqrt{K_{1}\log\epsilon}d\epsilon$
\end_inset

 was found by the computer algebra system 
\begin_inset CommandInset citation
LatexCommand cite
key "maxima"

\end_inset

.
 From this we can conclude that the histograms are 
\begin_inset Formula $P$
\end_inset

-Donsker for fixed 
\begin_inset Formula $k$
\end_inset

.
 
\end_layout

\begin_layout Standard
Recall that 
\begin_inset Formula $\mathcal{M}_{\delta}=\left\{ m_{(a,w)}-m_{(a_{0},w_{0})}\mid d((a,w),(a^{0},w^{0}))\leq\delta\right\} $
\end_inset

, a local variant 
\begin_inset Formula $\mathcal{F}$
\end_inset

.
 Here 
\begin_inset Formula $d$
\end_inset

 is the pointwise maximum among 
\begin_inset Formula $|a_{i}-a_{i}^{0}|$
\end_inset

.
 We define an envelope 
\begin_inset Formula $M_{\delta}$
\end_inset

 for this class,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
M_{\delta}=\sum_{i=1}^{k}\log\frac{w_{i}+\delta}{a_{i}-a_{i-1}-2\delta}1_{B_{i}}-\log\frac{w_{i}}{a_{i}-a_{i-1}}1_{[a_{i-1},a_{i})},
\]

\end_inset

where 
\begin_inset Formula $B_{i}=[a_{i}\pm\delta,a_{i-1}\pm\delta)$
\end_inset

 and the sign of 
\begin_inset Formula $\delta$
\end_inset

 is chosen so that 
\begin_inset Formula $M_{\delta}(x)$
\end_inset

 is maximised for each 
\begin_inset Formula $x$
\end_inset

.
 By reasoning similar to that used above, it is clear that the local bracketing
 integral is bounded,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\int_{0}^{\infty}\sup_{\delta<\delta_{0}}\sqrt{\log N_{[]}(\epsilon,\mathcal{M}_{\delta},L_{2}(P)}d\epsilon<\infty,
\]

\end_inset

which is one of the conditions for the rate theorem (Theorem 
\begin_inset CommandInset ref
LatexCommand vref
reference "thm:rate theorem"

\end_inset

).
\end_layout

\begin_layout Standard
Now we're ready for a result that does several things: It describes the
 shape of the limiting Gaussian process in the rate theorem, and establishes
 the uniformity condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Uniformity condition"

\end_inset

 and Gaussian condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Gaussian condition"

\end_inset

 involved in said theorem.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:Covariance structure, KL"

\end_inset

Let 
\begin_inset Formula $m_{(a,w)}=\sum_{i=1}^{k}\log\frac{w_{i}}{a_{i}-a_{i-1}}1_{I_{i}}(x)$
\end_inset

 be the objective associated with the 
\begin_inset Formula $KL$
\end_inset

 histogram with either variable or constant weights 
\begin_inset Formula $w_{j}$
\end_inset

.
 Denote the least false vectors by 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $w$
\end_inset

, and let 
\begin_inset Formula $f$
\end_inset

 be the density of 
\begin_inset Formula $P$
\end_inset

.
 Provided the conditions (A1-A5) are satisfied, the following is true
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\begin{eqnarray*}
\lim_{\delta\searrow0}\frac{P\left(m_{(a,w)+\delta(g,g')}-m_{(a,w)+\delta(h,h')}\right)^{2}}{\delta} & = & \sum_{i=1}^{k-1}f(q_{i}^{0})|g_{i}-h_{i}|\beta_{i}^{2},
\end{eqnarray*}

\end_inset

where 
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
\beta_{i}=\log\frac{w_{i+1}}{a_{i+1}-a_{i}}-\log\frac{w_{i}}{a_{i}-a_{i-1}}.
\]

\end_inset

Thus condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Uniformity condition"

\end_inset

 is satisfied for 
\begin_inset Formula $\phi(\delta)=\sqrt{\delta}$
\end_inset

.
 Furthermore, condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Gaussian condition"

\end_inset

is satisfied with 
\begin_inset Formula 
\begin{equation}
G(h)=\sum_{i=1}^{k-1}f(a_{i})^{\frac{1}{2}}\left|\log\frac{w_{i+1}}{a_{i+1}-a_{i}}-\log\frac{w_{i}}{a_{i}-a_{i-1}}\right|W_{i}(h_{i})\label{eq:Gaussian process (irregular histogram)}
\end{equation}

\end_inset

 where 
\begin_inset Formula $W_{i}$
\end_inset

 are independent standard Brownian motions.
\end_layout

\begin_layout Proof
First we extend, for convenience's sake, 
\begin_inset Formula $h,g$
\end_inset

 with 
\begin_inset Formula $h_{0},h_{k},g_{0},h_{k}=0$
\end_inset

.
 To calculate 
\begin_inset Formula $\lim_{\delta\searrow0}\frac{1}{\delta}\mathbb{P}\left(m_{(a^{0},w^{0})+\delta(h,h')}-m_{(a^{0},w^{0})+\delta(g,g')}\right)^{2}$
\end_inset

 we will find 
\begin_inset Formula 
\[
\frac{1}{\delta}P\left[m_{(a^{0},w^{0})+\delta(h,h')}m_{(a^{0},w^{0})+\delta(g,g')}\right]
\]

\end_inset

 first, making use of the fact that 
\begin_inset Formula $\delta$
\end_inset

 is arbitrarily small.
 We define two handy elements, namely 
\begin_inset Formula 
\[
S_{i}^{f}(\delta)=[a_{i-1}+\delta f_{i-1},a_{i}+\delta f_{i}),
\]

\end_inset

which is the 
\begin_inset Formula $\delta f$
\end_inset

-extended version of 
\begin_inset Formula $[a_{i-1},a_{i})$
\end_inset

, and 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray}
C_{i}^{f}(\delta) & = & \log(w_{i}+\delta f'_{i})-\log((a_{i}+\delta f_{i})-(a_{i-1}-\delta f_{i-1}))\nonumber \\
 & \approx & \log\frac{w_{i}}{a_{i}-a_{i-1}}+\frac{\delta f'{}_{i}}{w_{i}}-\frac{\delta(f_{i}-f_{i-1})}{a_{i}-a_{i-1}},\label{eq:C(f,j,delta)}
\end{eqnarray}

\end_inset

The 
\begin_inset Formula $\delta(f,f')$
\end_inset

-extended variant of 
\begin_inset Formula $(\log w_{i}-\log a_{i}-a_{i-1})$
\end_inset

.
 Here the approximation follows from a first order Taylor expansion and
 the fact that 
\begin_inset Formula $\delta$
\end_inset

 is small.
 Then we have
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
 &  & P\left[m_{(a^{0},w^{0})+\delta(h,h')}m_{(a^{0},w^{0})+\delta(g,g')}\right]\\
 & = & \sum_{i=1}^{k}\sum_{j=1}^{k}C_{i}^{h}(\delta)C_{j}^{g}(\delta)P(S_{i}^{h}(\delta)\cap S_{j}^{g}(\delta)),
\end{eqnarray*}

\end_inset

by the definitions of the
\begin_inset Formula $C$
\end_inset

s and 
\begin_inset Formula $S$
\end_inset

s, for any choice of 
\begin_inset Formula $g,h$
\end_inset

.
 
\end_layout

\begin_layout Proof
We first consider the case 
\begin_inset Formula $g\neq h$
\end_inset

.
 Note that when 
\begin_inset Formula $\delta$
\end_inset

 is small enough 
\begin_inset Formula $S_{i}^{g}(\delta)\cap S_{j}^{h}(\delta)=\emptyset$
\end_inset

 for all 
\begin_inset Formula $i,j$
\end_inset

 except 
\begin_inset Formula $i=j$
\end_inset

, and 
\begin_inset Formula $i=j+1,j=i+1$
\end_inset

.
 Also, 
\begin_inset Formula $S_{i}^{h}(\delta)\cap S_{j}^{h}(\delta)=S_{i}^{g}(\delta)\cap S_{j}^{g}(\delta)=\emptyset$
\end_inset

 for all 
\begin_inset Formula $i\neq j$
\end_inset

.
 Using this fact, we calculate the term 
\begin_inset Formula $\mathbb{P}\left[m_{(a,w)+\delta(h,h')}m_{(a,w)+\delta(g,g')}\right]=A_{1}+A_{2}+A_{3}$
\end_inset

, where 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
A_{1} & = & \frac{1}{\delta}\sum_{i=1}^{k}C_{i+1}^{g}(\delta)C_{i}^{h}(\delta)P(S_{i+1}^{g}(\delta)\cap S_{i}^{h}(\delta)),\\
A_{2} & = & \frac{1}{\delta}\sum_{i=1}^{k}C_{i}^{g}(\delta)C_{i+1}^{h}(\delta)P(S_{i}^{g}(\delta)\cap S_{i+1}^{h}(\delta)),\\
A_{3} & = & \frac{1}{\delta}\sum_{i=1}^{k}C_{i}^{g}(\delta)C_{i}^{h}(\delta)P(S_{i}^{g}(\delta)\cap S_{i}^{h}(\delta)).
\end{eqnarray*}

\end_inset

The probabilities in the first sum are easily found to be 
\begin_inset Formula $P[a_{i}+\delta g_{i},a_{i}+\delta h_{i})=f(a_{i})\delta(h_{i}-g_{i})$
\end_inset

 if 
\begin_inset Formula $h_{i}\geq g_{i}$
\end_inset

, or 
\begin_inset Formula $0$
\end_inset

 if 
\begin_inset Formula $h_{i}<g_{i}$
\end_inset

, while for the second sum we get 
\begin_inset Formula $f(a_{i})\delta(g{}_{i}-h_{i})$
\end_inset

 if 
\begin_inset Formula $h_{i}\leq g_{i}$
\end_inset

 or 
\begin_inset Formula $0$
\end_inset

 if 
\begin_inset Formula $g_{i}<h_{i}$
\end_inset

.
 Since these conditions can't be true at the same time, we combine the sums,
 use 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:C(f,j,delta)"

\end_inset

, and pass 
\begin_inset Formula $\delta\to0$
\end_inset

 to get
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{equation}
\lim_{\delta\searrow0}\frac{1}{\delta}(A_{1}+A_{2})=\sum_{i=1}^{k}f(a_{i})\log\frac{w_{i}}{a_{i}-a_{i-1}}\log\frac{w_{i+1}}{a_{i+1}-a_{i}}|h_{i}-g_{i}|.\label{eq:Cross terms}
\end{equation}

\end_inset

Similarly, the third sum is found to be 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
A_{3} & =\sum_{i=1}^{k}[C_{i}^{f}(\delta)C_{i}^{g}(\delta)(P([a_{i-1},a_{i}))\\
 & +\delta\left[f(a_{i})\min(g_{i},h_{i})-f(a_{i-1})\max(g_{i-1},h_{i-1})\right])].
\end{align*}

\end_inset

Now we consider the case when 
\begin_inset Formula $h=g$
\end_inset

.
 In this case the cross terms corresponding to 
\begin_inset Formula $A_{1}$
\end_inset

 and 
\begin_inset Formula $A_{2}$
\end_inset

 equals 
\begin_inset Formula $0$
\end_inset

 and we're left with the natural analogues of 
\begin_inset Formula $A_{3}$
\end_inset

,
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
A_{4} & = & \sum C_{i}^{g}(\delta)C_{i}^{g}(\delta)(P([a_{i-1},a_{i}))+\delta\left[f(a_{i})g_{i}-f(a_{i-1})g_{i-1}\right]),\\
A_{5} & = & \sum C_{i}^{h}(\delta)C_{i}^{h}(\delta)(P([a_{i-1},a_{i}))+\delta\left[f(a_{i})h_{i}-f(a_{i-1})h_{i-1}\right]).
\end{eqnarray*}

\end_inset

Notice that 
\begin_inset Formula $C_{i}^{g}(\delta)C_{i}^{h}(\delta)=\left(\log\frac{w_{i}}{a_{i}-a_{i-1}}\right)^{2}+O(\delta)$
\end_inset

, for any 
\begin_inset Formula $h,g$
\end_inset

.
 Also, 
\begin_inset Formula $x+y-2\min(x,y)=2\max(x,y)-x-y=|x-y|$
\end_inset

, which can be applied on the sum 
\begin_inset Formula 
\begin{align*}
\left[f(a_{i})g_{i}-f(a_{i-1})g_{i-1}\right]+\left[f(a_{i})h_{i}-f(a_{i-1})h_{i-1}\right]\\
-2\left[f(a_{i})\min(g_{i},h_{i})-f(a_{i-1})\max(g_{i-1},h_{i-1})\right]
\end{align*}

\end_inset

for each 
\begin_inset Formula $i$
\end_inset

 to get 
\begin_inset Formula $|h_{i}-g_{i}|f(a_{i})+|h_{i-1}-g_{i-1}|f(a_{i-1})$
\end_inset

, which we denote 
\begin_inset Formula $K_{i}$
\end_inset

.
 The other term to the left in 
\begin_inset Formula $A_{3},A_{4},A_{5}$
\end_inset

 is 
\begin_inset Formula $P([a_{i-1},a_{i}))$
\end_inset

; when these terms are multiplied with the 
\begin_inset Formula $\left(\log\frac{w_{i}}{a_{i}-a_{i-1}}\right)^{2}$
\end_inset

, they cancel each other out.
 Furthermore, the terms 
\begin_inset Formula $O(\delta)$
\end_inset

 terms in 
\begin_inset Formula $C_{i}^{g}(\delta)C_{i}^{h}(\delta)+C_{i}^{h}(\delta)C_{i}^{h}(\delta)+C_{i}^{g}(\delta)C_{i}^{g}(\delta)$
\end_inset

 also cancel each other, and we're left with only 
\begin_inset Formula $O(\delta^{2})$
\end_inset

 terms, which will get sent off to zero.
 Hence we get
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray}
 &  & \lim_{\delta\searrow0}\frac{1}{\delta}\left[A_{4}+A_{5}-2A_{3})\right]\nonumber \\
 & = & \lim_{\delta\searrow0}\left(\frac{1}{\delta}\sum_{i=1}^{k}[\left(\log\frac{w_{i}}{a_{i}-a_{i-1}}\right)^{2}+O(\delta)]\delta K_{i}\right)\label{eq:Key part (sqrt convergence)}\\
 & = & \sum_{i=1}^{k}K_{i}\left(\log\frac{w_{i}}{a_{i}-a_{i-1}}\right)^{2}\nonumber \\
 & = & \sum_{i=1}^{k-1}|h_{i}-g_{i}|f(a_{i})\left(\left(\log\frac{w_{i+1}}{a_{i+1}-a_{i}}\right)^{2}+\left(\frac{w_{i}}{a_{i}-a_{i-1}}\right)^{2}\right).\nonumber 
\end{eqnarray}

\end_inset

Now we take the difference 
\begin_inset Formula $\lim_{\delta\searrow0}\frac{1}{\delta}\left[A_{4}+A_{5}-2A_{3})\right]-\lim_{\delta\searrow0}\frac{1}{\delta}2(A_{1}+A_{2})$
\end_inset

, which equals
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\sum_{i=1}^{k-1}f(a_{i})|g_{i}-h_{i}|\left(\log\frac{w_{i+1}}{a_{i+1}-a_{i}}-\log\frac{w_{i}}{a_{i}-a_{i-1}}\right)^{2}.
\]

\end_inset

It remains to show that this corresponds to 
\begin_inset Formula $E(G(h)-G(g))^{2}$
\end_inset

 for the Gaussian process described above.
 Its covariance kernel is given by
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\sum_{i=1}^{k-1}\min(g_{i},h_{i})f(a_{i})\left(\log\frac{w_{i+1}}{a_{i+1}-a_{i}}-\log\frac{w_{i}}{a_{i}-a_{i-1}}\right)^{2},
\]

\end_inset

by the property of Brownian motions that 
\begin_inset Formula $\mathrm{Cov}(B(t),B(s))=\sigma^{2}\min(t,s)$
\end_inset

 whenever 
\begin_inset Formula $B$
\end_inset

 is a Brownian motion such that 
\begin_inset Formula $B(t)$
\end_inset

 has variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 From this it follows that 
\begin_inset Formula 
\begin{eqnarray*}
E(G(h)-G(g))^{2} & = & \Var G(h)+\Var G(g)-2\Cov(G(g),G(h))\\
 & = & \sum_{i=1}^{k}f(a_{i})\left|\beta\right|(h_{i}+g_{i}-2\min(h_{i},g_{i}))\\
 & = & \sum_{i=1}^{k-1}f(a_{i})\beta^{2}|h_{i}-g_{i}|.
\end{eqnarray*}

\end_inset

Notice that 
\begin_inset Formula $h'$
\end_inset

 and 
\begin_inset Formula $g'$
\end_inset

, the free variables corresponding the weights 
\begin_inset Formula $w_{i}$
\end_inset

, play no active role in the proof.
 Their role in the limit distribution is solely confined to the Hessian
 or information matrix 
\begin_inset Formula $V$
\end_inset

, considered in the next theorem.
 
\end_layout

\begin_layout Remark
Notice the role of A5: It makes sure that 
\begin_inset Formula 
\[
\sum_{i=1}^{k-1}f(q_{i}^{0})|g_{i}-h_{i}|\left(\log\frac{w_{i+1}}{a_{i+1}-a_{i}}-\log\frac{w_{i}}{a_{i}-a_{i-1}}\right)^{2}
\]

\end_inset

is non-zero for every choice of 
\begin_inset Formula $h$
\end_inset

 and 
\begin_inset Formula $g$
\end_inset

.
 Assumption A4 is clearly necessary, as we can see in this example.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa: No unique maximum"

\end_inset

 (On assumption A4).
 Consider the case of 
\begin_inset Formula $Beta(\alpha,\alpha)$
\end_inset

, constant weights and 
\begin_inset Formula $k=2$
\end_inset

.
 These distributions are symmetric, are unimodal whenever 
\begin_inset Formula $\alpha\geq1$
\end_inset

 and have two 
\begin_inset Quotes eld
\end_inset

arms
\begin_inset Quotes erd
\end_inset

 on each side when 
\begin_inset Formula $\alpha<1$
\end_inset

.
 Not surprisingly, there are two best approximating histograms when 
\begin_inset Formula $\alpha<1$
\end_inset

 is sufficiently close to 
\begin_inset Formula $0$
\end_inset

.
 For instance, when 
\begin_inset Formula $\alpha=\frac{1}{10}$
\end_inset

, there is one maximum in 
\begin_inset Formula $a\approx0.99995$
\end_inset

 and one in 
\begin_inset Formula $1-a$
\end_inset

.
 As can be seen in the Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:(left)-Densities-for"

\end_inset

, not every 
\begin_inset Formula $\mbox{Beta}(\alpha,\alpha)$
\end_inset

 with 
\begin_inset Formula $\alpha<1$
\end_inset

 has this feature.
 
\end_layout

\begin_layout Example
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Beta(densities).pdf
	scale 30

\end_inset


\begin_inset Graphics
	filename OppgaveR/Beta(objectives).pdf
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:(left)-Densities-for"

\end_inset

(left) Densities for 
\begin_inset Formula $\mbox{Beta}(\alpha,\alpha)$
\end_inset

 for several choices of 
\begin_inset Formula $\alpha$
\end_inset

.
 (right) The corresponding objective functions.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
We proceed to find the information matrix 
\begin_inset Formula $V$
\end_inset

: Recall from the rate theorem 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "thm:rate theorem"

\end_inset

 that the limiting distribution of 
\begin_inset Formula $n^{\frac{1}{3}}(\widehat{(a,w)}-(a,w))$
\end_inset

 us on the form 
\begin_inset Formula $\argmax_{h}(\frac{1}{1}h^{T}Vg+G(h))$
\end_inset

, where 
\begin_inset Formula $G(h)$
\end_inset

 is found in the previous theorem and 
\begin_inset Formula $V$
\end_inset

 is the Hessian matrix of 
\begin_inset Formula $Pm_{(a,w)}$
\end_inset

 with respect to the parameter vector 
\begin_inset Formula $(a,w$
\end_inset

).
 The next proposition provides the elements of 
\begin_inset Formula $V$
\end_inset

 for both the case of constant and variable weights.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:Matrix elements of histogram distribution"

\end_inset

The information matrix 
\begin_inset Formula $V$
\end_inset

 has elements
\end_layout

\begin_layout Proposition
\begin_inset Formula 
\begin{eqnarray*}
V_{i,i+1} & = & \frac{f(a_{i})+f(a_{i+1})}{a_{i+1}-a_{i}}-\frac{\left[F(a_{i+1})-F(a_{i})\right]}{\left(a_{i+1}-a_{i}\right)^{2}},\\
V_{i,i} & = & f'(a_{i})(\log\frac{w_{i}}{a_{i}-a_{i-1}}-\log\frac{w_{i+1}}{a_{i+1}-a_{i}})\\
 &  & -2f(a_{i})\left(\frac{1}{a_{i+1}-a_{i}}+\frac{1}{a_{i}-a_{i-1}}\right)\\
 &  & +\frac{\left[F(a_{i+1})-F(a_{i})\right]}{\left(a_{i+1}-a_{i}\right)^{2}}+\frac{\left[F(a_{i})-F(a_{i-1})\right]}{\left(a_{i}-a_{i-1}\right)^{2}},
\end{eqnarray*}

\end_inset

whenever 
\begin_inset Formula $i$
\end_inset

 is less than 
\begin_inset Formula $k$
\end_inset

 (these correspond to the split points).
 For 
\begin_inset Formula $i\neq k-1,$
\end_inset

 we have 
\end_layout

\begin_layout Proposition
\begin_inset Formula 
\begin{eqnarray*}
V_{i,i+k-1} & = & \frac{f(a_{i})}{w_{i}},\\
V_{i-1,i+k-1} & = & \frac{f(a_{i-1})}{w_{i}},\\
V_{k-1,i+k-1} & = & \frac{f(a_{k-1})}{1-w_{k}},
\end{eqnarray*}

\end_inset

while 
\begin_inset Formula $i=k-1$
\end_inset

 gives us
\begin_inset Formula 
\begin{eqnarray*}
V_{k-1,2k-2} & = & \frac{f(a_{i})}{w_{i}}+\frac{f(a_{k-1})}{w_{k}},\\
V_{k-2,2k-2} & = & \frac{f(a_{i-1})}{w_{i}}.
\end{eqnarray*}

\end_inset

Here the conventions 
\begin_inset Formula $a_{0}=0$
\end_inset

 and 
\begin_inset Formula $a_{k}=1$
\end_inset

 are used.
 All the other elements are 
\begin_inset Formula $0$
\end_inset

.
\end_layout

\begin_layout Proof
For the elements only involving the split points, observe that the only
 part of the sum involving 
\begin_inset Formula $a_{i}$
\end_inset

 is
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
v & =\left[F(a_{i})-F(a_{i-1})\right](\log w_{i}-\log\left(a_{i}-a_{i-1}\right))\\
 & +\left[F(a_{i+1})-F(a_{i})\right](\log w_{i+1}-\log\left(a_{i+1}-a_{i}\right)).
\end{align*}

\end_inset

Differentiation gives us
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
\frac{dv}{da_{i}} & = & f(a_{i})\left(\log w_{i}-\log\left(a_{i}-a_{i-1}\right)\right)-\frac{\left[F(a_{i})-F(a_{i-1})\right]}{a_{i}-a_{i-1}}\\
 &  & -f(a_{i})\left(\log w_{i+1}-\log\left(a_{i+1}-a_{i}\right)\right)+\frac{\left[F(a_{i+1})-F(a_{i})\right]}{a_{i+1}-a_{i}}.
\end{eqnarray*}

\end_inset

Hence
\begin_inset Formula 
\begin{eqnarray*}
\frac{dv}{da_{i}a_{i+1}} & = & \frac{f(a_{i})+f(a_{i+1})}{a_{i+1}-a_{i}}-\frac{\left[F(a_{i+1})-F(a_{i})\right]}{\left(a_{i+1}-a_{i}\right)^{2}}
\end{eqnarray*}

\end_inset

while
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
\frac{dv}{da_{i}da_{i}} & = & f'(a_{i})(\log w_{i}-\log w_{i+1}-\log(a_{i}-a_{i-1})+\log\left(a_{i+1}-a_{i}\right))\\
 &  & -2f(a_{i})\left(\frac{1}{a_{i+1}-a_{i}}+\frac{1}{a_{i}-a_{i-1}}\right),\\
 &  & +\frac{\left[F(a_{i+1})-F(a_{i})\right]}{\left(a_{i+1}-a_{i}\right)^{2}}+\frac{\left[F(a_{i})-F(a_{i-1})\right]}{\left(a_{i}-a_{i-1}\right)^{2}}.
\end{eqnarray*}

\end_inset

Concerning 
\begin_inset Formula $i'$
\end_inset

, recall that 
\begin_inset Formula $w_{k}=\sum_{i=1}^{k}w_{i}$
\end_inset

, and that 
\begin_inset Formula $w_{k}$
\end_inset

 only appears in 
\begin_inset Formula 
\[
\left[1-F(a_{k-1})\right](\log w_{k}-\log\left(1-a_{k-1}\right)).
\]

\end_inset

This means that 
\begin_inset Formula $w_{i}$
\end_inset

 also cares about the contribution it gives to the last box, an issue not
 faced by the 
\begin_inset Formula $a_{i}$
\end_inset

s.
 it is clear that all elements involving 
\begin_inset Formula $i$
\end_inset

' are 
\begin_inset Formula $0$
\end_inset

 except
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\frac{d}{dw_{i}dw_{i}}=-\left(\frac{1}{F(a_{i})-F(a_{i-1})}+\frac{1}{1-F(a_{k-1})}\right),
\]

\end_inset

where 
\begin_inset Formula $\frac{1}{1-F(a_{k-1})}$
\end_inset

 appears due to the additional contribution from 
\begin_inset Formula $w_{k}$
\end_inset

.
 Also, when 
\begin_inset Formula $i\neq k-1,$
\end_inset

 we have 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
\frac{d}{dw_{i}da_{i}} & = & \frac{f(a_{i})}{w_{i}},\\
\frac{d}{dw_{i}da_{i-1}} & = & \frac{f(a_{i-1})}{w_{i}},\\
\frac{d}{dw_{i}da_{k-1}} & = & \frac{f(a_{k-1})}{w_{k}}.
\end{eqnarray*}

\end_inset

For 
\begin_inset Formula $i\neq k-1$
\end_inset

, and 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\frac{d}{dw_{i}da_{i}}=\frac{f(a_{i})}{w_{i}}+\frac{f(a_{i})}{1-w_{i}},
\]

\end_inset

when 
\begin_inset Formula $i=k-1.$
\end_inset


\end_layout

\begin_layout Standard
Combining these two results with the rate theorem, we get this thesis' main
 result: The limiting distribution of the irregular Kullback-Leibler histogram
 with variable and constant weights.
 Looking at the rate theorem, the only conditions left are those concerning
 a 
\begin_inset Quotes eld
\end_inset

suitable envelope 
\begin_inset Formula $M_{\delta}$
\end_inset


\begin_inset Quotes erd
\end_inset

, namely the Lindeberg condition 
\begin_inset Formula $\lim_{\delta\searrow0}\frac{P^{\star}M_{\delta}^{2}\{M_{\delta}>\eta\delta^{-2}\phi^{2}(\delta)\}}{\phi^{2}(\delta)}=0$
\end_inset

 together with the condition 
\begin_inset Formula $\phi^{2}(\delta)\geq P^{\star}M_{\delta}^{2}$
\end_inset

, which we ignore.
 Both of these can probably be shown by using similar calculations as in
 Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Covariance structure, KL"

\end_inset

, but this would be laborious and not very enlightening.
 We assume these two conditions are satisfied in the following.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:Main theorem, Kullback-Leibler"

\end_inset

Assume A1-A5.
 The rescaled process 
\begin_inset Formula $n^{\frac{2}{3}}(P_{n}m_{(a,w)+n^{-\frac{1}{3}}\widehat{(a,w)}}-P_{n}m_{(a,w)})$
\end_inset

 converges in distribution to 
\begin_inset Formula $\frac{1}{2}h^{T}Vh+G(h)$
\end_inset

, where 
\begin_inset Formula $G(h)$
\end_inset

 is the Gaussian process 
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
G(h)=\sum_{i=1}^{k-1}f(a_{i})^{\frac{1}{2}}\left|\log\frac{w_{i+1}}{a_{i+1}-a_{i}}-\log\frac{w_{i}}{a_{i}-a_{i-1}}\right|W_{i}(h_{i}),
\]

\end_inset

with 
\begin_inset Formula $w_{i}=P([a_{i-1},a_{i}))$
\end_inset

 in the case of variable weights, and the predefined 
\begin_inset Formula $w_{i}$
\end_inset

 otherwise, and 
\begin_inset Formula $V$
\end_inset

 is the Hessian of 
\begin_inset Formula $Pm_{(a,w)}$
\end_inset

 at 
\begin_inset Formula $(a,w)$
\end_inset

 The maximum likelihood estimate converges with rate 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

 and its limiting distribution is given by
\begin_inset Formula 
\[
n^{\frac{1}{3}}(\widehat{(a,w)}-(a,w))\tod\argmax_{h}\left[\frac{1}{2}h^{T}Vh+G(h)\right],
\]

\end_inset

where the elements of 
\begin_inset Formula $V$
\end_inset

 are given in Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Matrix elements of histogram distribution"

\end_inset

.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:(k = 2) distribution, quantile histogram, KL"

\end_inset

We begin by studying the simplest case of 
\begin_inset Formula $k=2$
\end_inset

 and constant weights; in this case there is only a single true 
\begin_inset Formula $a_{0}$
\end_inset

.
 From Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Matrix elements of histogram distribution"

\end_inset

 we find that 
\begin_inset Formula 
\[
V=f'(a)(\log(1-a)-\log a)-2f(a)\left(\frac{1}{1-a}+\frac{1}{a}\right)+\frac{1-F(a)}{(1-a)^{2}}+\frac{F(a)}{a^{2}},
\]

\end_inset

 while 
\begin_inset Formula $G(h)=f(a)^{\frac{1}{2}}\left|\log a-\log(1-a)\right|W(h)=dW(h)$
\end_inset

, and the limiting distribution is 
\begin_inset Formula $\argmax_{h}\frac{1}{2}Vh^{2}+G(h)$
\end_inset

.
 Using Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Chernoff trick"

\end_inset

 from the section on Chernoff's mode estimator, we find the equivalent formulati
on 
\begin_inset Formula $|\frac{2d}{V}|{}^{-\frac{2}{3}}Z$
\end_inset

, where 
\begin_inset Formula $Z=\argmax_{h}\left[W(h)-h^{2}\right]$
\end_inset

 is Chernoff's distribution.
 
\end_layout

\begin_layout Standard
Next we will use this result in some simulations.
 Using the results in 
\begin_inset CommandInset citation
LatexCommand cite
after "p.9 - 13, table 1 and 3"
key "groeneboom2001computing"

\end_inset

, we can obtain almost exact quantiles for this distribution, allowing us
 to construct approximate confidence intervals and check how well the limit
 distribution approximates the actual distributions for different 
\begin_inset Formula $n$
\end_inset

.
 However, this will not work for any choice of distribution 
\begin_inset Formula $F,$
\end_inset

 as the table in Groeneboom and Wellner doesn't contain enough values for
 the calculation of arbitrary rescalings.
 Due to this we do one large simulation of the Chernoff distribution with
 step size 
\begin_inset Formula $\delta=0.001$
\end_inset

 with 600 000 replications.
 Our goal is to understand how fast the finite sample distribution of 
\begin_inset Formula $n^{\frac{1}{3}}(\widehat{q_{0}}-q_{0})$
\end_inset

 converges to the stated limiting distribution.
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Convergence speed"

\end_inset

The 
\emph on
Kolmogorov distance
\emph default
 between two distributions 
\begin_inset Formula $F$
\end_inset

 and 
\begin_inset Formula $G$
\end_inset

 is defined by 
\begin_inset Formula $d_{K}(F,G)=\sup_{x}|F(x)-G(x)|$
\end_inset

, which corresponds to the greatest vertical distance between the two distributi
ons when they are plotted in the same window.
 We will use this function to measure the distance between simulated finite
 sample distributions and the real distribution.
 Our choices of test distributions are 
\begin_inset Formula $\mbox{Beta}(1,\frac{1}{2})$
\end_inset

 and 
\begin_inset Formula $\mbox{Beta}(2,7)$
\end_inset

, which have slightly different shapes.
 For comparison's sake, we perform the same experiment with the mean of
 
\begin_inset Formula $X_{1},...,X_{n}$
\end_inset

 standard log normal variables, which is understood as a case when the CLT
 is relatively slow working.
 We perform the experiment for 
\begin_inset Formula $n=50,100,500,1000,10000,100000$
\end_inset

.
\end_layout

\begin_layout Example
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="7">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $50$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $100$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $500$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $100000$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mbox{Beta}(1,\frac{1}{2})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.255
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.074
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.079
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.068
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.031
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.010
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mbox{Beta}(2,7)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.124
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.103
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.066
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.057
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.040
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.043
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $lN(0,1)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.049 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.036
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.018
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.006
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.003
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convergence of the sample distributions for the split point.
 The approximate coordinate search (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Algorithms"

\end_inset

) has been used, but the exact algorithm gives similar results for the small
 
\begin_inset Formula $n$
\end_inset

s.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Even the fastest converging distributions are very slow compared to the
 mean of log-normals.
 We supply some plots of what's going on in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Some plots of what's going on"

\end_inset

.
\end_layout

\begin_layout Standard
Next we study the simplest example of irregular histograms.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/BetaBadApproximation.pdf
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Some plots of what's going on"

\end_inset

Plot of simulated split points with KDE from the 
\begin_inset Formula $\mathtt{locfit}$
\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand citep
key "locfit"

\end_inset

 in orange, the limiting distributions are purple.
 it is clear that the limit distribution will not work well as an approximation.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:(k = 2) distributin, irregular histogram, KL"

\end_inset

We study the special case of 
\begin_inset Formula $k=2$
\end_inset

 for 
\begin_inset Formula $KL$
\end_inset

 weights.
 The Hessian 
\begin_inset Formula $V$
\end_inset

 is 
\begin_inset Formula 
\[
V=\left[\begin{array}{cc}
c_{1} & c_{2}\\
c_{2} & c_{3}
\end{array}\right]
\]

\end_inset

where
\end_layout

\begin_layout Example
\begin_inset Formula 
\begin{eqnarray*}
c_{1} & = & f'(a)(\log\frac{F(a)}{1-F(a)}-\log\frac{a}{1-a})-2f(a)\left(\frac{1}{1-a}+\frac{1}{a}\right)+\frac{1-F(a)}{(1-a)^{2}}+\frac{F(a)}{a^{2}},\\
c_{2} & = & f(a)(\frac{1}{F(a)}+\frac{1}{1-F(a)}),\\
c_{3} & = & -(\frac{1}{F(a)}+\frac{1}{1-F(a)}).
\end{eqnarray*}

\end_inset

The zero-mean Gaussian process is
\end_layout

\begin_layout Example
\begin_inset Formula 
\[
G(h_{1})=dW(h_{1}),
\]

\end_inset

where 
\begin_inset Formula $d=f(a)^{\frac{1}{2}}\left|\log\frac{F(a)}{1-F(a)}-\log\frac{a}{1-a}\right|$
\end_inset

.
 The estimator is 
\begin_inset Formula $\argmax_{h}\frac{1}{2}h^{T}Vh+dW(h_{1})$
\end_inset

.
 As in the previous example, this can can be simplified.
 Use 
\begin_inset Formula $\frac{1}{2}h^{T}Vh=\frac{1}{2}(c_{1}h_{1}^{2}+2c_{2}h_{1}h_{2}+c_{3}h_{2}^{2})$
\end_inset

 and assume 
\begin_inset Formula $h_{1}$
\end_inset

 is known.
 Then the maximum of 
\begin_inset Formula $h_{2}$
\end_inset

 can be found by differentiating the preceding quadratic function, which
 yields 
\begin_inset Formula $h_{2}=-\frac{eh_{1}}{2c_{3}}$
\end_inset

.
 At this point, 
\begin_inset Formula $\frac{1}{2}h^{T}Vh=\frac{1}{2}(ch_{1}^{2}-\frac{c_{2}^{2}h_{1}^{2}}{c_{3}}+\frac{c_{2}^{2}h_{1}^{2}}{4c_{3}})=h_{1}^{2}\cdot\frac{1}{2}(c_{1}-\frac{c_{2}^{2}}{c_{3}}+\frac{c_{2}^{2}}{4c_{3}})$
\end_inset

.
 It follows that whenever 
\begin_inset Formula $h_{1}$
\end_inset

 maximises 
\begin_inset Formula $G(h_{1})+h_{1}^{2}\cdot\frac{1}{2}(c_{1}-\frac{c_{2}^{2}}{c_{3}}+\frac{c_{2}^{2}}{4c_{3}})$
\end_inset

, the maximiser of 
\begin_inset Formula $\frac{1}{2}h^{T}Vh+G(h_{1})$
\end_inset

 is 
\begin_inset Formula $(h_{1},-\frac{c_{2}h_{1}}{2c_{3}})$
\end_inset

.
 Use the Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Chernoff trick"

\end_inset

 to simplify the maximiser of 
\begin_inset Formula $G(h_{1})+h_{1}^{2}\cdot\frac{1}{2}(c-\frac{c_{2}^{2}}{c_{3}}+\frac{c_{2}^{2}}{4c_{3}})$
\end_inset

 further, into 
\begin_inset Formula $(\frac{2d}{(c_{1}-\frac{c_{2}^{2}}{c_{3}}+\frac{c_{2}^{2}}{4c_{3}})})^{\frac{2}{3}}Z$
\end_inset

, where 
\begin_inset Formula $Z$
\end_inset

 is Chernoff's distribution.
 We conclude with 
\begin_inset Formula $n^{\frac{1}{3}}(\widehat{(a,w)}-(a,w))\tod(1,-\frac{c_{2}}{2c_{3}})\left(\frac{dc_{2}^{2}}{c_{1}-3c_{2}^{2}}\right){}^{\frac{2}{3}}Z$
\end_inset

.
 This representation can be used together with the tables from 
\begin_inset CommandInset citation
LatexCommand cite
after "p.9 - 13, table 1 and 3"
key "groeneboom2001computing"

\end_inset

 or home made simulations to calculate the limit distribution, as in the
 previous example.
 Moreover, it allows us to compute quantities like the asymptotic covariance
 between the weight and the split point.
\end_layout

\begin_layout Remark
This is analogous to 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Decision tree asymptotics"

\end_inset

 on decision trees, where 
\begin_inset Formula $n^{\frac{1}{3}}((\widehat{\beta}_{l},\widehat{\beta}_{u},\widehat{d})-(\beta_{l}^{0},\beta_{u}^{0},d^{0}))\tod\argmax_{t}(c_{1},c_{2},1)G(t)$
\end_inset

, for some 
\begin_inset Formula $c_{1},c_{2}$
\end_inset

 and a function 
\begin_inset Formula $G(t)=a't^{2}+b'W(t)$
\end_inset

, where 
\begin_inset Formula $W(t)$
\end_inset

 is a standard Brownian motion starting at 
\begin_inset Formula $0$
\end_inset

.
 The main difference between this regression case and our histograms is
 that our analogue to 
\begin_inset Formula $a_{1}$
\end_inset

, namely 
\begin_inset Formula $w$
\end_inset

, completely determines our analogue to 
\begin_inset Formula $a_{2}$
\end_inset

, namely 
\begin_inset Formula $1-w$
\end_inset

.
 
\end_layout

\begin_layout Subsection
A special case with 
\begin_inset Formula $\sqrt{n}$
\end_inset

-consistency
\begin_inset CommandInset label
LatexCommand label
name "sub:A-special-case"

\end_inset


\end_layout

\begin_layout Standard
Recall assumption A5': 
\begin_inset Formula $\frac{w_{i+1}}{a_{i+1}-a_{i}}=\frac{w_{i}}{a_{i}-a_{i-1}}$
\end_inset

 for each 
\begin_inset Formula $i$
\end_inset

.
 We will translate this condition into something more understandable.
 First we notice that 
\begin_inset Formula $\frac{w_{j}}{a_{j}-a_{j-1}}=\frac{w_{i}}{a_{i}-a_{i-1}}$
\end_inset

 for each 
\begin_inset Formula $j$
\end_inset

 by induction.
 Now we claim that all of these are equal to 
\begin_inset Formula $1$
\end_inset

.
 
\end_layout

\begin_layout Proposition
If 
\begin_inset Formula $\frac{w_{i+1}}{a_{i+1}-a_{i}}=\frac{w_{i}}{a_{i}-a_{i-1}}$
\end_inset

 for every 
\begin_inset Formula $i$
\end_inset

, then 
\begin_inset Formula $\frac{w_{i}}{a_{i}-a_{i-1}}=1$
\end_inset

 for every 
\begin_inset Formula $i$
\end_inset

 as well.
\end_layout

\begin_layout Proof
First assume 
\begin_inset Formula $k=2$
\end_inset

 and recall that 
\begin_inset Formula $w_{2}=1-w_{1}$
\end_inset

.
 Again we use the convention 
\begin_inset Formula $a_{0}=0$
\end_inset

 and 
\begin_inset Formula $a_{k}=1$
\end_inset

.
 Since 
\begin_inset Formula $\log\frac{w_{i+1}}{a_{i+1}-a_{i}}=\log\frac{w_{i}}{a_{i}-a_{i-1}}$
\end_inset

 for each 
\begin_inset Formula $i$
\end_inset

, we have that 
\begin_inset Formula $\frac{w_{1}}{a_{1}}=\frac{1-w_{1}}{1-a_{1}}$
\end_inset

.
 Solving this equation yields 
\begin_inset Formula $w_{1}=a_{1}$
\end_inset

, and 
\begin_inset Formula $\frac{w_{i}}{a_{i}-a_{i-1}}=1$
\end_inset

 as claimed.
 For 
\begin_inset Formula $k\geq2$
\end_inset

, we use induction.
 If it is true for 
\begin_inset Formula $k$
\end_inset

, we consider the distribution 
\begin_inset Formula $F'=a_{k}^{-1}F(a_{k}^{-1}x)$
\end_inset

.
 The rescaled histogram associated with this distribution has weights 
\begin_inset Formula $\frac{w_{i}}{a_{k}}$
\end_inset

 and splits 
\begin_inset Formula $\frac{a_{i}}{a_{k}}$
\end_inset

, hence every 
\begin_inset Formula $\frac{w_{i}/a_{k}}{(a_{i}-a_{i-1})/a_{k}}=\frac{w_{i}}{(a_{i}-a_{i-1})}=1$
\end_inset

 for 
\begin_inset Formula $i=1,...,(k-1)$
\end_inset

 by the induction hypothesis.
 We can do this the other way around, starting from 
\begin_inset Formula $a_{1}$
\end_inset

, in order to get 
\begin_inset Formula $\frac{w_{k}}{a_{k}-a_{k-1}}=1$
\end_inset

 as well.
\end_layout

\begin_layout Standard
It follows that Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Main theorem, Kullback-Leibler"

\end_inset

 can't be used in the case when each block in the histogram has equal probabilit
y as length.
 This can happen for instance when the underlying distribution is symmetric
 and unimodal with 
\begin_inset Formula $k=2$
\end_inset

 and when the underlying distribution is uniform for any 
\begin_inset Formula $k$
\end_inset

.
\end_layout

\begin_layout Standard
We go on to find the shape of the limiting Gaussian process when 
\begin_inset Formula $\frac{w_{i+1}}{a_{i+1}-a_{i}}=\frac{w_{i}}{a_{i}-a_{i-1}}$
\end_inset

 for every 
\begin_inset Formula $i$
\end_inset

.
 In this case, we will have to use the function 
\begin_inset Formula $\phi(\delta)=\sqrt{\delta}$
\end_inset

 in order to find a non-degenerate Gaussian process in the rate theorem
 (page 
\begin_inset CommandInset ref
LatexCommand pageref
reference "thm:rate theorem"

\end_inset

).
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:special case"

\end_inset

Assume conditions (A1-A3,A4,A5').
 In that case, we have
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
\lim_{\delta\searrow0}\frac{P(m_{\theta_{0}+\delta g}-m_{\theta_{0}+\delta h})^{2}}{\delta^{2}}=\sum_{i=1}^{k}P([a_{i-1},a_{i}))\gamma_{i}^{2},
\]

\end_inset

where 
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
\gamma_{i}=\frac{h'{}_{i}-g'{}_{i}}{w_{i}}-\frac{(g_{i}-h_{i})-(g_{i-1}-h_{i-1})}{a_{i}-a_{i-1}}.
\]

\end_inset

Thus condition 
\begin_inset CommandInset ref
LatexCommand vref
reference "eq:Uniformity condition"

\end_inset

 is satisfied for 
\begin_inset Formula $\phi(\delta)=\delta$
\end_inset

.
 Condition 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Gaussian condition"

\end_inset

 is satisfied with 
\begin_inset Formula $G(h)=h^{T}Z$
\end_inset

 for 
\begin_inset Formula $Z\sim N(0,\Sigma)$
\end_inset

, where 
\begin_inset Formula $\Sigma$
\end_inset

 is a symmetric matrix with upper elements 
\begin_inset Formula $\sigma_{i,i}=\frac{P(I_{i})}{\left(a_{i}-a_{i-1}\right)^{2}}+\frac{P(I_{i+1})}{\left(a_{i+1}-a_{i}\right)^{2}},\;\sigma_{i,i+1}=-\frac{P(I_{i+1})}{\left(a_{i+1}-a_{i}\right)^{2}},\;\sigma_{i,i'}=\frac{P(I_{i})}{w_{i}\left(a_{i}-a_{i-1}\right)}\;\sigma_{i,(i+1)'}=-\frac{P(I_{i+1})}{w_{i+1}\left(a_{i+1}-a_{i}\right)}\;\sigma_{i',i'}=\frac{1}{w_{i}^{2}}$
\end_inset

.
 Here the primed elements correspond to variable weights; they can be disregarde
d when using constant weights.
 Then 
\begin_inset Formula 
\[
\sqrt{n}(\widehat{(a,w)}-(a,w))\stackrel{d}{\to}N(0,V^{-1}\Sigma V^{-1}),
\]

\end_inset

where 
\begin_inset Formula $V$
\end_inset

 is given in Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Matrix elements of histogram distribution"

\end_inset

.
\end_layout

\begin_layout Proof
This is a slight modification of the proof in Theorem 
\begin_inset CommandInset ref
LatexCommand vref
reference "thm:Covariance structure, KL"

\end_inset

: Instead of finding the terms involving 
\begin_inset Formula $\delta$
\end_inset

, we will search out the terms involving 
\begin_inset Formula $\delta^{2}$
\end_inset

.
 In 
\begin_inset Formula $A_{1}$
\end_inset

 and 
\begin_inset Formula $A_{2}$
\end_inset

, the only terms involving 
\begin_inset Formula $\delta^{2}$
\end_inset

 also involved 
\begin_inset Formula $\log\frac{w_{j}}{a_{j}-a_{j-1}}$
\end_inset

 for some 
\begin_inset Formula $j$
\end_inset

, but these are equal to 
\begin_inset Formula $0$
\end_inset

 by the previous proposition.
 Similarly, all terms of 
\begin_inset Formula $A_{3},A_{4}$
\end_inset

 and 
\begin_inset Formula $A_{5}$
\end_inset

 containing 
\begin_inset Formula $\log\frac{w_{j}}{a_{j}-a_{j-1}}$
\end_inset

 can be disregarded.
 This leaves the terms containing 
\begin_inset Formula $\delta^{2}$
\end_inset

 in 
\begin_inset Formula $\sum_{i=1}^{k}P([a_{i-1},a_{i}))\left[C_{i}^{g}(\delta)C_{i}^{h}(\delta)+C_{i}^{h}(\delta)C_{i}^{h}(\delta)-2C_{i}^{g}(\delta)C_{i}^{g}(\delta)\right]$
\end_inset

:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
 &  & \sum_{i=1}^{k}P([a_{i-1},a_{i}))\left(\frac{\delta h'{}_{i}}{w_{i}}-\frac{\delta(h_{i}-h_{i-1})}{a_{i}-a_{i-1}}\right)^{2}\\
 & + & \sum_{i=1}^{k}P([a_{i-1},a_{i}))\left(\frac{\delta g'{}_{i}}{w_{i}}-\frac{\delta(g_{i}-g_{i-1})}{a_{i}-a_{i-1}}\right)^{2}\\
 & - & 2\sum_{i=1}^{k}P([a_{i-1},a_{i}))\left(\frac{\delta h'{}_{i}}{w_{i}}-\frac{\delta(h_{i}-h_{i-1})}{a_{i}-a_{i-1}}\right)\left(\frac{\delta g'{}_{i}}{w_{i}}-\frac{\delta(g_{i}-g_{i-1})}{a_{i}-a_{i-1}}\right).
\end{eqnarray*}

\end_inset

which clearly simplifies to
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\delta^{2}\sum_{i=1}^{k}P([a_{i-1},a_{i}))\left(\frac{h'{}_{i}-g'{}_{i}}{w_{i}}-\frac{(g_{i}-h_{i})-(g_{i-1}-h_{i-1})}{a_{i}-a_{i-1}}\right)^{2}.
\]

\end_inset

The covariance kernel of the limiting Gaussian process is 
\begin_inset Formula 
\[
E(G(h)G(g))=\sum_{i=1}^{k}P([a_{i-1},a_{i}))\left(\frac{\delta h'{}_{i}}{w_{i}}-\frac{\delta(h_{i}-h_{i-1})}{a_{i}-a_{i-1}}\right)\left(\frac{\delta g'{}_{i}}{w_{i}}-\frac{\delta(g_{i}-g_{i-1})}{a_{i}-a_{i-1}}\right).
\]

\end_inset

Let 
\begin_inset Formula $G(h)=h^{T}Z$
\end_inset

, where 
\begin_inset Formula $Z\sim N(0,\Sigma)$
\end_inset

 with 
\begin_inset Formula $\Sigma$
\end_inset

 as in the statement of the theorem.
 Then it can be verified that this is the right process by calculating 
\begin_inset Formula $E(h^{T}Z(g^{T}Z))=h^{T}\Sigma g$
\end_inset

.
 We write 
\begin_inset Formula $\Sigma g$
\end_inset

 in the form of linear combinations of column vectors: 
\begin_inset Formula 
\begin{eqnarray*}
h^{T}\Sigma g & = & (h_{1},...h_{k-1},h'_{1},...h'_{k-1})(\Sigma_{1}g_{1},...\Sigma_{k-1}g_{k-1},\Sigma_{k}g'_{1},...\Sigma_{2k-2}g'_{k-1})\\
 & = & \sum_{i=1}^{k}P(I_{i})\left(\frac{h'{}_{i}}{w_{i}}-\frac{(h_{i}-h_{i-1})}{a_{i}-a_{i-1}}\right)\left(\frac{g'{}_{i}}{w_{i}}-\frac{(g_{i}-g_{i-1})}{a_{i}-a_{i-1}}\right).
\end{eqnarray*}

\end_inset

To find this 
\begin_inset Formula $\Sigma$
\end_inset

 we rewrite the sum slightly:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
 &  & \sum_{i=1}^{k-1}g_{i}(-h_{i-1}\frac{P(I_{i})}{\left(a_{i}-a_{i-1}\right)^{2}}+h_{i}\left(\frac{P(I_{i})}{\left(a_{i}-a_{i-1}\right)^{2}}+\frac{P(I_{i+1})}{\left(a_{i+1}-a_{i}\right)^{2}}\right)\\
 &  & -h_{i+1}\frac{P(I_{i+1})}{\left(a_{i+1}-a_{i}\right)^{2}}+\frac{P(I_{i})h'_{i}}{w_{i}\left(a_{i}-a_{i-1}\right)}-\frac{P(I_{i+1})h'_{i+1}}{w_{i+1}\left(a_{i+1}-a_{i}\right)})\\
 & + & \sum_{i=1}^{k-1}g'_{i}\left[\frac{h'_{i}}{w_{i}^{2}}+\frac{P(I_{i})h_{i-1}}{w_{i}\left(a_{i-1}-a_{i}\right)}-\frac{P(I_{i})h{}_{i}}{w_{i}\left(a_{i}-a_{i-1}\right)}\right],
\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $h_{0}=g_{0}=h_{k}=g_{k}=0$
\end_inset

.
 This gives us the covariance matrix with elements described above.
 The limiting distribution of 
\begin_inset Formula $\sqrt{n}(\widehat{(a,w)}-(a,w))$
\end_inset

 is the maximiser of 
\begin_inset Formula $\frac{1}{2}h^{T}Vh+h^{T}Z$
\end_inset

.
 Differentiation with respect to 
\begin_inset Formula $h$
\end_inset

 gives 
\begin_inset Formula $Vh+Z=0$
\end_inset

, hence 
\begin_inset Formula $\widehat{h}=V^{-1}Z\sim N(0,V^{-1}\Sigma V^{-1})$
\end_inset

 as claimed.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Uniform distribution histogram"

\end_inset

Let 
\begin_inset Formula $F=\mathcal{U}(0,1)$
\end_inset

 and 
\begin_inset Formula $k\geq2$
\end_inset

.
 If constant weights are used, each 
\begin_inset Formula $a_{i}-a_{i-1}=\frac{1}{k}$
\end_inset

 and 
\begin_inset Formula $P(I_{i})=\frac{1}{k}$
\end_inset

, hence 
\begin_inset Formula $\sigma_{i,i-1}=\sigma_{i,i+1}=-k$
\end_inset

 and 
\begin_inset Formula $\sigma_{i,i}=2k$
\end_inset

.
 As for 
\begin_inset Formula $V$
\end_inset

, 
\begin_inset Formula $v_{ii}=-2k$
\end_inset

 and 
\begin_inset Formula $V_{i,i+1}=V_{i,i-1}=k$
\end_inset

.
 Hence the maximiser is 
\begin_inset Formula $N_{k}(0,V^{-1}\Sigma V^{-1})=N_{k}(0,V^{-1})$
\end_inset

-distributed.
 It can be shown by recursion that 
\begin_inset Formula $V_{ij}^{-1}=\frac{(k-j)i}{k^{2}}$
\end_inset

 when 
\begin_inset Formula $j\geq i$
\end_inset

.
 Recall Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Histograms on quantiles"

\end_inset

 on the asymptotic distribution of quantiles, where it is stated that 
\begin_inset Formula $\sqrt{n}(\widehat{q}-q)\tod N(0,\Sigma)$
\end_inset

 where 
\begin_inset Formula $\Sigma_{ij}=\frac{(k-j)i}{k^{2}f(q_{(i)})f(q_{(j)})}=\frac{(k-j)i}{k^{2}}$
\end_inset

.
 It follows that these two approaches are asymptotically equivalent in the
 context of the uniform distribution.
 Histograms with variable weights will not be unique in this setting.
\end_layout

\begin_layout Example
Clearly, it would be silly to use the 
\begin_inset Formula $KL$
\end_inset

-histogram with constant weights in order to estimate the quantiles of a
 uniform distribution.
 This is a bad idea for several reasons (of descending importance): 1.) If
 we know that the underlying distribution is in fact uniform, it would be
 far wiser and more efficient to use 
\begin_inset Formula $k^{-1},2k^{-1},...,(k-1)k^{-1}$
\end_inset

 as the quantiles.
 2.) This only works if the underlying distribution is, in fact, uniform
 on 
\begin_inset Formula $[0,1]$
\end_inset

.
 If it isn't, the split points will not converge to the quantiles.
 3.) Following the theme of slow convergence, the covariance matrix of the
 split points takes a very long time to come appreciably close to the covariance
 matrix of the quantiles.
 we will investigate this in the next example.
\end_layout

\begin_layout Standard
Another example is the case of a symmetric distributions for 
\begin_inset Formula $k=2$
\end_inset

.
 We tacitly assume the existence of a unique, well-separated maximum, hence
 
\begin_inset Formula $a=0.5$
\end_inset

 by symmetry.
 The maximum is typically not unique when we use variable weight histograms,
 hence we use constant weight histograms in the next example.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Unimodal symmetric distributions"

\end_inset

 Since 
\begin_inset Formula $k=2$
\end_inset

, the matrix 
\begin_inset Formula $\Sigma$
\end_inset

 simplifies to 
\begin_inset Formula $\frac{1/2}{(1/2)^{2}}+\frac{1/2}{(1/2)^{2}}=4$
\end_inset

, hence the asymptotic variance is 
\begin_inset Formula $4V^{-2}=\frac{1}{4}(2f(0.5)-1)^{-2}$
\end_inset

.
 An illustration of the rate of convergence for 
\begin_inset Formula $\mbox{Beta}(3,3$
\end_inset

) can be seen in Figure 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:Example-of--convergence"

\end_inset

.
 As seen in Figure 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:variance ratios"

\end_inset

, the convergence (to 
\begin_inset Formula $0.5$
\end_inset

) is remarkably slow, with the practical consequence that the variance is
 larger than this for finite sample sizes.
 The decay of the ratio between the empirical and limiting variance appears
 to be of the form 
\begin_inset Formula $n^{-\frac{1}{3}}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/Beta(3,3)degenerate.pdf
	scale 30

\end_inset


\begin_inset Graphics
	filename OppgaveR/B(3,3)meansandmedians.pdf
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-of--convergence"

\end_inset

Example of 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

-convergence to a degenerate distribution, 
\begin_inset Formula $F=\mbox{Beta}(3,3)$
\end_inset

.
 However, it is non-degenerate for the 
\begin_inset Formula $\sqrt{n}$
\end_inset

-rate.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/VarianceRatioBeta(2,2).pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:variance ratios"

\end_inset

Plot of the empirical variances divided by the limit variance for the 
\begin_inset Formula $\sqrt{n}$
\end_inset

-rescaled split points for the 
\begin_inset Formula $k=2$
\end_inset

 quantile histogram with 
\begin_inset Formula $F=\mbox{Beta}(2,2)$
\end_inset

, 
\begin_inset Formula $n=100,200,...,4900,5000$
\end_inset

.
 The blue line is fitted by ordinary linear regression, 
\begin_inset Formula $R=\beta_{0}+\beta_{1}n^{-\frac{1}{3}}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Theorem 
\begin_inset CommandInset ref
LatexCommand vref
reference "thm:special case"

\end_inset

 illustrates the power of the rate theorem.
 It is relatively easy to notice how the special case behaves, as all the
 information about the convergence rate lies in which function 
\begin_inset Formula $\phi^{2}(\delta)$
\end_inset

 we can use to divide the function 
\begin_inset Formula $P(m_{\theta_{0}+\delta g}-m_{\theta_{0}+\delta h})^{2}$
\end_inset

 with and still have it 
\begin_inset Quotes eld
\end_inset

under control
\begin_inset Quotes erd
\end_inset

.
 It is also interesting that the symmetry condition on the 
\begin_inset Formula $\frac{w_{i}}{a_{i+1}-a_{i}}$
\end_inset

s has such a profound effect on the convergence rate.
 Still, the convergence to the limiting distribution is very slow.
\end_layout

\begin_layout Subsection
\begin_inset Formula $L_{2}$
\end_inset

-histograms
\end_layout

\begin_layout Standard
The methods and results for 
\begin_inset Formula $L_{2}$
\end_inset

 histograms are very similar to those of 
\begin_inset Formula $KL$
\end_inset

-histograms, and we are content with simply stating the analogues of the
 two main theorems (
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Covariance structure, KL"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Main theorem, Kullback-Leibler"

\end_inset

) on Kullback-Leibler histograms.
 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:Covariance structure, L2"

\end_inset

Let 
\begin_inset Formula $m_{(a,w)}=\sum_{i=1}^{k}\left[\frac{2w_{i}}{a_{i}-a_{i-1}}1_{[a_{i-1},a_{i})}(x)-\frac{w_{i}^{2}}{a_{i}-a_{i-1}}\right]$
\end_inset

 be the objective associated with the 
\begin_inset Formula $L_{2}$
\end_inset

 histogram with either variable or constant weights 
\begin_inset Formula $w_{j}$
\end_inset

.
 Denote the least false vectors by 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $w$
\end_inset

, and let 
\begin_inset Formula $f$
\end_inset

 be the density of 
\begin_inset Formula $P$
\end_inset

.
 Provided the conditions (A1-A5) are satisfied and 
\begin_inset Formula $f\in L_{2}$
\end_inset

, the following is true:
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
\lim_{\delta\searrow0}\frac{\mathbb{P}\left(m_{(a,w)+\delta(g,g')}-m_{(a,w)+\delta(h,h')}\right)^{2}}{\delta}=4\sum_{i=1}^{k-1}f(a_{i})\left(\frac{w_{i+1}}{a_{i+1}-a_{i}}-\frac{w_{i}}{a_{i}-a_{i-1}}\right)^{2},
\]

\end_inset

thus condition 
\begin_inset CommandInset ref
LatexCommand vref
reference "eq:Uniformity condition"

\end_inset

 is satisfied for 
\begin_inset Formula $\phi(\delta)=\sqrt{\delta}$
\end_inset

.
 Furthermore, condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Gaussian condition"

\end_inset

 is satisfied with
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\begin{equation}
G(h)=2\sum_{i=1}^{k-1}f(a_{i})^{\frac{1}{2}}\left|\frac{w_{i+1}}{a_{i+1}-a_{i}}-\frac{w_{i}}{a_{i}-a_{i-1}}\right|W_{i}(h_{i})\label{eq:Gaussian process (irregular histogram) (L2)}
\end{equation}

\end_inset

 where 
\begin_inset Formula $W_{i}$
\end_inset

 are independent standard Brownian motions.
\end_layout

\begin_layout Standard
The factor 
\begin_inset Formula $2$
\end_inset

 in 
\begin_inset Formula $G(h)$
\end_inset

 is a side-effect of the definition of 
\begin_inset Formula $m_{(a,w)}^{L_{2}}$
\end_inset

; it wouldn't have been there if the we had opted to divide the criterion
 function by 
\begin_inset Formula $2$
\end_inset

.
 Evidently, this only has an effect on the size of the limit process, not
 on the actual argmax, but might be considered if one wants the limiting
 processes of the Kullback-Leibler histogram and the 
\begin_inset Formula $L_{2}$
\end_inset

-histogram to look more alike.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:Main theorem, L2"

\end_inset

Assume conditions A1-A5 are satisfied.
 The rescaled process 
\begin_inset Formula $n^{\frac{2}{3}}(P_{n}m_{(a,w)+n^{-\frac{1}{3}}\widehat{(a,w)}}-P_{n}m_{(a,w)})$
\end_inset

 converges in distribution to 
\begin_inset Formula $\frac{1}{2}h^{T}Vh+G(h)$
\end_inset

, where 
\begin_inset Formula $G(h)$
\end_inset

 is the Gaussian process 
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\[
G(h)=2\sum_{i=1}^{k-1}f(a_{i})^{\frac{1}{2}}\left|\frac{w_{i+1}}{a_{i+1}-a_{i}}-\frac{w_{i}}{a_{i}-a_{i-1}}\right|W_{i}(h_{i}),
\]

\end_inset

with 
\begin_inset Formula $w_{i}=P([a_{i-1},a_{i}))$
\end_inset

 in the case of variable weights, and the predefined 
\begin_inset Formula $w_{i}$
\end_inset

 otherwise, and 
\begin_inset Formula $V$
\end_inset

 is the Hessian of 
\begin_inset Formula $Pm_{(a,w)}$
\end_inset

 at 
\begin_inset Formula $(a,w)$
\end_inset

.
 The minimum 
\begin_inset Formula $L_{2}$
\end_inset

 estimate converges with rate 
\begin_inset Formula $n^{\frac{1}{3}}$
\end_inset

 and its limiting distribution is given by
\begin_inset Formula 
\[
n^{\frac{1}{3}}(\widehat{(a,w)}-(a,w))\tod\argmax_{h}\frac{1}{2}h^{T}Vh+G(h),
\]

\end_inset

where 
\begin_inset Formula $V$
\end_inset

 is the Hessian of 
\begin_inset Formula $Pm_{(a,w)}$
\end_inset

.
 
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:(k = 2) distribution, quantile histogram, L2"

\end_inset

This is the 
\begin_inset Formula $L_{2}$
\end_inset

-analogue of Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:(k = 2) distribution, quantile histogram, KL"

\end_inset

, where we study the constant weight histogram with 
\begin_inset Formula $k=2$
\end_inset

.
 The limit objective is
\begin_inset Formula $Pm_{a}=\frac{1}{a}(F(a)-\frac{1}{4})+\frac{1}{1-a}(\frac{3}{4}-F(a)),$
\end_inset

 whose first derivative with respect to 
\begin_inset Formula $a$
\end_inset

 is 
\begin_inset Formula 
\[
f(a)\left[\frac{1}{a}-\frac{1}{1-a}\right]-F(a)\left[\frac{1}{(1-a)^{2}}+\frac{1}{a^{2}}\right]-4\left[\frac{3}{(1-a)^{2}}+\frac{1}{a^{2}}\right],
\]

\end_inset

and the second derivative is
\end_layout

\begin_layout Example
\begin_inset Formula 
\[
V=f'(a)\left[\frac{1}{a}-\frac{1}{1-a}\right]-2f(a)\left[\frac{1}{(1-a)^{2}}+\frac{1}{a^{2}}\right]+\frac{2(F(a)-\frac{1}{4})}{a^{3}}+\frac{2(\frac{3}{4}-F(a)}{(1-a)^{3}}.
\]

\end_inset

Put 
\begin_inset Formula $G(h)=f(a)^{\frac{1}{2}}\left|\frac{1}{a}-\frac{1}{1-a}\right|W(h)=dW(h)$
\end_inset

, and the limiting distribution is 
\begin_inset Formula $\argmax_{h}\frac{1}{2}Vh^{2}+dW(h)$
\end_inset

.
 Again using Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Chernoff trick"

\end_inset

, we find that 
\begin_inset Formula $n^{\frac{1}{3}}(\widehat{a}-a)\tod\frac{2d}{V}{}^{-\frac{2}{3}}Z$
\end_inset

, where 
\begin_inset Formula $Z=\argmax_{h}W(h)-h^{2}$
\end_inset

 is Chernoff's distribution.
 
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard

\end_layout

\begin_layout Section
Algorithms
\begin_inset CommandInset label
LatexCommand label
name "sec:Algorithms"

\end_inset


\end_layout

\begin_layout Standard
Many, if not most, optimisation problems in statistics can be solved by
 numerical packages tailored toward solving problems with smooth objective
 functions.
 The prototypical example is using Newton-Raphson to solve the maximum likelihoo
d problem for a gamma distributed random variable.
 Using such procedures works very well, provided the objective function
 is sufficiently smooth and concave.
 In the case of irregular histograms, we have neither --- our objective
 function has many local maxima and has jump discontinuities all over the
 place.
 Instead, we need combinatorial optimisation.
\end_layout

\begin_layout Standard
We describe three algorithms: 
\end_layout

\begin_layout Enumerate
An exact algorithm based on 
\emph on
dynamic programming
\emph default
 (see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
after "chap. 10"
key "weiss1998data"

\end_inset

).
 This is essentially the same as the algorithm described in 
\begin_inset CommandInset citation
LatexCommand cite
key "rozenholc2010combining"

\end_inset

 (first in 
\begin_inset CommandInset citation
LatexCommand cite
key "kanazawa1988optimal"

\end_inset

).
 Our new contribution is to solve the problem for all combinations of Kullback-L
eibler, 
\begin_inset Formula $L_{2}$
\end_inset

, and variable or equal weights, while 
\begin_inset CommandInset citation
LatexCommand citeauthor
key "rozenholc2010combining"

\end_inset

 only considered Kullback-Leibler irregular histograms with variable weights.
 Unfortunately, this algorithm runs in approximately quadratic time, namely
 
\begin_inset Formula $O(n^{2}k)$
\end_inset

.
\end_layout

\begin_layout Enumerate
A coordinate search algorithm.
 This usually runs linearly in 
\begin_inset Formula $n$
\end_inset

, and has worst case complexity bounded by 
\begin_inset Formula $O(n\log n)$
\end_inset

 in our implementation.
 This is an approximation algorithm, but simulation studies indicate that
 its performance is satisfactory, which leads us to recommend it above the
 dynamic programming algorithm.
 When pre-smoothing, bootstrapping or running simulation studies, the gain
 in processing time is significant.
 Unfortunately, it doesn't perform well for the CIC of Section 
\begin_inset CommandInset ref
LatexCommand vref
reference "sec:Information-criteria"

\end_inset

.
\end_layout

\begin_layout Enumerate
As was the case for Manski's estimator, we can recast the problem as a mixed
 integer programming problem.
 We will not make use of this formulation.
\end_layout

\begin_layout Standard
The first two algorithms are implemented in 
\begin_inset Formula $\mathtt{C++}$
\end_inset

, with code in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Histogram"

\end_inset

, and made available in 
\begin_inset Formula $\mathtt{R}$
\end_inset

 through the 
\begin_inset Formula $\mathtt{Rcpp}$
\end_inset

-package 
\begin_inset CommandInset citation
LatexCommand citep
key "Rcpp"

\end_inset

.
 Let 
\begin_inset Formula $\{x_{1},x_{2},...,x_{n}\}$
\end_inset

 be the set of observations.
 We take note of this important fact,
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Equal weights
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $KL/L_{2}$
\end_inset

 weights
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $KL$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\log\frac{k^{-1}}{x_{i}-x_{j}}P_{n}[x_{j},x_{i})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\log\frac{P_{n}[x_{j},x_{i})}{x_{i}-x_{j}}P_{n}[x_{j},x_{i})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{2P_{n}[x_{j},x_{i})-k^{-1}}{x_{i}-x_{j}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{P_{n}[x_{j},x_{i})}{x_{i}-x_{j}}P_{n}[x_{j},x_{i})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Histogram weights"

\end_inset

Definitions of 
\begin_inset Formula $R$
\end_inset

 for different choices of histogram methods.
 Recall that the objective function for the 
\begin_inset Formula $L_{2}$
\end_inset

-histogram is 
\begin_inset Formula $\sum_{i=1}^{k}w_{i}\frac{(2P(a_{i-1},a_{i})-w_{i})}{a_{i-1}-a_{i}}$
\end_inset

.
 We remove a redundant 
\begin_inset Formula $k^{-1}$
\end_inset

 for the constant weights and contract 
\begin_inset Formula $2P(a_{i-1},a_{i})-w_{i}=P(a_{i-1},a_{i})$
\end_inset

 for the variable weights.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Proposition
For any irregular histogram, the solution set is a subset of 
\begin_inset Formula $\{x_{1},x_{2},...,x_{n}\}$
\end_inset

, provided the probabilities 
\begin_inset Formula $P_{n}[x_{j},x_{i})$
\end_inset

 involved in the sum are substituted with 
\begin_inset Formula $P_{n}[x_{j}.x_{i}]$
\end_inset

.
\end_layout

\begin_layout Proof
Assume 
\begin_inset Formula $a_{1},...,a_{k-1}$
\end_inset

 are the solutions, and put 
\begin_inset Formula $a_{0}=0,a_{k}=1$
\end_inset

 .
 Choose a 
\begin_inset Formula $j$
\end_inset

, and notice that the only part of the objective function that depends on
 
\begin_inset Formula $a_{j}$
\end_inset

 is
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
R(a_{j-1},a_{j})+R(a_{j},a_{j+1}),
\]

\end_inset

where 
\begin_inset Formula $R$
\end_inset

 is chosen from table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Histogram weights"

\end_inset

 of histogram weights.
 Hence it suffices to show that this is maximised for an 
\begin_inset Formula $x\in\{x_{1},x_{2},...,x_{n}\}$
\end_inset

.
 Let 
\begin_inset Formula $x_{l}$
\end_inset

 and 
\begin_inset Formula $x_{u}$
\end_inset

 be the greatest lower bound and least upper bound of 
\begin_inset Formula $a_{j}$
\end_inset

 in 
\begin_inset Formula $\{x_{1},x_{2},...,x_{n}\}$
\end_inset

, respectively, so we know that 
\begin_inset Formula $a_{j}\in[x_{l},x_{u}]$
\end_inset

.
 Assume 
\begin_inset Formula $R(x_{j},x_{i})=\log\frac{P_{n}[x_{j},x_{i})}{x_{i}-x_{j}}P_{n}[x_{j},x_{i})]$
\end_inset

 for concreteness, and notice that
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{eqnarray*}
 &  & R(a_{j-1},a_{j})+R(a_{j},a_{j+1})\\
 & = & P_{n}[a_{j-1},x_{l}]\log\frac{P_{n}[a_{j-1},x_{l}]}{a_{j}-a_{j-1}}+P_{n}[x_{u},a_{j+1}]\log\frac{P_{n}[x_{u},a_{j+1}]}{a_{j+1}-a_{j}},
\end{eqnarray*}

\end_inset

hence we reduce the problem to the maximisation of 
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{equation}
g(a_{j})=-p_{1}\log(a_{j}-a_{j-1})-p_{2}\log(a_{j+1}-a_{j}),\label{eq:Modified R}
\end{equation}

\end_inset

where 
\begin_inset Formula $p_{1}=P_{n}[a_{j-1},x_{l}]$
\end_inset

 and 
\begin_inset Formula $p_{2}=P_{n}[x_{u},a_{j+1}]$
\end_inset

.
 For simplicity, extend the candidate solution set to 
\begin_inset Formula $[x_{l},x_{u}]$
\end_inset

.
 By differentiating 
\begin_inset Formula $g$
\end_inset

 twice we obtain 
\begin_inset Formula $g''(a_{j})=\frac{p_{1}}{(a_{j}-a_{j-1})^{2}}+\frac{p_{2}}{(a_{j+1}-a_{j})^{2}}>0$
\end_inset

, hence 
\begin_inset Formula $g$
\end_inset

 is strictly convex, and it attains its maximum on either 
\begin_inset Formula $x_{l}$
\end_inset

 or 
\begin_inset Formula $x_{u}$
\end_inset

.
 For the other choices of 
\begin_inset Formula $R$
\end_inset

, the argument is similar: Differentiate twice in order to find that the
 
\begin_inset Formula $R$
\end_inset

-analogue of the modified function in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Modified R"

\end_inset

 is strictly convex.
\end_layout

\begin_layout Standard
The proposition would not be true if we were to use 
\begin_inset Formula $P_{n}[x_{j},x_{i})$
\end_inset

 or 
\begin_inset Formula $P_{n}(x_{j},x_{i}]$
\end_inset

 in our table, as that would make it possible for the objective function
 to jump down at the boundary.
 In this case, the maximum would either fail to exist (get bigger and bigger
 the closer it gets to 
\begin_inset Formula $x_{u}$
\end_inset

 or 
\begin_inset Formula $x_{l}$
\end_inset

) or be the 
\begin_inset Formula $x\in\{x_{u},x_{l}\}$
\end_inset

 which we thought of as sub maximal in the previous proposition.
 Either way, it makes sense to search the observations for a maximiser in
 these cases as well.
 Since all these options are asymptotically equivalent and don't make much
 of a difference in practice, we will restrict our search of optima to the
 data points.
 
\end_layout

\begin_layout Subsection
Dynamic programming
\end_layout

\begin_layout Quote
[There are] two sledgehammers of the algorithms craft, dynamic programming
 and linear programming, techniques of very broad applicability that can
 be invoked when more specialized methods fail.
 Predictably, this generality often comes with a cost in efficiency.
\end_layout

\begin_layout Quote
\align right
\begin_inset CommandInset citation
LatexCommand citet
key "dasgupta2006algorithms"

\end_inset


\end_layout

\begin_layout Standard
We will transform the optimisation problem into the graph theoretic problem
 of finding the longest path of a weighted acyclic digraph, which is an
 archetypical problem in dynamic programming 
\begin_inset CommandInset citation
LatexCommand citep
after "chap. 6"
key "dasgupta2006algorithms"

\end_inset

; one which every other problem solvable by dynamic programming can be reduced
 to.
 Define, for any set 
\begin_inset Formula $x_{1},...,x_{n}$
\end_inset

 of points in 
\begin_inset Formula $[0,1]$
\end_inset

, choice of 
\begin_inset Formula $k\in\mathbb{N}^{+}$
\end_inset

and histogram type from Table 
\begin_inset CommandInset ref
LatexCommand vref
reference "tab:Histogram weights"

\end_inset

 the associated weighted digraph 
\begin_inset Formula $\Gamma$
\end_inset

 as follows: Make 
\begin_inset Formula $k$
\end_inset

 sets 
\begin_inset Formula $A_{i}$
\end_inset

 --- which we call levels --- of vertices which contains independent copies
 of the 
\begin_inset Formula $n-k+1$
\end_inset

 points 
\begin_inset Formula $x_{i},x_{i+1},x_{k-i+1}$
\end_inset

.
 Let 
\begin_inset Formula $x_{0}=0$
\end_inset

 and 
\begin_inset Formula $x_{n+1}=1$
\end_inset

 be source and sink vertices, and put 
\begin_inset Formula $V=\bigcup_{i=1}^{k}A_{i}\cup x_{0}\cup x_{n+1}$
\end_inset

.
 We define the set 
\begin_inset Formula $E$
\end_inset

 of edges as follows: 
\begin_inset Formula $(x_{0},y)\in E$
\end_inset

 for all 
\begin_inset Formula $y\in A_{1}$
\end_inset

, and 
\begin_inset Formula $(y,x_{n+1})\in E$
\end_inset

 for all 
\begin_inset Formula $y\in A_{k}$
\end_inset

.
 In addition, a tuple 
\begin_inset Formula $(u,v)$
\end_inset

 is in 
\begin_inset Formula $E$
\end_inset

 if the following conditions are satisfied: (1) There is an 
\begin_inset Formula $i$
\end_inset

 such that 
\begin_inset Formula $u\in A_{i}$
\end_inset

 and 
\begin_inset Formula $v\in A_{i+1}$
\end_inset

, (2) If 
\begin_inset Formula $u$
\end_inset

 is a copy of 
\begin_inset Formula $x_{i}$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 a copy of 
\begin_inset Formula $x_{j}$
\end_inset

, then 
\begin_inset Formula $i>j$
\end_inset

.
 Figure 4.6.1 contains an example.
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{figure}[h]
\end_layout

\begin_layout Plain Layout


\backslash
begin{centre}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tikzpicture}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
tikzset{vertex/.style = {shape=rectangle,draw,minimum size=1.5em}}
\end_layout

\begin_layout Plain Layout


\backslash
tikzset{edge/.style = {->}}
\end_layout

\begin_layout Plain Layout


\backslash
tikzset{redge/.style = {->,red,thick}}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% vertices
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node              at  (10,11){$A_{4}$};
\end_layout

\begin_layout Plain Layout


\backslash
node              at  (7.5,11){$A_{3}$};
\end_layout

\begin_layout Plain Layout


\backslash
node              at  (5,11){$A_{2}$};
\end_layout

\begin_layout Plain Layout


\backslash
node              at  (2.5,11){$A_{1}$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (source) at (0,7) {$0$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (a1) at  (10,1) {$x_{10}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (a2) at  (10,2) {$x_{9}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (a3) at  (10,3) {$x_{8}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (a4) at  (10,4) {$x_{7}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (a5) at  (10,5) {$x_{6}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (a6) at  (10,6) {$x_{5}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (a7) at  (10,7) {$x_{4}$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (b1) at  (7.5,2) {$x_{9}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (b2) at  (7.5,3) {$x_{8}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (b3) at  (7.5,4) {$x_{7}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (b4) at  (7.5,5) {$x_{6}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (b5) at  (7.5,6) {$x_{5}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (b6) at  (7.5,7) {$x_{4}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (b7) at  (7.5,8) {$x_{3}$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (c1) at  (5,3) {$x_{8}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (c2) at  (5,4) {$x_{7}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (c3) at  (5,5) {$x_{6}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (c4) at  (5,6) {$x_{5}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (c5) at  (5,7) {$x_{4}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (c6) at  (5,8) {$x_{3}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (c7) at  (5,9) {$x_{2}$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (d1) at  (2.5,4) {$x_{7}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (d2) at  (2.5,5) {$x_{6}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (d3) at  (2.5,6) {$x_{5}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (d4) at  (2.5,7) {$x_{4}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (d5) at  (2.5,8) {$x_{3}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (d6) at  (2.5,9) {$x_{2}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (d7) at  (2.5,10) {$x_{1}$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[vertex] (sink) at (12.5,4) {$1$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (source) to (d1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (source) to (d2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (source) to (d3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (source) to (d4);
\end_layout

\begin_layout Plain Layout


\backslash
draw[redge] (source) to (d5);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (source) to (d6);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (source) to (d7);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d7) to (c1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d7) to (c2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d7) to (c3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d7) to (c4);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d7) to (c5);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d7) to (c6);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d7) to (c7);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d6) to (c1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d6) to (c2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d6) to (c3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d6) to (c4);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d6) to (c5);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d6) to (c6);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d5) to (c1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d5) to (c2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d5) to (c3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[redge] (d5) to (c4);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d5) to (c5);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d4) to (c1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d4) to (c2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d4) to (c3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d4) to (c4);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d3) to (c1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d3) to (c2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d3) to (c3);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d2) to (c1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d2) to (c2);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (d1) to (c1);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c7) to (b1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c7) to (b2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c7) to (b3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c7) to (b4);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c7) to (b5);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c7) to (b6);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c7) to (b7);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c6) to (b1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c6) to (b2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c6) to (b3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c6) to (b4);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c6) to (b5);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c6) to (b6);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c5) to (b1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c5) to (b2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c5) to (b3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c5) to (b4);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c5) to (b5);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c4) to (b1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c4) to (b2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c4) to (b3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[redge] (c4) to (b4);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c3) to (b1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c3) to (b2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c3) to (b3);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c2) to (b1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c2) to (b2);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (c1) to (b1);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b7) to (a1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b7) to (a2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b7) to (a3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b7) to (a4);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b7) to (a5);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b7) to (a6);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b7) to (a7);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b6) to (a1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b6) to (a2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b6) to (a3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b6) to (a4);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b6) to (a5);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b6) to (a6);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b5) to (a1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b5) to (a2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b5) to (a3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b5) to (a4);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b5) to (a5);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[redge] (b4) to (a1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b4) to (a2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b4) to (a3);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b4) to (a4);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b3) to (a1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b3) to (a2);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b3) to (a3);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b2) to (a1);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b2) to (a2);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (b1) to (a1);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a7) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a7) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a7) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a7) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a7) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a7) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a7) to (sink);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a6) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a6) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a6) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a6) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a6) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a6) to (sink);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a5) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a5) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a5) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a5) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a5) to (sink);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a4) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a4) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a4) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a4) to (sink);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a3) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a3) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a3) to (sink);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a2) to (sink);
\end_layout

\begin_layout Plain Layout


\backslash
draw[edge] (a2) to (sink);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw[redge] (a1) to (sink);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\begin_layout Plain Layout


\backslash
caption{An example of an associated graph $
\backslash
Gamma$ with 10 observations and $k=5$.
 The red path is a hypothetical solution path.}
\end_layout

\begin_layout Plain Layout


\backslash
end{centre}
\end_layout

\begin_layout Plain Layout


\backslash
end{figure}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The weights will depend on which histogram we want to construct, with values
 in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Histogram weights"

\end_inset

, where the weight assigned to the edge between 
\begin_inset Formula $x_{i}$
\end_inset

 and 
\begin_inset Formula $x_{j}$
\end_inset

 is 
\begin_inset Formula $R(x_{i},x_{j})$
\end_inset

.
 The following observations is the key to make everything work: A path through
 the graph, visiting nodes 
\begin_inset Formula $0,x_{i_{1}},x_{i_{2}},...,x_{i_{k}},1$
\end_inset

, will have value 
\begin_inset Formula $R(0,x_{i_{1}})+R(x_{i_{k}},1)+\sum_{j=1}^{k}R(x_{i_{j}},x_{i_{j+1}})$
\end_inset

, which is the objective function corresponding to the choice of type/weights
 of the histogram.
 This form of decomposition shows that the problems has an 
\emph on
optimal substructure
\emph default
 , which allows us to do a sequential enumeration of all solutions.
 In order to compute the objective functions, we use double recursion: For
 each node we wish to calculate the value 
\begin_inset Formula $V(x_{j}^{i})=R(0,x_{i_{1}})+\sum_{l=1}^{i}R(x_{i_{l}},x_{i_{l+1}})$
\end_inset

, where 
\begin_inset Formula $i$
\end_inset

 designates the level of 
\begin_inset Formula $x_{j}$
\end_inset

.
 This can be done by applying the recursive formula 
\begin_inset Formula $V(x_{j}^{i})=\max_{l<j}V(x_{l}^{i-1})+R(x_{i_{l}},x_{i_{j}})$
\end_inset

, where we store the value 
\begin_inset Formula $V(x_{j}^{i})$
\end_inset

 at the 
\begin_inset Formula $(i,j)$
\end_inset

th node.
 When the algorithm terminates at 
\begin_inset Formula $x=1$
\end_inset

, we output the path 
\begin_inset Formula $0\to x_{i_{1}}\to x_{i_{2}}\to...\to1$
\end_inset

 which lead to the maximised value.
 
\end_layout

\begin_layout Proposition
The DP algorithm runs in 
\begin_inset Formula $O(kn^{2})$
\end_inset

 time.
\end_layout

\begin_layout Proof
The weighted digraph 
\begin_inset Formula $\Gamma$
\end_inset

 will have 
\begin_inset Formula $2+k(n-k+1)=O(kn)$
\end_inset

 vertices and 
\begin_inset Formula $2(n-k+1)+(k-1)\frac{(n-k+1)(n-k+2)}{2}=O(kn^{2})$
\end_inset

 edges.
 Since the algorithm just described will visit each edge exactly once, the
 algorithm will run in 
\begin_inset Formula $O(kn^{2})$
\end_inset

 time provided the graph has been constructed.
 Constructing the graph can be done in 
\begin_inset Formula $O(kn^{2})$
\end_inset

 time, as it takes constant time to add a vertex or an edge with all our
 edge weights 
\begin_inset Formula $W$
\end_inset

.
\end_layout

\begin_layout Standard
Even though this algorithm is described using graph theoretic language and
 intuition, the implementation of this algorithm does not rely on graph
 theoretic data structures of any kind.
 The graph theoretic description of this algorithm was chosen as it clearly
 illustrates how the algorithm works and points toward some ideas for making
 it run faster.
 It could be possible to remove sections of non-trivial size from the graph
 before checking them, and there are at least two possible ways to go about
 this.
\end_layout

\begin_layout Enumerate
Use upper and lower bounds on the objective in certain sections of the graph.
 One could implement this by assigning to each vertex 
\begin_inset Formula $x_{j}^{i}$
\end_inset

 a lower 
\begin_inset Formula $l(x_{j}^{i})$
\end_inset

 and upper bound 
\begin_inset Formula $u(x_{j}^{i})$
\end_inset

, and disregard any edge emanating from that vertex whenever its upper bound
 is lower than the current global lower bound 
\begin_inset Formula $l$
\end_inset

.
 A na√Øve choice of lower and upper bounds would be to make 
\begin_inset Formula $l(x_{j}^{i})$
\end_inset

 a random path in the diagram containing 
\begin_inset Formula $x_{j}^{i}$
\end_inset

 and 
\begin_inset Formula $u(x_{j}^{i})=V(x_{j}^{i})+h(x_{j}^{i})$
\end_inset

, where 
\begin_inset Formula $h(x_{j}^{i})=\sum_{i\in C}R(x_{i},x_{i+1})$
\end_inset

 with 
\begin_inset Formula $C=\{j,j+1,...,n\}$
\end_inset

.
 This upper bound will typically be far too large, however.
 An issue with the upper bound is that there is no theoretical upper bound
 on 
\begin_inset Formula $h'(x_{j}^{i})=\sum_{i=j+1}^{k}R(y_{i-1},y_{i})$
\end_inset

 which holds for any underlying distribution 
\begin_inset Formula $F$
\end_inset

: By creating an arbitrarily sharp spike in the density, this value can
 become arbitrarily large.
 A workaround is to impose upper bounds that aren't theoretically sound,
 but might still works well in practice: For instance, we could use bounds
 obtained from distributions which we have reason to think that behaves
 worse than the true 
\begin_inset Formula $F$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Prune the graph by throwing away 
\begin_inset Formula $x_{j}^{i}$
\end_inset

s we consider unlikely to be in the solution path.
 For instance, it seems very unlikely that 
\begin_inset Formula $x_{n-k}^{1}$
\end_inset

 is the first element of the solution path.
 One could implement this idea by removing quantiles from each level of
 the graph, e.g.
 the lower quartile for the first level and upper quartile on the last level.
 
\end_layout

\begin_layout Standard
These lines of thinking will not be pursued further, but might be worth
 it if we're serious about using the CIC in Section 
\begin_inset CommandInset ref
LatexCommand vref
reference "sec:Information-criteria"

\end_inset

.
 Here massive resampling has to be carried out, and the coordinate search
 soon to be described will not do the job properly.
 
\end_layout

\begin_layout Standard
The complexity 
\begin_inset Formula $O(n^{2}k)$
\end_inset

 means that the algorithm runs in exponential time, at least on the face
 of it.
 This is because 
\begin_inset Formula $k$
\end_inset

 is not
\emph on
 
\emph default
the 
\emph on
input length
\emph default
 of 
\begin_inset Formula $k$
\end_inset

.
 In fact, the input length of 
\begin_inset Formula $k$
\end_inset

 is 
\begin_inset Formula $\log_{2}k$
\end_inset

.
 This is not the case with the data points 
\begin_inset Formula $x_{1},...,x_{n}$
\end_inset

, which have input size 
\begin_inset Formula $cn$
\end_inset

 for some 
\begin_inset Formula $c$
\end_inset

.
 Obviously, whenever 
\begin_inset Formula $k$
\end_inset

 is considered as a fixed parameter, the algorithm runs in quadratic time
 and should be considered fast.
 However, if 
\begin_inset Formula $k$
\end_inset

 is not considered fixed, it runs in 
\emph on
pseudo-polynomial time, 
\emph default
the class of algorithms which runs in polynomial time as function of input
 value, not input length 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 203"
key "papadimitriou2003computational"

\end_inset

.
 In our case, since 
\begin_inset Formula $2\leq k<n$
\end_inset

, with 
\begin_inset Formula $k$
\end_inset

 typically much less than 
\begin_inset Formula $n$
\end_inset

, the algorithm has complexity bounded by 
\begin_inset Formula $O(n^{3})$
\end_inset

, cubic time.
 This phenomenon is not dissimilar to the dynamic programming algorithm
 for the 
\emph on
knapsack problem
\emph default
, a problem that is known to be 
\begin_inset Formula $NP$
\end_inset

-complete in its decision problem formulation 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 202"
key "papadimitriou2003computational"

\end_inset

.
 Whenever a certain 
\begin_inset Formula $k$
\end_inset

 is polynomially bounded in the input 
\begin_inset Formula $n$
\end_inset

, it is solvable in polynomial time; if not, it runs in exponential time.
\end_layout

\begin_layout Standard
While this algorithm yields exact estimates in a reasonable time, the resulting
 estimates will not be 
\emph on
robust 
\emph default
in the sense that they can be very sensitive to slight changes in input
 values.
 We will discuss this issue further in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Presmoothing-and-instability"

\end_inset

.
\end_layout

\begin_layout Standard
Finally, in our 
\begin_inset Formula $\mathtt{C++}$
\end_inset

 program (of Appendix 
\begin_inset CommandInset ref
LatexCommand eqref
reference "chap:Histogram"

\end_inset

) the difference in run times between the 
\begin_inset Formula $KL$
\end_inset

 and 
\begin_inset Formula $L_{2}$
\end_inset

 histograms is very large.
 The choice of constant or variable weights doesn't seem to matter.
 This came as a big surprise, and the culprit has to be the 
\begin_inset Formula $\mathtt{log}$
\end_inset

s involved in the 
\begin_inset Formula $KL$
\end_inset

-maximisation.
 Now we use the 
\begin_inset Formula $\mathtt{R}$
\end_inset

 package 
\begin_inset Formula $\mathtt{microbenchmark}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "microbenchmark"

\end_inset

 to time how much faster 
\begin_inset Formula $L_{2}$
\end_inset

 is.
 We replicate 
\begin_inset Formula $N=500$
\end_inset

 histograms of both types for 
\begin_inset Formula $k=2,3,...,80$
\end_inset

 and 
\begin_inset Formula $n=500$
\end_inset

.
 In addition, we use a modification of the algorithm into a 
\begin_inset Quotes eld
\end_inset

skeleton
\begin_inset Quotes erd
\end_inset

, such that only the constructions that both histograms have in common are
 computed.
 Denote the 
\begin_inset Formula $L_{2}$
\end_inset

 times by 
\begin_inset Formula $T(L_{2})$
\end_inset

, 
\begin_inset Formula $KL$
\end_inset

 runtimes by 
\begin_inset Formula $T(KL)$
\end_inset

 and the skeleton runtimes by 
\begin_inset Formula $T(S)$
\end_inset

.
 Now we look at 
\begin_inset Formula $\frac{T(KL)-T(S)}{T(L_{2})-T(S)}$
\end_inset

, which is seen to be about 
\begin_inset Formula $16$
\end_inset

 for any 
\begin_inset Formula $k$
\end_inset

.
 This gives a reasonable estimate on how much faster 
\begin_inset Formula $L_{2}$
\end_inset

 is.
 This difference in execution time is a large point in favour of 
\begin_inset Formula $L_{2}$
\end_inset

, especially if one wishes to do the subsampling approach to the CIC in
 Section 
\begin_inset CommandInset ref
LatexCommand vref
reference "sec:Information-criteria"

\end_inset

 on information criteria.
 
\end_layout

\begin_layout Subsection
Coordinate search
\end_layout

\begin_layout Standard
We describe a 
\emph on
coordinate search
\emph default
 approximation algorithm, a type of local search algorithm 
\begin_inset CommandInset citation
LatexCommand citep
after "section 3.6"
key "hromkovivc2013algorithmics"

\end_inset

.
 Let 
\begin_inset Formula $k$
\end_inset

 be fixed and define an initial vector 
\begin_inset Formula $a^{0}=(a_{1}^{0},\ldots,a_{k}^{0})$
\end_inset

.
 Put 
\begin_inset Formula $a_{0}=0$
\end_inset

 and 
\begin_inset Formula $a_{k+1}=1$
\end_inset

, and define recursively
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
a_{i}^{j}=\argmax_{a_{i-1}^{j}<p<a_{i+1}^{j-1}}R(a_{i-1}^{j},p)+R(p,a_{i+1}^{j-1}).
\]

\end_inset

On ties, choose the smallest possible 
\begin_inset Formula $p$
\end_inset

.
 We say that the algorithm terminates in iteration 
\begin_inset Formula $j$
\end_inset

 whenever 
\begin_inset Formula $a_{i}^{j}=a_{i}^{j+1}$
\end_inset

 for all 
\begin_inset Formula $i$
\end_inset

.
\end_layout

\begin_layout Proposition
The coordinate search algorithm terminates.
\end_layout

\begin_layout Proof
Notice that the objective function can only increase in value when 
\begin_inset Formula $a_{i}^{j}$
\end_inset

 is swapped for 
\begin_inset Formula $a_{i}^{j+1}$
\end_inset

.
 Now suppose the algorithm doesn't terminate.
 Since there are finitely many states, it has to by cyclic.
 But this is impossible, as it would either lead to decreasing values of
 the objective function for at least one 
\begin_inset Formula $a_{i}^{j}$
\end_inset

 to 
\begin_inset Formula $a_{i}^{j+1}$
\end_inset

, or make the objective function constant.
 However, an 
\begin_inset Formula $a_{i}^{j}$
\end_inset

 can't change more than once when the objective function doesn't increase,
 due to the tie-breaking rule.
\end_layout

\begin_layout Standard
This algorithm yields consistent estimates.
 Heuristically, this can be seen as follows: For each 
\begin_inset Formula $i$
\end_inset

 it finds the maximum in the 
\begin_inset Formula $i$
\end_inset

-th dimension.
 It converges to a 
\begin_inset Quotes eld
\end_inset

local
\begin_inset Quotes erd
\end_inset

 maximum in the sense that it can't move along any 
\begin_inset Formula $i$
\end_inset

-direction without diminishing in value.
 Now, whenever the underlying function is concave, this can only happen
 when it is at an actual maximum.
 Since the likelihood converges in distribution towards a concave function,
 it is consistent.
 Hence we expect the results of this algorithm to have the same asymptotic
 properties as the exact algorithm, as the rate theorem 
\begin_inset CommandInset ref
LatexCommand eqref
reference "thm:rate theorem"

\end_inset

 only requires 
\begin_inset Formula $P_{n}m_{\widehat{\theta}_{n}}\geq\argmax_{\theta}P_{n}m_{\theta}-o_{p}(1)$
\end_inset

, a condition which is probably satisfied.
 
\end_layout

\begin_layout Standard
In our implementation, we will add an upper bound to the number of full
 iterations.
 We will let this be a used defined 
\begin_inset Formula $c$
\end_inset

.
 With this modification, at worst this algorithm will terminate after 
\begin_inset Formula $c$
\end_inset

 full iterations.
 Since each full iteration will check at most 
\begin_inset Formula $n$
\end_inset

 points, it is complexity is bounded, very roughly, by 
\begin_inset Formula $O(n\log n)$
\end_inset

.
 This is an order of magnitude faster than the exact algorithm, and doesn't
 depend on 
\begin_inset Formula $k$
\end_inset

.
 (It is 
\begin_inset Formula $O(n\log n)$
\end_inset

 instead of 
\begin_inset Formula $O(n)$
\end_inset

 since we need to sort the list of observations first.)
\end_layout

\begin_layout Standard
This algorithm requires an initial input to run on.
 We have not studied the effects of initial input thoroughly, but it certainly
 matters.
 In all our uses of the coordinate search algorithm we use an 
\begin_inset Quotes eld
\end_inset

evenly spaced
\begin_inset Quotes erd
\end_inset

 initial input, namely the vector of 
\begin_inset Formula $\frac{i}{k}$
\end_inset

th quantiles, with 
\begin_inset Formula $i$
\end_inset

 ranging from 
\begin_inset Formula $1$
\end_inset

 to 
\begin_inset Formula $k-1$
\end_inset

.
 This choice is clearly justifiable in the context of irregular quantile
 histograms.
\end_layout

\begin_layout Subsection
Integer programming
\end_layout

\begin_layout Standard
As was the case for Manski's estimator (Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Algorithms-and-complexity"

\end_inset

), we can formulate the histogram problem as a mixed integer program.
 We wish to maximise the linear objective
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\sum_{i,j}z_{ij}w(i,j),\label{eq:Histogram integer programming objective}
\end{equation}

\end_inset

where 
\begin_inset Formula $w(i,j)=W(x_{i},x_{j})$
\end_inset

 and 
\begin_inset Formula $W$
\end_inset

 is chosen from table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Histogram weights"

\end_inset

.
 This objective should satisfy the constraints
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\sum_{j=1}^{n-k+1}z_{1i} & = & 1,\\
\sum_{j=n-k+1}^{n}z_{i(n+1)} & = & 1,\\
\sum_{j=1}^{n}z_{ij} & \leq & 1,\quad\forall i=1,...,n,\\
\\
\sum z_{ij} & = & k+2,\\
\sum_{i<j<k}z_{ij}z_{jk} & = & k+2,\\
z_{ij} & \in & \{0,1\}.
\end{eqnarray*}

\end_inset

While the last constraint is not linear, it can be reformulated as a linear
 constraint, basically because 
\begin_inset Formula $z_{ij}z_{jk}$
\end_inset

 can be understood as 
\begin_inset Formula $z_{ij}\wedge z_{jk}$
\end_inset

.
 The method is as follows: Define a set of new variables 
\begin_inset Formula $w_{ijk}$
\end_inset

, add the constraint 
\begin_inset Formula $\sum_{i<j<k}w_{ijk}=k+2$
\end_inset

 and add, for every suitable 
\begin_inset Formula $i,j,k$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
w_{ijk} & \leq & z_{ij},\\
w_{ijk} & \leq & z_{jk},\\
w_{ijk} & \geq & z_{ij}+z_{jk}-1.
\end{eqnarray*}

\end_inset

Why these constraints? The first forces there to be exactly one edge connecting
 the source to the body of the graph, while the second assures us that there
 is exactly one edge connecting the sink to the body of the graph.
 The following constraint force every 
\begin_inset Formula $i$
\end_inset

 to appear at most once, while the constraint 
\begin_inset Formula $\sum z_{ij}=k+2$
\end_inset

 says how many edges we want to include.
 In order to ascertain that the 
\begin_inset Formula $z_{ij}$
\end_inset

 describe a connected path of 
\begin_inset Formula $k$
\end_inset

 vertices in the graph, we require the multiplicative constraint.
 
\end_layout

\begin_layout Standard
Finally we mention the approximation algorithm of choice for 
\begin_inset CommandInset citation
LatexCommand citet
key "histogram"

\end_inset

, used in the 
\begin_inset Formula $\mathtt{R}$
\end_inset

 package 
\begin_inset Formula $\mathtt{histogram}.$
\end_inset

 This is a greedy algorithm.
 Let 
\begin_inset Formula $k>2$
\end_inset

 be a given bin count.
 The algorithm starts by performing an inexpensive 
\begin_inset Formula $k=2$
\end_inset

 histogram calculation.
 When 
\begin_inset Formula $k=i$
\end_inset

 bins are calculated, it finds the 
\begin_inset Formula $(i+1)$
\end_inset

th split point by minimizing the divergence in each bin separately, choosing
 the split point which maximises the global reduction of divergence.
 
\end_layout

\begin_layout Section
Pre-smoothing and instability
\begin_inset CommandInset label
LatexCommand label
name "sec:Presmoothing-and-instability"

\end_inset


\end_layout

\begin_layout Standard
When estimating our histograms, we minimise the 
\begin_inset Formula $\theta\mapsto P_{n}m_{\theta}$
\end_inset

, where 
\begin_inset Formula $P_{n}$
\end_inset

 is the empirical measure.
 However, since we assume some smoothness in the true distribution 
\begin_inset Formula $P$
\end_inset

, it should also work to use a smoothed variant 
\begin_inset Formula $\widetilde{P}_{n}$
\end_inset

 of 
\begin_inset Formula $P$
\end_inset

, such as the Gaussian copula estimator.
 Here we demonstrate that this is the case, and also discuss some advantages
 of this approach.
 First we discuss a very important anomaly of the irregular histograms.
\end_layout

\begin_layout Subsection
Instability
\end_layout

\begin_layout Standard
Recall the general histogram formula 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general_histogram"

\end_inset

,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
h(x)=\sum_{i=1}^{k}\frac{w_{i}}{a_{i}-a_{i-1}}1_{[a_{i-1},a_{i}]}(x),
\]

\end_inset

and the minimiser of the empirical 
\begin_inset Formula $L_{2}$
\end_inset

-distance with variable weights, given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\argmax_{a}\sum_{i=1}^{k}\log\frac{P_{n}(a_{i-1},a_{i})}{a_{i}-a_{i-1}}P_{n}[a_{i-1},a_{i}],
\]

\end_inset

where the 
\begin_inset Formula $a_{i}$
\end_inset

s are constrained to be inside the set of observations 
\begin_inset Formula $x_{1},...,x_{n}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $x_{(i)}$
\end_inset

 denote the 
\begin_inset Formula $i$
\end_inset

th order statistic.
 Then 
\begin_inset Formula $P_{n}[x_{(i)},x_{(i+j)})^{2}=\frac{4+(j-1)^{2}}{n^{2}}.$
\end_inset

 When 
\begin_inset Formula $j$
\end_inset

 is small, this quantity is also small, 
\begin_inset Formula $P_{n}[x_{(i)},x_{(i+j)}]^{2}\approx n^{-2}$
\end_inset

.
 But it might also happen that 
\begin_inset Formula $x_{(i+j)}-x_{(i)}$
\end_inset

 is very small: In this case 
\begin_inset Formula $x_{(i+1)}-x_{(i)},x_{(i+2)}-x_{(i+1)}$
\end_inset

 etc.
 will be even smaller.
 For 
\begin_inset Formula $x_{(i+1)}-x_{(i)}\lll\frac{1}{n^{2}}$
\end_inset

, the term 
\begin_inset Formula $\frac{P_{n}[x_{(i)},x_{(i+1)})}{x_{(i+1)}-x_{(i)}}P_{n}[x_{j},x_{i})=\frac{4}{n^{2}\left(x_{(i+1)}-x_{(i)}\right)}$
\end_inset

 will become very large, forcing the histogram to include the pair 
\begin_inset Formula $x_{(i)},x_{(i+1)}$
\end_inset

 as split points even tough their closeness is just noise.
 This 
\emph on
instability
\begin_inset Foot
status open

\begin_layout Plain Layout
Typically one would say that the solution non-robust or sensitive to changes
 in the data.
 We will not use these terms here, as the word 
\begin_inset Quotes eld
\end_inset

robustness
\begin_inset Quotes erd
\end_inset

 is reserved by the usual statistical concept of an estimator being robust
 to changes in the underlying model.
 This is not the issue here, the instability phenomenon occurs when the
 model assumptions hold perfectly.
\end_layout

\end_inset


\emph default
 is especially prevalent in real data sets, where numbers are rounded to
 fewer digits than in simulations.
 It manifests itself in the histograms as tall spikes with very high density,
 as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Spike"

\end_inset

.
 The phenomenon affects both the exact algorithm and the coordinate search
 algorithm, but the exact algorithm to a much higher degree, essentially
 because it actively ferrets these anomalies out.
 The coordinate search will have to be unlucky in order to stumble across
 such spikes.
 We can remedy this fault by imposing a minimum distance between pairs 
\begin_inset Formula $(x_{i},x_{j})$
\end_inset

 considered in the dynamic programming algorithm and the coordinate search,
 for instance by enforcing 
\begin_inset Formula $|x_{i}-x_{j}|\geq\delta$
\end_inset

 for some 
\begin_inset Formula $\delta>0$
\end_inset

 as in the proof of consistency (Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:histogram consistency"

\end_inset

).
 A choice of such a 
\begin_inset Formula $\delta>0$
\end_inset

 is unavoidable, at least for the variable weight histograms.
 In most cases, this choice is easy to make: What's important is that 
\begin_inset Formula $\delta$
\end_inset

 is so large that the really small differences 
\begin_inset Formula $x_{(i+1)}-x_{(i)}$
\end_inset

 are avoided, 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/SpikeExample.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Spike"

\end_inset

Example of a spike when 
\begin_inset Formula $X_{1},...X_{n}\sim\mbox{Beta}(2,7)$
\end_inset

.
 The culprits are the points 
\begin_inset Formula $(0.2252,0.2258)$
\end_inset

.
 More spikes can be found in the illustrations section.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Pre-smoothing
\end_layout

\begin_layout Standard
The pre-smoothing procedure is simple to describe and set up.
 Given data 
\begin_inset Formula $x_{1},...,x_{n}$
\end_inset

, we find the Gaussian copula KDE estimate 
\begin_inset Formula $\widehat{f}$
\end_inset

 of the true density 
\begin_inset Formula $f$
\end_inset

, as described in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Kernel-density-estimators"

\end_inset

.
 If we wish to calculate the pre-smoothed 
\begin_inset Formula $KL$
\end_inset

-histogram for a given 
\begin_inset Formula $k$
\end_inset

, we need to find 
\begin_inset Formula $\argmax_{a}\sum_{i=1}^{k}\widehat{P}[a_{i-1},a_{i})\log\frac{\widehat{P}[a_{i-1},a_{i})}{a_{i}-a_{i-1}}$
\end_inset

, where 
\begin_inset Formula $\widehat{P}$
\end_inset

 is the measure associated with 
\begin_inset Formula $\widehat{f}$
\end_inset

.
 As calculating this requires intensive numerical integration, we approximate
 it by resampling a large amount of observations from 
\begin_inset Formula $\widehat{f}$
\end_inset

, which will be 
\begin_inset Formula $50kn$
\end_inset

 in our studies.
 Recall from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Kernel-density-estimators"

\end_inset

 that the Gaussian copula KDE is easy to sample from, and this is the main
 reason why we use it.
 The 
\begin_inset Formula $\mathtt{R}$
\end_inset

 code for this procedure is included in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Histogram"

\end_inset

.
 
\end_layout

\begin_layout Standard
In addition to fixing the instability issue, the pre-smoother has superior
 performance in terms of Hellinger distance from the true distribution and
 mean integrated squared error (MISE), as we will demonstrate in a special
 case shortly.
\end_layout

\begin_layout Subsection
Simulations
\begin_inset CommandInset label
LatexCommand label
name "sub:Simulations hellinger imse"

\end_inset


\end_layout

\begin_layout Standard
We compare the MISE and Hellinger distances for the exact solution, coordinate
 search solution and the smoothed solution for some choices of 
\begin_inset Formula $n$
\end_inset

,
\begin_inset Formula $k$
\end_inset

 with underlying 
\begin_inset Formula $F=\mbox{Beta}(2,7)$
\end_inset

.
 The results are in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Hellinger-distance-between"

\end_inset

 (Hellinger) and Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Mean-integrated-squared"

\end_inset

 (MISE).
 Several tentative conclusions can be made from these simulations.
 
\end_layout

\begin_layout Enumerate
The exact solutions perform very poorly, with enormous MISE in all cases
 except those where 
\begin_inset Formula $k\lll n$
\end_inset

, a miserable result which probably can be attributed to the 
\emph on
instability
\emph default
 discussed in the preceding section.
 
\end_layout

\begin_layout Enumerate
The smoothed histogram outperforms the others on both measures for almost
 every choice of 
\begin_inset Formula $k$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

, the exception is when 
\begin_inset Formula $k=2$
\end_inset

, where smoothing seems to worsen things.
 
\end_layout

\begin_layout Enumerate
The quality of the smoothed histogram increases with 
\begin_inset Formula $k$
\end_inset

, contrary to the coordinate search histogram.
 This is not surprising, as it approximates the underlying Gaussian copula
 KDE better and better.
 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $L_{2}$
\end_inset

 and 
\begin_inset Formula $KL$
\end_inset

 histograms have very similar performance, with a small victory to 
\begin_inset Formula $KL$
\end_inset

.
 The difference is large for 
\begin_inset Formula $k=2$
\end_inset

 and 
\begin_inset Formula $n=100$
\end_inset

, however.
\end_layout

\begin_layout Enumerate
Constant weights don't fare well at all compared to variable weights.
 This serves to further discourage the use of this kind of histogram.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="8">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $KL$
\end_inset

/var
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L_{2}$
\end_inset

/var
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coord
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exact
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Smooth
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coord
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exact
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Smooth
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.362
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.363
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.397
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.712
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
1.065
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.181
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
16.072
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.087
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.179
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
12.17
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.084
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
2.182
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
19.386
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.053
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
2.218
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
29.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.055
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.084
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
10.835
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.036
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.092
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
38.19
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.037
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.298
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
74.025
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.016
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.315
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
18.037
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.016
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $KL$
\end_inset

/const
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L_{2}$
\end_inset

/const
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.634
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.629
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.62
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.641
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.616
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
1.885
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
1.54
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.142
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
1.459
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.684
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.136
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
2.136
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
62.748
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.068
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
1.941
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
3.519
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.071
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
2.474
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.164
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.088
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
2.218
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.189
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.08
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.337
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
441.356
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.024
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.364
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
1.156
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.023
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Mean-integrated-squared"

\end_inset

Mean integrated squared error for 
\begin_inset Formula $F=\mbox{Beta}(2,7)$
\end_inset

 with different choices of 
\begin_inset Formula $n,k$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="8">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $KL$
\end_inset

/var
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L_{2}$
\end_inset

/var
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coord
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exact
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Smooth
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coord
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exact
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Smooth
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.216
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.218
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.221
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.278
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.281
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.391
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.137
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.195
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.103
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.147
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.215
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.123
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.257
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.331
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.079
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.252
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.318
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.081
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.098
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.116
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.072
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.114
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.185
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.095
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.127
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.218
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.048
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.127
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.201
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.053
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $KL$
\end_inset

/const
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L_{2}$
\end_inset

/const
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.386
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.385
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.385
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.385
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.385
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.384
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.306
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.251
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.211
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.306
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.262
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.208
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.263
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.358
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.26
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.29
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.115
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.276
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.195
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.186
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.274
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.198
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.183
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.156
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.234
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.087
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.156
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.216
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.088
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Hellinger-distance-between"

\end_inset

Hellinger distance between the histogram and the true distribution for 
\begin_inset Formula $F=\mbox{Beta}(2,7)$
\end_inset

 with different choices of 
\begin_inset Formula $n,k$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Also of interest is the performance of estimating the split points.
 The results of a small simulation study is found in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:MSE split points"

\end_inset

.
 It seems likely that the smoothed estimator will perform at least as well
 as the exact estimator and the coordinate search.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/MSESplitsBeta(3,1)(k=11)(j=2).pdf
	scale 30

\end_inset


\begin_inset Graphics
	filename OppgaveR/MSESplitsBeta(1,3)(k=11)(j=5).pdf
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:MSE split points"

\end_inset

Plots of 
\begin_inset Formula $n^{\frac{2}{3}}$
\end_inset

-rescaled MSE for two different split points for 
\begin_inset Formula $\mbox{Beta}(1,3)$
\end_inset

 with 
\begin_inset Formula $k=11$
\end_inset

 and 
\begin_inset Formula $n=50,100...,1000$
\end_inset

 (left) MSE for the split point 
\begin_inset Formula $i=2$
\end_inset

, (right) for 
\begin_inset Formula $i=5$
\end_inset

.
 Curiously, the exact algorithm performs much worse than the coordiante
 search for 
\begin_inset Formula $i=5$
\end_inset

, but better for 
\begin_inset Formula $i=2$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Illustrations
\end_layout

\begin_layout Subsection
Police percentage data
\end_layout

\begin_layout Standard
We apply the pre-smoothed and exact Kullback-Leibler histograms (
\begin_inset Formula $k=6$
\end_inset

) on the racial police data set from New York Times 
\begin_inset CommandInset citation
LatexCommand cite
key "racepol"

\end_inset

.
 Each observations 
\begin_inset Formula $x_{i}$
\end_inset

 is the percentage of police officers in a big city in the United States
 that is white (
\begin_inset Formula $n=543$
\end_inset

).
 The resulting histograms are in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Police"

\end_inset

.
 Notice the dotted spike in the in the exact histogram at the right side:
 This sort of thing happens even when 
\begin_inset Formula $n$
\end_inset

 is large compared to 
\begin_inset Formula $k$
\end_inset

.
 Also notice that the exact histogram on the left hand side gives almost
 zero weight to the rightmost part of the picture, an 
\begin_inset Quotes eld
\end_inset

error
\begin_inset Quotes erd
\end_inset

 rectified by smoothing.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/PoliceHistogramKLKL.pdf
	scale 35

\end_inset


\begin_inset Graphics
	filename OppgaveR/PoliceHistogramKLequal.pdf
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Police"

\end_inset

(left) Kullback-Leibler irregular histogram with variable weights, dotted
 is the exact histogram, while solid is pre-smoothed one.
 (right) Same histogram with constant weights.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Church services
\end_layout

\begin_layout Standard
On the website of Statistics Norway (SSB) one can find the data of church
 services from the Church of Norway per 1000 residents for each Norwegian
 commune 
\begin_inset CommandInset citation
LatexCommand cite
key "kirkessb"

\end_inset

.
 Theoretically speaking, this data may not be contained in a bounded interval
 --- it is conceivable for a commune of 
\begin_inset Formula $1000$
\end_inset

 residents to have e.g.
 
\begin_inset Formula $10,000,000$
\end_inset

 church services per year (if all residents are priests and do 
\begin_inset Formula $24$
\end_inset

 services each day, we're getting close).
 Nevertheless, the histogram works nicely when we assume, innocently enough,
 that the distribution is supported on 
\begin_inset Formula $[0,1000]$
\end_inset

.
 This data can be found for 
\begin_inset Formula $1999-2014$
\end_inset

, and our focus is on 
\begin_inset Formula $2014$
\end_inset

.
 Out of the 428 communes, 5 where removed due to 
\begin_inset Formula $NA$
\end_inset

s in the data set.
 We used the smoothed and exact 
\begin_inset Formula $L_{2}$
\end_inset

-histogram.
 The result is displayed in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:SSB"

\end_inset

.
 This and other examples illustrates the huge impact of pre-smoothing.
 Also, in this case, the approximate coordinate algorithm gives much better
 results than the exact algorithm.
 The observations on 
\begin_inset Formula $64,66,70$
\end_inset

 and 
\begin_inset Formula $82$
\end_inset

 are Loppa (residents: 1 027), Modalen (372) Vevelstad (495) and Solund
 (815) respectively.
 Oslo, with a population of 634 463, have 7.3 services per resident, placing
 it into the second to last bin.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/ChurchServicesL2.pdf
	scale 35

\end_inset


\begin_inset Graphics
	filename OppgaveR/ChurchServicesL2(exact).pdf
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:SSB"

\end_inset


\begin_inset Formula $L_{2}$
\end_inset

-histogram of church services per 1000 residents for Norwegian communes.
 The dashed line is the Gaussian copula kernel density estimator, while
 the dotted line is fitted through the 
\begin_inset Formula $\mathtt{locfit}$
\end_inset

 package, 
\begin_inset CommandInset citation
LatexCommand citep
key "locfit"

\end_inset

.
 As for the exact histogram, we get a similarly horrible result for the
 
\begin_inset Formula $KL$
\end_inset

-histograms.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Confidence intervals
\end_layout

\begin_layout Standard
We perform a small Monte Carlo study of confidence intervals (CIs) for the
 split points when 
\begin_inset Formula $k=2$
\end_inset

 for 
\begin_inset Formula $L_{2}$
\end_inset

-histograms with equal weights.
 We will compare subsample CIs and smoothed bootstrap CIs.
 Both the ordinary non-parametric bootstrap and 
\begin_inset Formula $m$
\end_inset

-out-of-
\begin_inset Formula $n$
\end_inset

 bootstrap are inappropriate for irregular histograms, as they resample
 with replacement, something the histogram can't handle well.
 This is not a big problem, as the nonparametric bootstrap is inconsistent
 for cube root estimators, and the 
\begin_inset Formula $m$
\end_inset

-out-of-
\begin_inset Formula $n$
\end_inset

 bootstrap and the subsample tend to have similar performance.
\end_layout

\begin_layout Standard
This combination of 
\begin_inset Formula $L{}_{2}$
\end_inset

 and equal weights is chosen because 
\begin_inset Formula $L_{2}$
\end_inset

 is faster to calculate than 
\begin_inset Formula $KL$
\end_inset

 and equal weights allows us to estimate only one parameter.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center

\size footnotesize
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="9">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
\begin_inset Formula $n=50$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
\begin_inset Formula $n=100$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
\begin_inset Formula $n=500$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
\begin_inset Formula $n=1000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
Cov
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
Len
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
Cov
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
Len
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
Cov
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
Len
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
Cov
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
len
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
\begin_inset Formula $5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.958
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1456
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.959
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1195
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.962
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0715
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.974
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0569
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
\begin_inset Formula $7$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.958
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1436
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.97
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.119
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.96
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0717
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.971
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0571
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
\begin_inset Formula $10$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.946
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1422
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.981
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1194
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.979
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0727
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.976
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.058
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
\begin_inset Formula $20$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.901
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1246
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.968
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1127
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.98
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0724
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.984
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0579
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
\begin_inset Formula $\alpha'=0.90$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.98
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1359
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.98
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1053
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.99
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0594
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0461
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
\begin_inset Formula $\alpha'=0.95$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1571
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.1223
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0686
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size footnotesize
0.0529
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Confidence-intervals"

\end_inset


\begin_inset Formula $95\%$
\end_inset

 confidence intervals, with coverage and length for different methods.
 The numbers 
\begin_inset Formula $(2,7,10,20)$
\end_inset

 are the block sizes in the subsample.
 The 
\begin_inset Formula $\alpha$
\end_inset

s are the nominal levels for the smoothed bootstrap.
 We supplied results for 
\begin_inset Formula $\alpha=0.90$
\end_inset

 since 
\begin_inset Formula $\alpha=0.95$
\end_inset

 only yielded coverages of 
\begin_inset Formula $1$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results are displayed in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Confidence-intervals"

\end_inset

.
 The smoothed bootstrap appears inconsistent.
 A likely explanation for this is that the bandwidth choice, obtained by
 the normal reference rule, isn't tailored to this situation.
 Still, the smoothed bootstrap intervals tend to have both smaller length
 and higher coverage than the subsample intervals.
 A similar kind of problem appears for the limiting distribution, as we
 require a consistent estimate of 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
V=f'(a)\left[\frac{1}{a}-\frac{1}{1-a}\right]-2f(a)\left[\frac{1}{(1-a)^{2}}+\frac{1}{a^{2}}\right]+\frac{2(F(a)-\frac{1}{4})}{a^{3}}+\frac{2(\frac{3}{4}-F(a))}{(1-a)^{3}},
\]

\end_inset

(see Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:(k = 2) distribution, quantile histogram, L2"

\end_inset

), but we have no guarantee that 
\begin_inset Formula $f'(a)$
\end_inset

 is well estimated by the Gaussian copula KDE.
 
\end_layout

\begin_layout Section
Information criteria
\begin_inset CommandInset label
LatexCommand label
name "sec:Information-criteria"

\end_inset


\end_layout

\begin_layout Subsection
Akaike's information criterion
\end_layout

\begin_layout Standard
The most famous model selection criterion is the AIC, Akaike's information
 criterion.
 Let 
\begin_inset Formula $X_{1},X_{2},...,X_{n}\stackrel{i.i.d.}{\sim}f$
\end_inset

, for some density 
\begin_inset Formula $f$
\end_inset

, and 
\begin_inset Formula $\mathcal{M}=(M_{1},M_{2},...,M_{k})$
\end_inset

 be a list of parametric models with likelihoods 
\begin_inset Formula $f^{1},f^{2},...,f^{k}$
\end_inset

.
 Let 
\begin_inset Formula $d_{j}$
\end_inset

 be the size of the free parameter vector 
\begin_inset Formula $\theta^{j}$
\end_inset

 in 
\begin_inset Formula $f^{j}$
\end_inset

, and 
\begin_inset Formula $\widehat{\theta^{j}}$
\end_inset

 be its maximum likelihood estimate.
 Then the AIC is defined as
\begin_inset Foot
status open

\begin_layout Plain Layout
There are in fact two different definitions of the AIC.
 In addition to the one mention, the variant 
\begin_inset Formula $AIC'=-AIC$
\end_inset

 is also commonly used.
 In this case, the 
\begin_inset Quotes eld
\end_inset

best model
\begin_inset Quotes erd
\end_inset

 will minimise the AIC instead of maximising it.
\end_layout

\end_inset

,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
AIC_{j}=2\sum_{i=1}^{n}\log f^{j}(X_{i};\widehat{\theta})-2d_{j},
\]

\end_inset

and the index of the chosen model will be 
\begin_inset Formula $\argmax_{j=\{1,2,...,k\}}AIC_{j}$
\end_inset

.
 A better justified cousin of the AIC is the TIC, Takeuchi's information
 criterion, defined as 
\begin_inset Formula $TIC_{j}=2\sum_{i=1}^{n}\log f^{j}(X_{i};\widehat{\theta})-2\mathrm{Tr}JK^{-1}$
\end_inset

.
 Here 
\begin_inset Formula $\theta_{0}$
\end_inset

 is the least false value of 
\begin_inset Formula $\theta,$
\end_inset

 defined as the argmin of the Kullback-Leibler divergence between 
\begin_inset Formula $f(\cdot,\theta)$
\end_inset

 and 
\begin_inset Formula $f$
\end_inset

.
 Here 
\begin_inset Formula $J=E\left[\frac{\partial^{2}}{\partial\theta^{2}}\log f(X,\theta)\mid_{\theta=\theta_{0}}\right]$
\end_inset

, and 
\begin_inset Formula $K=\mathrm{Var}\left[\frac{\partial}{\partial\theta}f(X,\theta)\mid_{\theta=\theta_{0}}\right]$
\end_inset

.
 When the underlying density 
\begin_inset Formula $f$
\end_inset

 has the likelihood 
\begin_inset Formula $f(\cdot,\theta_{0})$
\end_inset

 for some 
\begin_inset Formula $\theta_{0}$
\end_inset

, 
\begin_inset Formula $\mathrm{Tr}JK^{-1}=d_{j}$
\end_inset

, and the TIC and AIC are equal.
 These model selection procedures can and will lead to different choices
 of the best model.
 While the TIC is better theoretically justified, the AIC performs well
 in practice and avoids the noise induced through the estimation of the
 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $K$
\end_inset

 matrices.
 
\end_layout

\begin_layout Standard
We will describe the theoretical justification for the TIC.
 The quantity we wish to minimise is the 
\emph on
expected discrepancy 
\emph default
of a statistical divergence.
 As in the foregoing sections, the divergences of interest to us are the
 
\begin_inset Formula $L_{2}$
\end_inset

-divergence and the Kullback-Leibler divergence.
 To these divergences, we can associate a
\emph on
 discrepancy 
\emph default
which does not involve the unknown density.
 The discrepancy has the same shape as the divergence written as a function
 of 
\begin_inset Formula $\theta$
\end_inset

.
 For Kullback-Leibler, 
\begin_inset Formula 
\begin{eqnarray*}
d_{KL}(p,f_{\theta}) & = & \int\log\frac{p(x)}{f_{\theta}(x)}p(x)dx\\
 & = & \int p(x)\log p(x)dx-\int p(x)\log f_{\theta}(x)dx.
\end{eqnarray*}

\end_inset

Here 
\begin_inset Formula $\int p(x)\log p(x)dx$
\end_inset

 is a constant, and we will only need to maximise 
\begin_inset Formula 
\[
\int p(x)\log f_{\theta}(x)dx=P\log f_{\theta}.
\]

\end_inset

Substituting 
\begin_inset Formula $P_{n}$
\end_inset

 for 
\begin_inset Formula $P$
\end_inset

, we obtain the discrepancy 
\begin_inset Formula $P_{n}\log f_{\theta}$
\end_inset

.
 Similarly for the 
\begin_inset Formula $L_{2}$
\end_inset

-divergence, we obtain the discrepancy 
\begin_inset Formula $-2P_{n}f_{\theta}+F_{\theta}f_{\theta}$
\end_inset

.
\end_layout

\begin_layout Standard
The rationale behind the AIC/TIC is to chose the model that has the smallest
 expected Kullback-Leibler discrepancy, 
\begin_inset Formula $P\left[\max_{\theta}P_{n}\log f_{\theta}\right]$
\end_inset

.
 Define 
\begin_inset Formula $\widehat{\theta}=\argmax_{\theta}P_{n}f_{\theta}$
\end_inset

, and observe that 
\begin_inset Formula $P\left[\max_{\theta}P_{n}\log f_{\theta}\right]=P\left[\log f_{\widehat{\theta}}\right]$
\end_inset

.
 Since 
\begin_inset Formula $P$
\end_inset

 is unavailable, we use the plug-in 
\begin_inset Formula $P_{n}$
\end_inset

 instead.
 But this move introduces bias.
 In order to make fair comparisons between models, we estimate this bias
 and subtract it from the estimate.
 This is a crude method of estimating the discrepancy, and there are other
 alternatives, like the bootstrap (yielding the 
\emph on
EIC
\emph default
) 
\begin_inset CommandInset citation
LatexCommand citep
after "chapter 8"
key "shibata1997bootstrap,konishi2008information"

\end_inset

 and leave-one-out cross validation of the likelihood 
\begin_inset CommandInset citation
LatexCommand citep
after "section 2.9"
key "stone1977asymptotic,claeskens2008model"

\end_inset

.
 In the following proposition, 
\begin_inset Formula $l(\theta)=\log f_{\theta}$
\end_inset

 denotes the log-likelihood of 
\begin_inset Formula $f$
\end_inset

.
\end_layout

\begin_layout Proposition
The bias of 
\begin_inset Formula $P_{n}\left[\max_{\theta}P_{n}f_{\theta}\right]$
\end_inset

 as an estimator of 
\begin_inset Formula $P\left[\max_{\theta}P_{n}f_{\theta}\right]$
\end_inset

 equals 
\begin_inset Formula $\frac{1}{n}\textrm{Tr}J^{-1}K$
\end_inset

.
 Under model conditions, this bias simplifies to 
\begin_inset Formula $\frac{1}{n}d$
\end_inset

, where 
\begin_inset Formula $d$
\end_inset

 is the number of free parameters.
\end_layout

\begin_layout Proof
We wish to estimate the true value 
\begin_inset Formula $\Prob l(\widehat{\theta})$
\end_inset

, and the purpose of this exercise is to estimate the bias of the na√Øve
 estimator 
\begin_inset Formula $\Pn l(\widehat{\theta})$
\end_inset

.
 In Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Z estimators"

\end_inset

, we derived the limit process of 
\begin_inset Formula 
\[
n(P_{n}-P)(l(\theta_{0}+tn^{-\frac{1}{2}})-l(\theta_{0}),
\]

\end_inset

namely 
\begin_inset Formula $t^{T}Z-\frac{1}{2}t^{T}Jt$
\end_inset

, with 
\begin_inset Formula $Z\sim N(0,K)$
\end_inset

 and 
\begin_inset Formula $K=\textrm{Var}U(X,\theta_{0})$
\end_inset

.
 Also, its maximiser is 
\begin_inset Formula $s=J^{-1}Z$
\end_inset

.
 we will deduce this bias by using this rescaled process.
 For this purpose, put 
\begin_inset Formula $s_{n}=\sqrt{n}(\widehat{\theta}-\theta)\to s$
\end_inset

.
 We calculate
\begin_inset Formula 
\begin{eqnarray*}
n(\Pn l(\widehat{\theta})-\Prob l(\widehat{\theta})) & = & n(\Pn l(\theta_{0}+n^{-\frac{1}{2}}t_{n})-\Pn l(\theta_{0}))\\
 &  & -n(\Prob l(\theta_{0}+n^{-\frac{1}{2}}t_{n})-\Prob l(\theta_{0}))\\
 &  & +n(\Pn l(\theta_{0})-\Prob l(\theta_{0})).
\end{eqnarray*}

\end_inset

The third summand has expectation 
\begin_inset Formula $0$
\end_inset

, the second summand converges to 
\begin_inset Formula $\frac{1}{2}s{}^{T}Js$
\end_inset

, while first term converges to 
\begin_inset Formula $s^{T}Z-\frac{1}{2}s^{T}Js$
\end_inset

, with 
\begin_inset Formula $Z=N(0,K)$
\end_inset

 as above.
 Combining these, we get the random variable 
\begin_inset Formula $Z^{T}J^{-1}Z$
\end_inset

.
 Observe that 
\begin_inset Formula $Z^{T}J^{-1}Z=\sum Z_{i}Z_{j}j^{ik},$
\end_inset

 where 
\begin_inset Formula $j^{ik}$
\end_inset

 is the 
\begin_inset Formula $(i,k)th$
\end_inset

 element of 
\begin_inset Formula $J^{-1}$
\end_inset

 and 
\begin_inset Formula $Z_{i}$
\end_inset

 is the 
\begin_inset Formula $i$
\end_inset

-th element of 
\begin_inset Formula $Z$
\end_inset

.
 Since 
\begin_inset Formula $EZ_{i}Z_{j}=K_{ij}$
\end_inset

, we obtain 
\begin_inset Formula $EU^{T}J^{-1}U=\sum k_{ij}j^{jk}=\textrm{Tr}KJ^{-1}=\textrm{Tr}J^{-1}K$
\end_inset

.
 When 
\begin_inset Formula $J=K$
\end_inset

, this trace is equal to 
\begin_inset Formula $d$
\end_inset

.
\end_layout

\begin_layout Standard
The AIC formula can be used for bin selection in regular histograms, but
 is not recommended 
\begin_inset CommandInset citation
LatexCommand citep
key "birge2006many"

\end_inset

.
 The log likelihood at the argmax is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
l(x) & = & \sum_{i=1}^{k}\log\left(\frac{P_{n}[a_{i},a_{i-1})}{a_{i}-a_{i-1}}\right)1_{[a_{i-1},a_{i})}(x),
\end{eqnarray*}

\end_inset

hence the empirical log likelihood at the data 
\begin_inset Formula $x_{1},x_{2},...,x_{n}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
n\sum_{i=1}^{k}\log\left(\frac{P_{n}[a_{i},a_{i-1})}{a_{i}-a_{i-1}}\right)P_{n}[a_{i},a_{i-1}).\label{eq:regular histogram likelihood}
\end{equation}

\end_inset

Assume the split points are equally spaced, 
\emph on
i.e.

\emph default
 
\begin_inset Formula $a_{i}-a_{i-1}=k^{-1}$
\end_inset

 for every 
\begin_inset Formula $i$
\end_inset

, and define 
\begin_inset Formula $n_{i}=nP_{n}[a_{i},a_{i-1})$
\end_inset

 as the number of observations in the 
\begin_inset Formula $i$
\end_inset

-th bin.
 Then 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:regular histogram likelihood"

\end_inset

 becomes
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\sum n_{i}\log\left(\frac{n_{i}}{n}\right)-n\log(h)=\sum n_{i}\log n_{i}+n\log(\frac{k}{n}),
\]

\end_inset

and a variant of the AIC for regular histograms on the unit interval is
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
2\left[\sum n_{i}\log n_{i}+n\log(\frac{k}{n})-(k-1)\right].
\]

\end_inset

It can be argued that this isn't the 
\begin_inset Quotes eld
\end_inset

correct variant
\begin_inset Quotes erd
\end_inset

 of the AIC for histograms, as the condition for the approximation 
\begin_inset Formula $k-1$
\end_inset

 isn't satisfied.
 Indeed, in 
\begin_inset CommandInset citation
LatexCommand citeyear
key "atilgan1990derivaton"

\end_inset

, Atilgan demonstrates that the proper variant of the AIC for regular histograms
 for positive densities on the unit interval is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left[\sum n_{i}\log n_{i}+n\log(\frac{k}{n})-k\right].
\]

\end_inset


\end_layout

\begin_layout Subsection
The cube root information criterion
\end_layout

\begin_layout Standard
We will now copy the reasoning behind the AIC into the setting of irregular
 Kullback-Leibler histograms, in the hope of arriving at a reasonable bin
 selection procedure.
\end_layout

\begin_layout Proposition
The bias of 
\begin_inset Formula $\Pn m(\widehat{q})$
\end_inset

 equals 
\begin_inset Formula 
\[
d_{KL}^{*}=n^{-\frac{2}{3}}\sum_{i=1}^{k-1}f(a_{i})^{\frac{1}{2}}\left|\log\left(\frac{w_{i+1}}{a_{i+1}-a_{i}}\right)-\log\left(\frac{w_{i}}{a_{i}-a_{i-1}}\right)\right|EW_{i}(s_{i}).
\]

\end_inset


\end_layout

\begin_layout Proof
Define 
\begin_inset Formula $s_{n}=n^{\frac{1}{3}}(\widehat{q}-q^{0})\to s=\argmax G(t)$
\end_inset

, and observe 
\begin_inset Formula 
\begin{eqnarray*}
(\Pn m(\widehat{q})-\Prob m(\widehat{q})) & = & (\Pn m(a+n^{-\frac{1}{3}}s_{n})-\Pn m(a))\\
 &  & -(\Prob m(a+n^{-\frac{1}{3}}s_{n})-\Prob m(a))\\
 &  & +(\Pn m(a)-\Prob m(a)).
\end{eqnarray*}

\end_inset

The third line has expected value 
\begin_inset Formula $0$
\end_inset

, while the first converges to 
\begin_inset Formula $n^{-\frac{2}{3}}G(s)$
\end_inset

 and the second line has limit 
\begin_inset Formula $-n^{-\frac{2}{3}}\frac{1}{2}s^{T}Vs$
\end_inset

.
 Since 
\begin_inset Formula 
\[
G(s)=\frac{1}{2}s^{T}Vs+\sum_{i=1}^{k-1}f(a_{i})^{\frac{1}{2}}\left|\log\left(\frac{w_{i+1}}{a_{i+1}-a_{i}}\right)-\log\left(\frac{w_{i}}{a_{i}-a_{i-1}}\right)\right|W_{i}(s_{i}),
\]

\end_inset

the bias is 
\begin_inset Formula $n^{-\frac{2}{3}}\sum_{i=1}^{k-1}f(a_{i})^{\frac{1}{2}}\left|\log\left(\frac{w_{i+1}}{a_{i+1}-a_{i}}\right)-\log\left(\frac{w_{i}}{a_{i}-a_{i-1}}\right)\right|EW_{i}(s_{i})$
\end_inset

.
\end_layout

\begin_layout Standard
Similarly, the bias corresponding to the the 
\begin_inset Formula $L_{2}$
\end_inset

-histogram is 
\begin_inset Formula 
\[
d_{L_{2}}^{*}=n^{-\frac{2}{3}}2\sum_{i=1}^{k-1}f(a_{i})^{\frac{1}{2}}\left|\frac{w_{i+1}}{a_{i+1}-a_{i}}-\frac{w_{i}}{a_{i}-a_{i-1}}\right|EW_{i}(s_{i}).
\]

\end_inset

Now we can define four new bin selection criteria for irregular histograms,
 one for each combination of constant / variable weights and 
\begin_inset Formula $KL$
\end_inset

 / 
\begin_inset Formula $L_{2}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
CIC_{KLv} & = & n\sum_{i=1}^{k}P_{n}(\widehat{a_{i-1}},\widehat{a_{i}})\log\frac{P_{n}(\widehat{a_{i-1}},\widehat{a_{i}})}{\widehat{a_{i}}-\widehat{a_{i-1}}}-n\widehat{d_{KL}^{*}},\\
CIC_{KLc} & = & n\sum_{i=1}^{k}P_{n}(\widehat{a_{i-1}},\widehat{a_{i}})\log\frac{w_{i}}{\widehat{a_{i}}-\widehat{a_{i-1}}}-n\widehat{d_{KL}^{*}},\\
CIC_{L_{2}v} & = & n\sum_{i=1}^{k}\frac{P(\widehat{a_{i-1}},\widehat{a_{i}})^{2}}{\widehat{a_{i-1}}-\widehat{a_{i}}}-n\widehat{d_{L_{2}}^{*}},\\
CIC_{L_{2}c} & = & n\sum_{i=1}^{k}w_{i}\frac{(2P(\widehat{a_{i-1}},\widehat{a_{i}})-w_{i})}{\widehat{a_{i-1}}-\widehat{a_{i}}}-n\widehat{d_{L_{2}}^{*}}.
\end{eqnarray*}

\end_inset

Here 
\begin_inset Formula $CIC$
\end_inset

 is an abbreviation for 
\begin_inset Quotes eld
\end_inset

cube root information criterion
\begin_inset Quotes erd
\end_inset

, a term first used by Hjort in a workshop report 
\begin_inset CommandInset citation
LatexCommand citeyearpar
after "p. 33"
key "hjortCIC"

\end_inset

.
 His 
\begin_inset Formula $CIC$
\end_inset

 is equivalent to our 
\begin_inset Formula $CIC_{KLc}$
\end_inset

, the cube root information criterion of 
\begin_inset Formula $KL$
\end_inset

-histograms with constant weights.
 
\end_layout

\begin_layout Standard
As noted in the introduction, the value 
\begin_inset Formula $\widehat{d^{*}}$
\end_inset

 is hard to estimate, as the limiting distribution is difficult to work
 with analytically and intractable numerically.
 This last claim demands justification.
 we will work with 
\begin_inset Formula $KL$
\end_inset

-histograms with variable weights for simplicity, in which case a natural
 estimator for 
\begin_inset Formula $d_{KLv}^{*}$
\end_inset

 is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\widehat{d_{KLv}^{*}} & = & n^{-\frac{2}{3}}\sum_{i=1}^{k-1}\widehat{f}(\widehat{a_{i}})^{\frac{1}{2}}\left|\log\left(\frac{P_{n}(\widehat{a_{i+1}},\widehat{a_{i}})}{\widehat{a_{i+1}}-\widehat{a_{i}}}\right)-\log\left(\frac{P_{n}(\widehat{a_{i}},\widehat{a_{i-1}})}{\widehat{a_{i}}-\widehat{a_{i}}}\right)\right|EW_{i}(s_{i}),
\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $\widehat{f}$
\end_inset

 is the Gaussian copula KDE estimate of 
\begin_inset Formula $f$
\end_inset

.
 The difficulty lies in finding 
\begin_inset Formula $EW_{i}(s_{i})$
\end_inset

.
 This would be done by simulation from the limiting distribution, which
 also requires consistent estimation of 
\begin_inset Formula $f'(a_{i})$
\end_inset

 as part of the Hessian 
\begin_inset Formula $V$
\end_inset

 (see Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Matrix elements of histogram distribution"

\end_inset

).
 This is not the biggest problem though, since simulating the 
\begin_inset Formula $\argmax$
\end_inset

 with 
\begin_inset Formula $k>2$
\end_inset

 will require the computation of a 
\begin_inset Formula $(k-1)$
\end_inset

-dimensional grid of values in which we simulate 
\begin_inset Formula $k-1$
\end_inset

 Brownian motions, which has cardinality 
\begin_inset Formula $N^{k-1}$
\end_inset

 for some 
\begin_inset Formula $N$
\end_inset

.
 To compute the argmax, we would have to find the value over each combinations
 of 
\begin_inset Formula $(t_{1},t_{2},...,t_{k-1})$
\end_inset

, and in order to calculate the expectation, this has to be done several
 times, say 
\begin_inset Formula $100$
\end_inset

.
 This is clearly infeasible for relatively large 
\begin_inset Formula $k$
\end_inset

, even for 
\begin_inset Formula $k=3$
\end_inset

 when implemented in 
\begin_inset Formula $\mathtt{R}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Fortuitously, it turns out that a subsampling approach works reasonably
 well.
 In order to calculate this term we will use a subsampling procedure on
 the scaled asymptotic bias 
\begin_inset Formula $n^{2/3}E\left(\Pn m_{\widehat{s}}-\Prob m_{\widehat{s}}\right)$
\end_inset

.
 Let 
\begin_inset Formula $G_{b}$
\end_inset

 be the subsample distribution with block size 
\begin_inset Formula $b$
\end_inset

.
 A reasonable estimator for the bias is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E_{G_{b}}\left[\mathbb{P}_{b}m_{q^{*}}-\mathbb{P}_{n}m_{q^{*}}\right],
\]

\end_inset

obtained by substituting 
\begin_inset Formula $\widehat{q}$
\end_inset

 with 
\begin_inset Formula $q^{*}$
\end_inset

, 
\begin_inset Formula $\Pn$
\end_inset

 with 
\begin_inset Formula $\mathbb{P}_{b}$
\end_inset

 and 
\begin_inset Formula $\Prob$
\end_inset

 with 
\begin_inset Formula $\Pn$
\end_inset

.
 We give an indication why this should work when 
\begin_inset Formula $b=\frac{1}{2}n$
\end_inset

.
 The block size 
\begin_inset Formula $b=\frac{1}{2}n$
\end_inset

 can be justified, very handwavingly, by considering the alternatives
\end_layout

\begin_layout Enumerate
\begin_inset Formula $b<\frac{1}{2}n$
\end_inset

.
 The estimate 
\begin_inset Formula $m_{q^{*}}$
\end_inset

 is skewed away from the 
\begin_inset Formula $m_{\widehat{q}}$
\end_inset

,
\end_layout

\begin_layout Enumerate
\begin_inset Formula $b>\frac{1}{2}n$
\end_inset

.
 The estimate 
\begin_inset Formula $m_{q^{*}}$
\end_inset

is skewed towards 
\begin_inset Formula $m_{\widehat{q}}$
\end_inset

.
 
\end_layout

\begin_layout Standard
This procedure estimates the expected bias reasonably well up to 
\begin_inset Formula $k\approx2n^{\frac{1}{3}}$
\end_inset

, according to our experiments.
\end_layout

\begin_layout Standard
Unfortunately, we will have to use the exact algorithm when performing this
 subsampling, together with a smart choice 
\begin_inset Formula $\delta>0$
\end_inset

 to bound the bin widths, 
\begin_inset Formula $a_{i}-a_{i-1}\leq\delta$
\end_inset

.
 We will not use the coordinate search algorithm as it doesn't approximate
 the objective function well enough, and can't drop the 
\begin_inset Formula $\delta$
\end_inset

, as delta-free maximisation has a very erratic behaviour.
 
\end_layout

\begin_layout Standard
In the following subsections, we will demonstrate that the subsampling approach
 works reasonably well.
 We could, as much simpler approach, create an empirical reference rule
 for the bias based on e.g.
 the 
\begin_inset Formula $\mbox{Beta}(2,7)$
\end_inset

-distribution.
 This could be obtained through extensive simulations and stored as an 
\begin_inset Formula $\mathtt{R}$
\end_inset

-function.
 we will demonstrate empirically that the asymptotic bias term 
\begin_inset Formula $\widehat{d_{KL}^{*}}$
\end_inset

 doesn't approximate the finite sample bias well even for 
\begin_inset Formula $n\approx1000$
\end_inset

, an observation which fits nicely into the picture given in example 
\begin_inset CommandInset ref
LatexCommand eqref
reference "exa:Convergence speed"

\end_inset

.
 Finally, we will apply the information criterion on two real data sets
 and do a small Monte Carlo study on their performance as compared to the
 approach of 
\begin_inset CommandInset citation
LatexCommand citet
key "rozenholc2010combining"

\end_inset

 and the AIC.
\end_layout

\begin_layout Subsection
Bias and subsampling
\end_layout

\begin_layout Standard
First we demonstrate that subsampling the bias works, then we look at the
 theoretical behaviour of the procedure, where we use the simulated true
 biases instead of the subsample estimates.
 The point of the CIC is to attempt to chose the histogram with the minimal
 discrepancy.
 In order for this to work well, the expected bias must be reasonably close
 to the actual bias.
 Recall the discussion at the end of Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Presmoothing-and-instability"

\end_inset

, where it was noted that the 
\begin_inset Formula $L_{2}$
\end_inset

-histogram is much faster to compute that the 
\begin_inset Formula $KL$
\end_inset

-histogram, by factor around 
\begin_inset Formula $16$
\end_inset

.
 Since all these simulations are time consuming, we restrict our attention
 to 
\begin_inset Formula $L_{2}$
\end_inset

-histograms.
 
\end_layout

\begin_layout Subsubsection
Subsampling the bias
\end_layout

\begin_layout Standard
We illustrate the performance of subsampling 
\begin_inset Formula $n^{\frac{2}{3}}\times\textrm{bias}$
\end_inset

, for both 
\begin_inset Formula $\mbox{Beta}(2,7)$
\end_inset

 with 
\begin_inset Formula $n=100,500,1000$
\end_inset

 in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Subsample bias"

\end_inset

.
 The green points are the true bias, while the red points are subsampled.
 The dashed lines are 
\begin_inset Formula $2n^{\frac{1}{3}}$
\end_inset

, which appears to be a reasonable break point for where the subsampled
 bias approximate the true bias well.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/SubBias100(2,7).pdf
	scale 20

\end_inset


\begin_inset Graphics
	filename OppgaveR/SubBias500(2,7).pdf
	scale 20

\end_inset


\begin_inset Graphics
	filename OppgaveR/SubBias1000(2,7).pdf
	scale 20

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Subsample bias"

\end_inset

The green points are the true bias, while the red points are subsampled,
 underlying distribution is 
\begin_inset Formula $\mbox{Beta}(2,7)$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Behaviour of the bias
\end_layout

\begin_layout Standard
We investigate how fast the finite sample converges in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Bias study"

\end_inset

.
 This is done for 
\begin_inset Formula $KL/c$
\end_inset

 (Kullback-Leibler histogram with constant weights) and 
\begin_inset Formula $L_{2}/c$
\end_inset

, (
\begin_inset Formula $L_{2}$
\end_inset

 with constant weights) both with 
\begin_inset Formula $\delta=0.0001$
\end_inset

 and underlying 
\begin_inset Formula $F=\mbox{Beta}(2,7)$
\end_inset

.
 The 
\begin_inset Formula $n$
\end_inset

s under consideration are 
\begin_inset Formula $60,120,180,...,,7140,7200$
\end_inset

.
 For each 
\begin_inset Formula $n$
\end_inset

, we simulated 
\begin_inset Formula $n$
\end_inset

 observations from 
\begin_inset Formula $F$
\end_inset

 and calculated the bias 
\begin_inset Formula $n^{\frac{2}{3}}(P_{n}m_{\widehat{a}}-Pm_{\widehat{a}})$
\end_inset

, replicated 
\begin_inset Formula $k=100$
\end_inset

 times.
 The resulting values are the means of these samples.
 Strikingly, the 
\begin_inset Formula $L_{2}$
\end_inset

-bias stabilises only around 
\begin_inset Formula $n=4000$
\end_inset

 or so, while the 
\begin_inset Formula $KL$
\end_inset

 biases stabilise far earlier.
 From this small study, it seems likely that the asymptotic approximation
 to the real bias works earlier for 
\begin_inset Formula $KL$
\end_inset

 than 
\begin_inset Formula $L_{2}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/BiasKLReal.pdf
	scale 30

\end_inset


\begin_inset Graphics
	filename OppgaveR/BiasL2Real.pdf
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Bias study"

\end_inset

Large study of biases for (blue) 
\begin_inset Formula $KL/c$
\end_inset

 and (red) 
\begin_inset Formula $L_{2}/c$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Since subsampling is computationally expensive, it would be nice if we could
 get a reference rule up and running.
 Some experiments suggests this might be the case.
 In the following plot we have simulated the biases using 
\begin_inset Formula $n=1000$
\end_inset

 and 
\begin_inset Formula $N=100$
\end_inset

 replications for several choices of 
\begin_inset Formula $\mbox{Beta}$
\end_inset

-distributions.
 The shape parameters were 
\begin_inset Formula $(2,7$
\end_inset

),
\begin_inset Formula $(1,3)$
\end_inset

,
\begin_inset Formula $(9,10)$
\end_inset

 and 
\begin_inset Formula $(10,5)$
\end_inset

.
 The results are in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Bias comparisons"

\end_inset

.
 Notice that all reasonably regular distributions have pretty similar biases.
 This suggests that it might be workable to do a single, big simulation
 in order to get a reference rule for the bias.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/SimulatedBiasesL2.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Bias comparisons"

\end_inset

Comparison of simulated biases for a selection of 
\begin_inset Formula $\mbox{Beta}(a,b)$
\end_inset

-distributions, 
\begin_inset Formula $n=1000$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
A small Monte Carlo Study
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "rozenholc2010combining"

\end_inset

 propose several information criteria for the irregular histogram obtained
 by penalising the likelihood 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
n\sum_{i=1}^{k}P_{n}(\widehat{a_{i-1}},\widehat{a_{i}})\log\frac{P_{n}(\widehat{a_{i-1}},\widehat{a_{i}})}{\widehat{a_{i}}-\widehat{a_{i-1}}}.
\]

\end_inset

Their penalties are
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\textrm{pen}_{n}^{B} & = & \log\binom{n-1}{k-1}+(k-1)+\log^{\frac{5}{2}}k,\\
\textrm{pen}_{n}^{R} & = & \log\binom{n-1}{k-1}+\frac{1}{2}\sum_{j=1}^{D}\frac{P_{n}(\widehat{a_{i-1}},\widehat{a_{i}})}{\widehat{a_{i}}-\widehat{a_{i-1}}}+\log^{\frac{5}{2}}k,
\end{eqnarray*}

\end_inset

For each choice of penalty, the histogram with the largest penalised likelihood
 is chosen.
 Since it requires a slightly different computation procedure, we ignore
 
\begin_inset Formula $\textrm{pen}_{n}^{R}$
\end_inset

.
 In addition to 
\begin_inset Formula $\textrm{pen}_{n}^{B}$
\end_inset

, 
\begin_inset Formula $CIC_{L_{2}v}$
\end_inset

 and 
\begin_inset Formula $CIC_{KLv}$
\end_inset

, we will use the 
\begin_inset Quotes eld
\end_inset

classical
\begin_inset Quotes erd
\end_inset

 penalty
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathrm{pen}_{n}^{AIC}=d-1.
\]

\end_inset


\end_layout

\begin_layout Standard
In Figure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:PenaltyPlot"

\end_inset

 we supply a plot of the penalties for comparisons sake.
 It appears that the AIC penalty is far too small, but
\begin_inset Formula $\textrm{pen}_{n}^{B}$
\end_inset

 lies interestingly close to the subsampled bias.
 This is likely due to the regular shape of 
\begin_inset Formula $\mbox{Beta}(2,7)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename OppgaveR/PenaltyComparisons.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:PenaltyPlot"

\end_inset

A comparison of the different penalties when the underlying distribution
 is 
\begin_inset Formula $\mbox{Beta}(2,7)$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
For each 
\begin_inset Formula $n$
\end_inset

, we calculate the penalised likelihood for 
\begin_inset Formula $k=3,4,...2\left\lceil n^{\frac{1}{3}}\right\rceil ,$
\end_inset

 which should be more than enough.
 The case when 
\begin_inset Formula $k=2$
\end_inset

 is dropped, as it is deemed unlikely that it would ever be used in practice.
 For the 
\begin_inset Formula $CIC$
\end_inset

s, we subsample 
\begin_inset Formula $K=50$
\end_inset

 times in order to keep the execution time down.
 For 
\begin_inset Formula $n=50,100,200,500$
\end_inset

 we obtain the Hellinger risks and mean 
\begin_inset Formula $k$
\end_inset

 chosen for all the different approaches, each replicated 
\begin_inset Formula $N=100$
\end_inset

 times.
 The distributions under consideration are 
\begin_inset Formula $\mbox{Beta}(2,7)$
\end_inset

, 
\begin_inset Formula $\mbox{Beta}(\frac{5}{6},\frac{7}{8})$
\end_inset

 (in Table 
\begin_inset CommandInset ref
LatexCommand eqref
reference "tab:Beta27etc"

\end_inset

), and
\begin_inset Formula $\mbox{Beta}(3,3)$
\end_inset

 and a bimodal 
\begin_inset Formula $(0.5,0.5)$
\end_inset

-mixture of 
\begin_inset Formula $\mbox{Beta}(10,40)$
\end_inset

 and 
\begin_inset Formula $\mbox{Beta}(40,10$
\end_inset

) in Table 
\begin_inset CommandInset ref
LatexCommand eqref
reference "tab:Beta33etc"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="14" columns="10">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\mbox{Beta}(2,7)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\mbox{Beta}(\frac{5}{6},\frac{7}{8})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
500
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $k$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{L_{2}v}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.04
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.69
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.79
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.14
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.09
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.03
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{KLv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.56
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
6.82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
7.86
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.02
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.47
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.32
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{L_{2}e}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.96
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.28
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.89
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.07
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.03
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{KLe}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.77
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
6.36
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
7.77
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.28
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.48
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.38
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\textrm{pen}_{n}^{B}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.22
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.51
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.28
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.35
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\textrm{pen}_{n}^{AIC}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.02
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
Hell
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{L_{2}v}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2199
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1826
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1682
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1675
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.1251
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.085
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.0642
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.0475
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{KLv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2103
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.1718
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1424
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.1061
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1648
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1327
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.0927
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.0639
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{L_{2}e}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.3132
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.3141
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.3203
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.3138
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1322
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.0844
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.0671
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.0532
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{KLe}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.3004
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2756
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2513
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2205
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.148
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.107
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.0732
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.0532
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\textrm{pen}_{n}^{B}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2005
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1751
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.1405
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1102
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1436
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1166
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.0874
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.0599
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\textrm{pen}_{n}^{AIC}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.1979
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1795
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1661
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1595
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1431
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1163
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.0871
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.0599
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Beta27etc"

\end_inset

Hellinger distances for 
\begin_inset Formula $\mbox{Beta}(2,7)$
\end_inset

 and 
\begin_inset Formula $\mbox{Beta}(\frac{5}{6},\frac{7}{8})$
\end_inset

.
 The best results are in bold.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center

\size tiny
\begin_inset Tabular
<lyxtabular version="3" rows="14" columns="10">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\mbox{Beta}(3,3)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
Bimodal
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
500
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $k$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{L_{2}v}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.47
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.28
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.06
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.41
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.96
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.52
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.74
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{KLv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
6.11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
6.51
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
6.94
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
7.96
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
9.81
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
12.6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{L_{2}e}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.48
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.19
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.06
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.72
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.52
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{KLe}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.14
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
6.23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
6.24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
6.88
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
8.22
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
9.57
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
12.41
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\textrm{pen}_{n}^{B}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.04
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.69
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.97
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5.53
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
6.72
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
9.65
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\textrm{pen}_{n}^{AIC}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.96
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.94
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
4.99
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
Hell
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{L_{2}v}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2066
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1742
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1711
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1689
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.3874
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.4089
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.3328
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2466
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{KLv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1671
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.1373
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.1045
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.2672
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.2199
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.183
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.1344
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{L_{2}e}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2809
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2646
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2606
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2489
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.4583
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.4891
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.4484
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.3928
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $CIC_{KLe}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2603
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2376
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2163
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1965
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.386
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.3464
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.3173
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2727
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\textrm{pen}_{n}^{B}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.179
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1648
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1437
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1077
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.271
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2315
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1994
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.146
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
\begin_inset Formula $\textrm{pen}_{n}^{AIC}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1794
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size tiny
0.1639
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1542
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.1484
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2726
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2437
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2264
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size tiny
0.2158
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Beta33etc"

\end_inset

Hellinger distances for 
\begin_inset Formula $\mbox{Beta}(3,3)$
\end_inset

 and the bimodal distribution.
 The best results are in bold.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This study suggests a couple of tentative conclusions:
\end_layout

\begin_layout Enumerate
The Kullback-Leibler CICs are superior to the 
\begin_inset Formula $L_{2}$
\end_inset

 CICs; the 
\begin_inset Formula $L_{2}$
\end_inset

 CICs select too few bins.
\end_layout

\begin_layout Enumerate
Constant weights increase the Hellinger risk, unless the underlying distribution
 is 
\begin_inset Quotes eld
\end_inset

difficult
\begin_inset Quotes erd
\end_inset

, like 
\begin_inset Formula $\mbox{Beta}(\frac{5}{6},\frac{7}{8})$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\textrm{pen}_{n}^{B}$
\end_inset

 performs very well, but 
\begin_inset Formula $CIC_{KLv}$
\end_inset

 appears to be best.
\end_layout

\begin_layout Standard
In applications, 
\begin_inset Formula $\textrm{pen}_{n}^{B}$
\end_inset

 would be preferred since it is much faster to compute, while AIC is too
 greedy with the bins when 
\begin_inset Formula $n$
\end_inset

 is large.
\end_layout

\begin_layout Standard
All the distributions we have used are smooth, but there is no a priori
 reason why the 
\begin_inset Formula $CIC$
\end_inset

 wouldn't work in more general settings when we use the subsample to estimate
 the bias.
 It would be of interest to run a larger scale comparison study with other
 bin selection procedures, using e.g.
 the distributions described in figure 1 of 
\begin_inset CommandInset citation
LatexCommand citet
key "rozenholc2010combining"

\end_inset

.
\end_layout

\begin_layout Chapter
Summing it up
\end_layout

\begin_layout Quote
\noindent
\align right
From this it will follow, when arithmetical addition has been defined, that
 
\begin_inset Formula $1+1=2$
\end_inset

.
\end_layout

\begin_layout Quote
\noindent
\align right
- Alfred North Whitehead and Bertrand Russell in p.
 379 of the 
\emph on
Principia Mathematica
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Section
On the 
\begin_inset Formula $\mathtt{R}$
\end_inset

 programs
\end_layout

\begin_layout Subsection
Manski's maximum score estimator
\end_layout

\begin_layout Standard
In Appendix 
\begin_inset CommandInset ref
LatexCommand vref
reference "chap:Manski's estimator"

\end_inset

 we supply the code for a small program which can be used for Manski's estimator
 in one and two dimensions.
 This uses the formula convention from 
\begin_inset Formula $\mathtt{R}$
\end_inset

, and can be called by using 
\begin_inset Formula $\mathtt{mms(resp\sim cov1+cov2)}$
\end_inset

, where 
\begin_inset Formula $\mathtt{resp,cov1,cov2}$
\end_inset

 are the responses and covariate vectors.
 In addition to this functionality, we have supplied plotting generics.
 The program is ready to use.
\end_layout

\begin_layout Subsection
Histograms
\end_layout

\begin_layout Standard
A program for computing irregular 
\begin_inset Formula $L_{2}$
\end_inset

/
\begin_inset Formula $KL$
\end_inset

-histograms is supplied in Appendix 
\begin_inset CommandInset ref
LatexCommand vref
reference "chap:Histogram"

\end_inset

.
 We support the calculation of exact histograms through the dynamic programming
 algorithm (with the important modulating 
\begin_inset Formula $\delta>0$
\end_inset

 discussed in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Presmoothing-and-instability"

\end_inset

), approximate histograms through the coordinate search algorithm, and pre-smoot
hed histograms by means of the coordinate search algorithm combined with
 the Gaussian copula kernel density estimator if Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Kernel-density-estimators"

\end_inset

.
 Histograms are only supported for data on 
\begin_inset Formula $[0,1]$
\end_inset

.
 Additionally, we provide functions to compute the subsampling based CIC.
 Furthermore, we have provided plotting and printing generics for the new
 
\begin_inset Formula $\mathtt{histogram}$
\end_inset

 class of objects.
 A function for the computation of the Gaussian copula kernel density estimator
 with the normal reference is supplied.
\end_layout

\begin_layout Section
Things one might do
\end_layout

\begin_layout Standard
In the authors opinion, two unfinished problems stand out as worth completing
 in this thesis: Finding the breakdown point of Manski's estimator for higher
 dimensions, and the 
\begin_inset Formula $L_{1}$
\end_inset

-consistency of the irregular histograms.
 We describe some other things it could be worth checking out.
\end_layout

\begin_layout Subsection
Manski's maximum score estimator
\end_layout

\begin_layout Standard
As already said, it remains to find the breakdown point in dimensions higher
 than one.
 An important part of this work is to analyse the multidimensional colour
 depth properly.
 Other robustness properties should also be investigated, for instance the
 maximal asymptotic bias 
\begin_inset CommandInset citation
LatexCommand citep
after "chapter 3.3"
key "maronna2006robust"

\end_inset

.
 One can attempt to mimic the algorithm in 
\begin_inset CommandInset citation
LatexCommand cite
key "van1999efficient"

\end_inset

, which solves the deepest regression problem in covariate dimension 
\begin_inset Formula $d=1$
\end_inset

 in 
\begin_inset Formula $O(n\log^{2}n)$
\end_inset

 time, in order to compute Manski's estimator when 
\begin_inset Formula $d=2$
\end_inset

 faster than we have with our algorithm.
 Can one constructively prove constructively that the bootstrap fails, by
 doing something similar as in the of the proof of the bootstrap failure
 for the uniform distribution? It might be possible to do this by getting
 bounds on how far away the bootstrapped solution sets can be from the real
 solution sets as 
\begin_inset Formula $n\to\infty$
\end_inset

, maybe by using some clever combinatorial argument.
 
\end_layout

\begin_layout Standard
Problems with 
\begin_inset Formula $d>2$
\end_inset

 hasn't been touched in this thesis, and should be studied.
 For instance, 
\begin_inset CommandInset citation
LatexCommand citet
key "florios2008exact"

\end_inset

 (F&L) show that the estimates of 
\begin_inset CommandInset citation
LatexCommand citet
key "horowitz1993semiparametric"

\end_inset

 for his work-trip data (
\begin_inset Formula $d=4$
\end_inset

) are probably wrong.
 However, F&Ls estimates conflict sharply with the 
\begin_inset Quotes eld
\end_inset

safe
\begin_inset Quotes erd
\end_inset

 estimates of Horowitz' smoothed maximum score estimator 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "horowitz1992smoothed"

\end_inset

, and they fail to mention the geometry of Manski's estimator which makes
 it possible for the solution sets to be very large.
 This could have practical consequences: The interpretation of F&L differ
 dramatically from Horowitz'.
 A proper empirical (or theoretical) study of Manski's estimator in 
\begin_inset Formula $d>2$
\end_inset

 would give us a greater understanding of how the solution sets behaves,
 and whether it is important to calculate the whole solution set or not.
 Also, an implemented algorithm would answer the question of whether both
 Horowitz and F&L are 
\begin_inset Quotes eld
\end_inset

right
\begin_inset Quotes erd
\end_inset

 at the same time.
 (As F&L aptly demonstrated, Horowitz' estimates, originated from an approximati
on algorithm, were far off the mark.
 This is consistent with our warning against approximating algorithms for
 this problem, recall Theorem 
\begin_inset CommandInset ref
LatexCommand vref
reference "thm:MAX-FLS-is-2-approximable"

\end_inset

.)
\end_layout

\begin_layout Standard
An 
\begin_inset Formula $\mathtt{R}$
\end_inset

-package for Manski's estimator could be developed.
 Such a package should include a function for the calculation of entire
 solution sets for 
\begin_inset Formula $d>2$
\end_inset

, and some kind of error reporting.
 Currently, only subsampling and the smoothed bootstrap can do the job.
 Finally, we need a model selection procedure.
 This could work by counting the number of correct classifications compared
 to the expected number of correct classification given covariates with
 no information.
\end_layout

\begin_layout Subsection
Histograms
\end_layout

\begin_layout Standard
One could mimic the approach in 
\begin_inset CommandInset citation
LatexCommand cite
key "banerjee2007confidence"

\end_inset

 in order to obtain analogues of their RSS confidence intervals.
 It still remains to be proved rigorously that the bootstrap is inconsistent,
 and it should be shown that the smoothed bootstrap is consistent for some
 rate and additional constraints on the 
\begin_inset Formula $f$
\end_inset

s.
 Also, the properties of the pre-smoothed histograms should be investigated,
 and it could be worthwhile to develop bin selection procedures for such
 kinds of histograms, especially with specific goals (like compressing the
 data for a specific application) in mind.
 It might also be worth it to investigate the BHHJ histograms, especially
 since a master theorem for the BHHJ histograms would include everything
 about both KL and 
\begin_inset Formula $L_{2}$
\end_inset

 histograms, including a generalised CIC for the entire family of divergences.
 Also the Kolmogorov distance can be investigated, despite its apparent
 drawbacks: For instance, it might converge at a different rate than the
 BHHJ histograms, which almost certainly would converge with the cube root
 rate for any choice of 
\begin_inset Formula $\alpha$
\end_inset

.
 More importantly, the 
\begin_inset Formula $L_{1}$
\end_inset

-histograms should be investigated.
 
\end_layout

\begin_layout Standard
There is much that could be done on the algorithmic side.
 Like investigating the idea mentioned in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Algorithms"

\end_inset

 on 
\begin_inset Quotes eld
\end_inset

ensmarting
\begin_inset Quotes erd
\end_inset

 the dynamic programming algorithm.
 Also completely different algorithms might be viable.
 If we could get the run time down to for instance 
\begin_inset Formula $O(nk\log n)$
\end_inset

, subsampling would be far more viable.
 It would also be nice to find efficient approximation algorithms with proven
 worst case performance both with regards to the objective function and
 the estimates.
 These algorithms should be incorporated with an associated 
\begin_inset Formula $\delta$
\end_inset

 bounding the minimum distance between split points.
 
\end_layout

\begin_layout Standard
There is a package for irregular histograms on 
\begin_inset Formula $\mathtt{CRAN}$
\end_inset

, namely 
\begin_inset Formula $\mathtt{histogram}$
\end_inset

 of 
\begin_inset CommandInset citation
LatexCommand citet
key "histogram"

\end_inset

, a package which can do all the different forms of bin selection procedures
 considered in 
\begin_inset CommandInset citation
LatexCommand citet
key "rozenholc2010combining"

\end_inset

.
 In this thesis, we have developed the 
\begin_inset Formula $CIC$
\end_inset

, quantile histograms and 
\begin_inset Formula $L_{2}$
\end_inset

-histograms, which is not included in this package.
 Also, the package doesn't handle the instability issue in clear-cut way,
 and hasn't implemented the dynamic programming algorithm in 
\begin_inset Formula $\mathtt{C++}$
\end_inset

, making it too slow for practical use.
 Finally, as pre-smoothing dramatically reduces the Hellinger risk and the
 MISE for 
\begin_inset Formula $k$
\end_inset

 large enough, it should be made publicly available.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "C:/Users/Jonas/Google Drive/bib"
options "bibtotoc,plain"

\end_inset


\end_layout

\begin_layout Chapter
\start_of_appendix
Histogram code
\begin_inset CommandInset label
LatexCommand label
name "chap:Histogram"

\end_inset


\end_layout

\begin_layout Standard
We present all the code involved in the calculation of histograms.
\end_layout

\begin_layout Enumerate
The 
\begin_inset Formula $\mathtt{C++}$
\end_inset

 code for the computation of exact histograms via the DP algorithm,
\end_layout

\begin_layout Enumerate
the 
\begin_inset Formula $\mathtt{C++}$
\end_inset

 code for the coordinate search,
\end_layout

\begin_layout Enumerate
the 
\begin_inset Formula $\mathtt{R}$
\end_inset

 code for the Gaussian copula KDE,
\end_layout

\begin_layout Enumerate
the 
\begin_inset Formula $\mathtt{R}$
\end_inset

 wrapper with generics,
\end_layout

\begin_layout Section
\begin_inset Formula $\mathtt{C++}$
\end_inset

 code for the DP algorithm
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language={[GNU]C++},numbers=left,stepnumber=1,basicstyle={\scriptsize},breaklines=true"
inline false
status open

\begin_layout Plain Layout

#include <cmath>
\end_layout

\begin_layout Plain Layout

#include <vector>
\end_layout

\begin_layout Plain Layout

#include <Rcpp.h>
\end_layout

\begin_layout Plain Layout

#include <iostream>
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

using namespace std;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

/* Functions for combos of real and l2*/
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

double (*residual)(int,int,double*,int,double,double);
\end_layout

\begin_layout Plain Layout

double (*residual_final)(int,double*,int,double,double);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

/* These correspond to Kullback-Leibler and equal weights.
 */
\end_layout

\begin_layout Plain Layout

double rkf(int i,int j,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double a = -(j-i);
\end_layout

\begin_layout Plain Layout

  double b = data[j]-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return(a*log(b));
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

double rkf_final(int i,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double a = -(len-i);
\end_layout

\begin_layout Plain Layout

  double b = 1-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return(a*log(b));
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

/* These correspond to L2 and equal weights.
 */    
\end_layout

\begin_layout Plain Layout

double rlf(int i,int j,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double a = 2*(j-i)/((double) len)-1/k;
\end_layout

\begin_layout Plain Layout

  double b = data[j]-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return(a/b);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

double rlf_final(int i,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double a = 2*(len-i)/((double) len)-1/k;
\end_layout

\begin_layout Plain Layout

  double b = 1-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return(a/b);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

/* ...
 and these correspond to KL weights and splits! */
\end_layout

\begin_layout Plain Layout

double rkt(int i,int j,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double b = data[j]-data[i];
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  /* A special case occurs whener i = 0.
 Then log(j-i) should equal 
\end_layout

\begin_layout Plain Layout

     log(j-1) instead */
\end_layout

\begin_layout Plain Layout

  if (i == 0) i = 1;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  /* This is required in order to avoid log(0)-c, which is indeterminate.
 */
\end_layout

\begin_layout Plain Layout

  if (i == 1 && j == 1) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  return((j-i)*(log(j-i)-log(len)-log(b)));
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

double rkt_final(int i,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double b = 1-data[i];
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (i == 0) i = 1;
\end_layout

\begin_layout Plain Layout

  return((len-i)*(log(len-i)-log(len)-log(b)));
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

/* Finally, L2 weights and splits.
 */
\end_layout

\begin_layout Plain Layout

double rlt(int i,int j,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double b = data[j]-data[i];
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (i == 0) i = 1;
\end_layout

\begin_layout Plain Layout

  if (i == 1 && j == 1) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  double a = pow(j-i,2);
\end_layout

\begin_layout Plain Layout

  return(a/b);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

double rlt_final(int i,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double b = 1-data[i];
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (i == 0) i = 1;
\end_layout

\begin_layout Plain Layout

  double a = pow(1-i,2);
\end_layout

\begin_layout Plain Layout

  return(a/b);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// [[Rcpp::export]]
\end_layout

\begin_layout Plain Layout

Rcpp::NumericMatrix cpp_exact_alg(bool real_hist,bool l2,Rcpp::NumericVector
 data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    /* residual and residual_final point to the functions needed in maximisation.
 
\end_layout

\begin_layout Plain Layout

     * The definition of these functions vary as L2 and real varies, every
 other aspect
\end_layout

\begin_layout Plain Layout

     * of the algorithm stays constant.
\end_layout

\begin_layout Plain Layout

     */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    if (real_hist) {
\end_layout

\begin_layout Plain Layout

        if (l2) {
\end_layout

\begin_layout Plain Layout

            residual = &rlt;
\end_layout

\begin_layout Plain Layout

            residual_final = &rlt_final;         
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

        else {
\end_layout

\begin_layout Plain Layout

            residual = &rkt;
\end_layout

\begin_layout Plain Layout

            residual_final = &rkt_final;
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    else {
\end_layout

\begin_layout Plain Layout

        if (l2) {
\end_layout

\begin_layout Plain Layout

            residual = &rlf;
\end_layout

\begin_layout Plain Layout

            residual_final = &rlf_final;
\end_layout

\begin_layout Plain Layout

         
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

        else {
\end_layout

\begin_layout Plain Layout

            residual = &rkf;
\end_layout

\begin_layout Plain Layout

            residual_final = &rkf_final;
\end_layout

\begin_layout Plain Layout

        }    
\end_layout

\begin_layout Plain Layout

    }   
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    /* We define the pretty "matrix" of estimates indices, with the correct
 dimensions.
\end_layout

\begin_layout Plain Layout

     * This matrix contains the ML / L2 estimate indices, as j-ary vectors.
 The (i,j)-th 
\end_layout

\begin_layout Plain Layout

     * element corresponds to ML-estimate with k=j and data[0:j].
 */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    vector < vector < vector < int > > > estimates;
\end_layout

\begin_layout Plain Layout

    estimates.resize(len+2);
\end_layout

\begin_layout Plain Layout

    for (int i = 0; i <= len+1; i++){
\end_layout

\begin_layout Plain Layout

        estimates[i].resize(k);
\end_layout

\begin_layout Plain Layout

        for (int j = 0;j<(k-1);j++){
\end_layout

\begin_layout Plain Layout

            estimates[i][j].resize(j+1);
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    /* This matrix contains the optimal objective values at (i,j) instead
 of the estimates.
 
\end_layout

\begin_layout Plain Layout

     * It doesn't need crazy dimensions.
 */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    vector < vector < double > > objective;
\end_layout

\begin_layout Plain Layout

    objective.resize(len+2);
\end_layout

\begin_layout Plain Layout

    for (int i = 0; i <= len+1; i++){
\end_layout

\begin_layout Plain Layout

        objective[i].resize(k-1);
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    /* We begin on the actual algorithm.
 */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    /* The special case when j = 0.
 Needed in order to get initial values.
 Also, the case when i = len+1 is 
\end_layout

\begin_layout Plain Layout

     * extra special.
 However, it is only needed when k = 2.
 */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    vector <int> est;
\end_layout

\begin_layout Plain Layout

    est.resize(1);
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    for (int i=2; i<=len;i++){
\end_layout

\begin_layout Plain Layout

        double maxer = residual(0,1,data.begin(),len,k,lim)+residual(1,i,data.begi
n(),len,k,lim);
\end_layout

\begin_layout Plain Layout

        double temp_max;
\end_layout

\begin_layout Plain Layout

        int ind = 1;
\end_layout

\begin_layout Plain Layout

        for (int p=2; p<i; p++){
\end_layout

\begin_layout Plain Layout

            temp_max = residual(0,p,data.begin(),len,k,lim)+residual(p,i,data.begi
n(),len,k,lim);
\end_layout

\begin_layout Plain Layout

            if (temp_max > maxer){
\end_layout

\begin_layout Plain Layout

                maxer = temp_max;
\end_layout

\begin_layout Plain Layout

                ind = p;
\end_layout

\begin_layout Plain Layout

            }
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

        est[0] = ind;
\end_layout

\begin_layout Plain Layout

        estimates[i][0] = est;
\end_layout

\begin_layout Plain Layout

        objective[i][0] = maxer;
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    /* Now we can handle the case when j=0 and i = len + 1! */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    int i = len + 1;
\end_layout

\begin_layout Plain Layout

    double maxer = residual(0,1,data.begin(),len,k,lim)+residual_final(1,data.begi
n(),len,k,lim);
\end_layout

\begin_layout Plain Layout

    double temp_max;
\end_layout

\begin_layout Plain Layout

    int ind = 1;
\end_layout

\begin_layout Plain Layout

    for (int l=2; l<i; l++){
\end_layout

\begin_layout Plain Layout

        temp_max = residual(0,l,data.begin(),len,k,lim)+residual_final(l,data.begi
n(),len,k,lim);
\end_layout

\begin_layout Plain Layout

        if (temp_max > maxer){
\end_layout

\begin_layout Plain Layout

            maxer = temp_max;
\end_layout

\begin_layout Plain Layout

            ind = l;
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

    est[0] = ind;
\end_layout

\begin_layout Plain Layout

    estimates[i][0] = est;
\end_layout

\begin_layout Plain Layout

    objective[i][0] = maxer;
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    /* The main program follows, the generation of the two matrices objective
 and estimates.
 
\end_layout

\begin_layout Plain Layout

     * We begin with iteration through j, as the calculation of estimates[i,j]
 depends on knowing (almost) every
\end_layout

\begin_layout Plain Layout

     * value estimates[i',j], with i' < i.
 */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    for (int j=1; j<(k-1);j++){
\end_layout

\begin_layout Plain Layout

        // Initialisation of variables used in loop.
\end_layout

\begin_layout Plain Layout

        vector <int> est;
\end_layout

\begin_layout Plain Layout

        est.resize(j+1);
\end_layout

\begin_layout Plain Layout

        double maxer, temp_max;
\end_layout

\begin_layout Plain Layout

        int ind;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

        /* Calculates the matrix for every term except i=len+1, which is
 a special case.
 */
\end_layout

\begin_layout Plain Layout

        for (int i=j+2; i<len+1;i++){
\end_layout

\begin_layout Plain Layout

            
\end_layout

\begin_layout Plain Layout

            /* Given an i, we wish to find the best estimates for data[0,i]
 
\end_layout

\begin_layout Plain Layout

             * given that k=j.
 We use i = j+2 in order to have enough points to fit the data:
\end_layout

\begin_layout Plain Layout

             * The "best" case is that (i-1) is the optimal index, and this
 one needs j points
\end_layout

\begin_layout Plain Layout

             * of data below it.
 We start with i-1, and continue through the loop.
 */
\end_layout

\begin_layout Plain Layout

             
\end_layout

\begin_layout Plain Layout

            maxer = objective[i-1][j-1]+residual(i-1,i,data.begin(),len,k,lim);
\end_layout

\begin_layout Plain Layout

            ind = i-1;
\end_layout

\begin_layout Plain Layout

            
\end_layout

\begin_layout Plain Layout

            /* We have the condition p>=j+1 for the same reason as above.
 If p = j or less, 
\end_layout

\begin_layout Plain Layout

             * there will not be the needed j points below it.
 */
\end_layout

\begin_layout Plain Layout

             
\end_layout

\begin_layout Plain Layout

            for (int p = (i-2);p>=(j+1);p--){
\end_layout

\begin_layout Plain Layout

                temp_max = objective[p][j-1]+residual(p,i,data.begin(),len,k,lim)
;
\end_layout

\begin_layout Plain Layout

                if (temp_max > maxer){
\end_layout

\begin_layout Plain Layout

                    maxer = temp_max;
\end_layout

\begin_layout Plain Layout

                    ind = p;
\end_layout

\begin_layout Plain Layout

                }
\end_layout

\begin_layout Plain Layout

            }
\end_layout

\begin_layout Plain Layout

                
\end_layout

\begin_layout Plain Layout

            /* Our resulting objective is maxer, while our indices are,
 the winning estimates'
\end_layout

\begin_layout Plain Layout

             * indices concatenated with with the index which makes them
 win.
 */
\end_layout

\begin_layout Plain Layout

             
\end_layout

\begin_layout Plain Layout

            objective[i][j] = maxer;
\end_layout

\begin_layout Plain Layout

            est = estimates[ind][j-1];
\end_layout

\begin_layout Plain Layout

            est.push_back(ind);
\end_layout

\begin_layout Plain Layout

            estimates[i][j] = est;
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

   
\end_layout

\begin_layout Plain Layout

        /* We proceed with the special case i = len+1.
 The reason why this is a special case is 
\end_layout

\begin_layout Plain Layout

         * that Pn(1) = Pn(x_n), the final observation in the data set.
 This makes the residual function 
\end_layout

\begin_layout Plain Layout

         * return incorrect values.
 
\end_layout

\begin_layout Plain Layout

        */
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

        int i = len+1;
\end_layout

\begin_layout Plain Layout

        maxer = objective[i-1][j-1];
\end_layout

\begin_layout Plain Layout

        ind = i-1;
\end_layout

\begin_layout Plain Layout

             
\end_layout

\begin_layout Plain Layout

        for (int p = (i-2);p>=(j+1);p--){
\end_layout

\begin_layout Plain Layout

            temp_max = objective[p][j-1]+residual_final(p,data.begin(),len,k,lim)
;
\end_layout

\begin_layout Plain Layout

            if (temp_max > maxer){
\end_layout

\begin_layout Plain Layout

                maxer = temp_max;
\end_layout

\begin_layout Plain Layout

                ind = p;
\end_layout

\begin_layout Plain Layout

            }
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

                
\end_layout

\begin_layout Plain Layout

        objective[i][j] = maxer;
\end_layout

\begin_layout Plain Layout

        est = estimates[ind][j-1];
\end_layout

\begin_layout Plain Layout

        est.push_back(ind);
\end_layout

\begin_layout Plain Layout

        estimates[i][j] = est;
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

        /* We print out the content of the vector.
 */
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

    } 
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    Rcpp::NumericMatrix xx = Rcpp::NumericMatrix(Rcpp::Dimension(k-1, k-1));
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

    for (int i=0;i<k-1;i++){
\end_layout

\begin_layout Plain Layout

      for (int j=0;j<=i;j++) {
\end_layout

\begin_layout Plain Layout

        xx(i,j) = estimates[len+1][i][j];
\end_layout

\begin_layout Plain Layout

      }
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    return(xx);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset Formula $\mathtt{C++}$
\end_inset

 code for the coordinate search
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language={[GNU]C++},numbers=left,stepnumber=1,basicstyle={\scriptsize},breaklines=true"
inline false
status open

\begin_layout Plain Layout

#include <cmath>
\end_layout

\begin_layout Plain Layout

#include <vector>
\end_layout

\begin_layout Plain Layout

#include <Rcpp.h>
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

using namespace std;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

/* Functions for combos of real and l2*.
 These pointers are needed in order to
\end_layout

\begin_layout Plain Layout

 * avoid many repeated if calls and make the code more readable.
 */
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

double (*residual)(int,int,double*,int,double,double);
\end_layout

\begin_layout Plain Layout

double (*residual_final)(int,double*,int,double,double);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

/* These correspond to Kullback-Leibler and equal weights.
 */
\end_layout

\begin_layout Plain Layout

double rkf(int i,int j,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double a = -(j-i);
\end_layout

\begin_layout Plain Layout

  double b = data[j]-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return(a*log(b));
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

double rkf_final(int i,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double a = -(len-i);
\end_layout

\begin_layout Plain Layout

  double b = 1-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return(a*log(b));
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

/* These correspond to L2 and equal weights.
 */    
\end_layout

\begin_layout Plain Layout

double rlf(int i,int j,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double a = 2*(j-i)/((double) len)-1/k;
\end_layout

\begin_layout Plain Layout

  double b = data[j]-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return(a/b);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

double rlf_final(int i,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double a = 2*(len-i)/((double) len)-1/k;
\end_layout

\begin_layout Plain Layout

  double b = 1-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return(a/b);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

/* ...
 and these correspond to KL weights and splits! */
\end_layout

\begin_layout Plain Layout

double rkt(int i,int j,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double b = data[j]-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return((j-i)*(log(j-i)-log(len)-log(b)));
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

double rkt_final(int i,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double b = 1-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return((len-i)*(log(len-i)-log(len)-log(b)));
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

/* Finally, L2 weights and splits.
 */
\end_layout

\begin_layout Plain Layout

double rlt(int i,int j,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double a = pow(j-i,2);
\end_layout

\begin_layout Plain Layout

  double b = data[j]-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return(a/b);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

double rlt_final(int i,double* data,int len,double k,double lim){
\end_layout

\begin_layout Plain Layout

  double a = pow(1-i,2);
\end_layout

\begin_layout Plain Layout

  double b = 1-data[i];
\end_layout

\begin_layout Plain Layout

  if (b < lim) return -0.1/0.0;
\end_layout

\begin_layout Plain Layout

  else return(a/b);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// [[Rcpp::export]]
\end_layout

\begin_layout Plain Layout

Rcpp::NumericVector cpp_greedy_alg(bool real_hist,bool l2,Rcpp::NumericVector
 data,
\end_layout

\begin_layout Plain Layout

                                   int len,double k,int modulator,Rcpp::NumericV
ector init,
\end_layout

\begin_layout Plain Layout

                                   double lim){
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    /* residual and residual_final point to the functions needed in maximisation.
 
\end_layout

\begin_layout Plain Layout

     * The definition of these functions vary as L2 and real varies, every
 other aspect
\end_layout

\begin_layout Plain Layout

     * of the algorithm stays constant.
\end_layout

\begin_layout Plain Layout

     */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    if (real_hist) {
\end_layout

\begin_layout Plain Layout

        if (l2) {
\end_layout

\begin_layout Plain Layout

            residual = &rlt;
\end_layout

\begin_layout Plain Layout

            residual_final = &rlt_final;         
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

        else {
\end_layout

\begin_layout Plain Layout

            residual = &rkt;
\end_layout

\begin_layout Plain Layout

            residual_final = &rkt_final;
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    else {
\end_layout

\begin_layout Plain Layout

        if (l2) {
\end_layout

\begin_layout Plain Layout

            residual = &rlf;
\end_layout

\begin_layout Plain Layout

            residual_final = &rlf_final;
\end_layout

\begin_layout Plain Layout

         
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

        else {
\end_layout

\begin_layout Plain Layout

            residual = &rkf;
\end_layout

\begin_layout Plain Layout

            residual_final = &rkf_final;
\end_layout

\begin_layout Plain Layout

        }    
\end_layout

\begin_layout Plain Layout

    }   
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    /* We define the pretty "matrix" estimatse indices, with the correct
 dimensions.
\end_layout

\begin_layout Plain Layout

     * This matrix contains the ML / L2 estimate indices, as j-ary vectors.
 The (i,j)-th 
\end_layout

\begin_layout Plain Layout

     * element corresponds to ML-estimate with k=j and data[0:j].
 */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    vector <int> estimates;
\end_layout

\begin_layout Plain Layout

    vector <int> test_estimates;
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    estimates.resize((int) k+1);
\end_layout

\begin_layout Plain Layout

    test_estimates.resize((int) k+1);
\end_layout

\begin_layout Plain Layout

    estimates[0] = 0;
\end_layout

\begin_layout Plain Layout

    estimates[k] = 1;
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    for(int i = 1;i<k;i++){
\end_layout

\begin_layout Plain Layout

      estimates[i] = init[i-1];
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    int ended = 0;
\end_layout

\begin_layout Plain Layout

    int over;
\end_layout

\begin_layout Plain Layout

    int under;
\end_layout

\begin_layout Plain Layout

    double max;
\end_layout

\begin_layout Plain Layout

    double temp;
\end_layout

\begin_layout Plain Layout

    for (int j = 0;j<modulator*k;j++){
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

      test_estimates = estimates;
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

      /* The loop takes care of all the values except the final.
 */
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

      for (int i=1;i<(k-1);i++){
\end_layout

\begin_layout Plain Layout

        over = estimates[i+1];
\end_layout

\begin_layout Plain Layout

        under = estimates[i-1];
\end_layout

\begin_layout Plain Layout

        max = -0.1/0.0;
\end_layout

\begin_layout Plain Layout

        for (int p = under; p<over;p++){
\end_layout

\begin_layout Plain Layout

          if (data[p]-data[under]>lim && data[over]-data[p]>lim){
\end_layout

\begin_layout Plain Layout

            temp = residual(under,p,data.begin(),len,k,lim)+residual(p,over,data.b
egin(),len,k,lim);
\end_layout

\begin_layout Plain Layout

          }
\end_layout

\begin_layout Plain Layout

          else temp = -0.1/0.0;
\end_layout

\begin_layout Plain Layout

          if (max < temp) {
\end_layout

\begin_layout Plain Layout

            max = temp;
\end_layout

\begin_layout Plain Layout

            estimates[i] = p;
\end_layout

\begin_layout Plain Layout

          }
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

      }
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

      /* And now is the time for the last value.
 */
\end_layout

\begin_layout Plain Layout

      int i = (k-1);
\end_layout

\begin_layout Plain Layout

      under = estimates[i-1];
\end_layout

\begin_layout Plain Layout

      max = -0.1/0.0;
\end_layout

\begin_layout Plain Layout

      for (int p = under; p<(len+1);p++){
\end_layout

\begin_layout Plain Layout

        if (data[p]-data[under]>lim && 1-data[p]>lim){
\end_layout

\begin_layout Plain Layout

            temp = residual(under,p,data.begin(),len,k,lim)+residual_final(p,data.
begin(),len,k,lim);
\end_layout

\begin_layout Plain Layout

          }
\end_layout

\begin_layout Plain Layout

        else temp = -0.1/0.0;
\end_layout

\begin_layout Plain Layout

        if (max < temp) {
\end_layout

\begin_layout Plain Layout

            max = temp;
\end_layout

\begin_layout Plain Layout

            estimates[i] = p;
\end_layout

\begin_layout Plain Layout

          }
\end_layout

\begin_layout Plain Layout

      }
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

      /* We test the break condition.
 */
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

      if (test_estimates == estimates){
\end_layout

\begin_layout Plain Layout

        ended = j;
\end_layout

\begin_layout Plain Layout

        break;
\end_layout

\begin_layout Plain Layout

      }
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    Rcpp::NumericVector xx((int) k);
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

    for (int i=0;i<k-1;i++){
\end_layout

\begin_layout Plain Layout

        xx[i] = estimates[i+1];
\end_layout

\begin_layout Plain Layout

      }
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

    xx[k-1] = ended;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    return(xx);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset Formula $\mathtt{R}$
\end_inset

 code for the Gaussian copula KDE
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=R,numbers=left,stepnumber=1,basicstyle={\scriptsize},breaklines=true"
inline false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Functions for the Gaussian copula -------------------------------------------
\end_layout

\begin_layout Plain Layout

rgc = function(n,X,rho){
\end_layout

\begin_layout Plain Layout

  N = length(X)
\end_layout

\begin_layout Plain Layout

  X = qnorm(X)
\end_layout

\begin_layout Plain Layout

  xs = rnorm(n,rho*X,rep(sqrt(1-rho^2),times=N),1882)
\end_layout

\begin_layout Plain Layout

  pnorm(xs)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

dgc = Vectorize(function(x,X,rho){
\end_layout

\begin_layout Plain Layout

  inside = rho^2*(qnorm(x)^2+qnorm(X)^2)-2*rho*qnorm(x)*qnorm(X)
\end_layout

\begin_layout Plain Layout

  1/sqrt(1-rho^2)*exp(-inside/(2*(1-rho^2)))
\end_layout

\begin_layout Plain Layout

})
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

dgcd = Vectorize(function(x,X,rho){
\end_layout

\begin_layout Plain Layout

  dgc(x,X,rho)*rho/(1-rho^2)*(-rho*qnorm(x)+qnorm(X))/dnorm(qnorm(x))
\end_layout

\begin_layout Plain Layout

})
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Gaussian copula KDE functions -----------------------------------------------
\end_layout

\begin_layout Plain Layout

hgcde = function(data,lims=NULL){
\end_layout

\begin_layout Plain Layout

  if (!is.null(lims)) data = (data-lims[1])/lims[2]
\end_layout

\begin_layout Plain Layout

  trans = qnorm(data)
\end_layout

\begin_layout Plain Layout

  trans = trans[trans != Inf & trans != -Inf]
\end_layout

\begin_layout Plain Layout

  s = sd(trans)
\end_layout

\begin_layout Plain Layout

  m = mean(trans)
\end_layout

\begin_layout Plain Layout

  n = length(data)
\end_layout

\begin_layout Plain Layout

  min(s*(2*m^2*s^2+3*(1-s^2)^2)^(-1/5)*n^(-1/5),0.5)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

gcde = function(data,h=NULL,lims=NULL){
\end_layout

\begin_layout Plain Layout

  if (is.null(h)) h = hgcde(data)
\end_layout

\begin_layout Plain Layout

  if (!is.null(lims)) data = (data-lims[1])/lims[2]
\end_layout

\begin_layout Plain Layout

  else lims = c(0,1)
\end_layout

\begin_layout Plain Layout

  trans = qnorm(data)
\end_layout

\begin_layout Plain Layout

  data = data[trans != Inf & trans != -Inf]
\end_layout

\begin_layout Plain Layout

  rho = 1-h^2
\end_layout

\begin_layout Plain Layout

  function(x){
\end_layout

\begin_layout Plain Layout

    mean(dgc((x-lims[1])/lims[2],data,rho))/lims[2]
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

gcded = function(data,h=NULL,lims=NULL){
\end_layout

\begin_layout Plain Layout

  if (is.null(h)) h = hgcde(data)
\end_layout

\begin_layout Plain Layout

  if (!is.null(lims)) data = (data-lims[1])/lims[2]
\end_layout

\begin_layout Plain Layout

  else lims = c(0,1)
\end_layout

\begin_layout Plain Layout

  trans = qnorm(data)
\end_layout

\begin_layout Plain Layout

  data = data[trans != Inf & trans != -Inf]
\end_layout

\begin_layout Plain Layout

  rho = 1-h^2
\end_layout

\begin_layout Plain Layout

  function(x){
\end_layout

\begin_layout Plain Layout

    mean(dgcd((x-lims[1])/lims[2],data,rho))/lims[2]
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

hgcde = function(data,lims=NULL){
\end_layout

\begin_layout Plain Layout

  if (!is.null(lims)) data = (data-lims[1])/lims[2]
\end_layout

\begin_layout Plain Layout

  trans = qnorm(data)
\end_layout

\begin_layout Plain Layout

  trans = trans[trans != Inf & trans != -Inf]
\end_layout

\begin_layout Plain Layout

  s = sd(trans)
\end_layout

\begin_layout Plain Layout

  m = mean(trans)
\end_layout

\begin_layout Plain Layout

  n = length(data)
\end_layout

\begin_layout Plain Layout

  min(s*(2*m^2*s^2+3*(1-s^2)^2)^(-1/5)*n^(-1/5),0.5)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

rgcde = function(n,data,h=NULL,lims=NULL){
\end_layout

\begin_layout Plain Layout

  if (!is.null(lims)) data = (data-lims[1])/lims[2]
\end_layout

\begin_layout Plain Layout

  else lims = c(0,1)
\end_layout

\begin_layout Plain Layout

  if (is.null(h)) h = hgcde(data)
\end_layout

\begin_layout Plain Layout

  samples = sample(data,n,replace=TRUE)
\end_layout

\begin_layout Plain Layout

  rho = 1-h^2
\end_layout

\begin_layout Plain Layout

  (rgc(n,samples,rho))*lims[2]+lims[1]
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset Formula $\mathtt{R}$
\end_inset

 wrapper and generics 
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=R,numbers=left,stepnumber=1,basicstyle={\scriptsize},breaklines=true"
inline false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

library("Rcpp")
\end_layout

\begin_layout Plain Layout

source("copula_base.R")
\end_layout

\begin_layout Plain Layout

sourceCpp("coordinate.cpp")
\end_layout

\begin_layout Plain Layout

sourceCpp("exact.cpp")
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Support functions and variables ---------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

`%||%` <- function(a, b) if (! is.null(a)) a else b
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Algorithms ------------------------------------------------------------------
\end_layout

\begin_layout Plain Layout

coordHistogram = function(data,k,type="KL",weights="equal",lim=0.0001,
\end_layout

\begin_layout Plain Layout

                            modulator=10,init=NULL){
\end_layout

\begin_layout Plain Layout

  ret_object = list()
\end_layout

\begin_layout Plain Layout

  ret_object$specification = c(type=type,weights=weights)
\end_layout

\begin_layout Plain Layout

  ret_object$k = k
\end_layout

\begin_layout Plain Layout

  n = length(data)
\end_layout

\begin_layout Plain Layout

  type = (type == "L2")
\end_layout

\begin_layout Plain Layout

  weights = (weights!="equal")
\end_layout

\begin_layout Plain Layout

  init = (init %||% quantile(1:n,(1:(k-1))/k))
\end_layout

\begin_layout Plain Layout

  vals = cpp_greedy_alg(weights,type,c(0,data,1),n,k,
\end_layout

\begin_layout Plain Layout

           modulator=modulator,init=init,lim=lim)
\end_layout

\begin_layout Plain Layout

  as = data[vals[-k]]
\end_layout

\begin_layout Plain Layout

  ret_object$splits = as
\end_layout

\begin_layout Plain Layout

  if (!weights) {
\end_layout

\begin_layout Plain Layout

    ret_object$weights = rep(1/k,k)
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    ret_object$weights = c(sapply(1:k,
\end_layout

\begin_layout Plain Layout

                                  function(i) c(0,vals[-k]/n,1)[i+1]-c(0,vals[-k
]/n,1)[i]))
\end_layout

\begin_layout Plain Layout

    ret_object$weights[1] = ret_object$weights[1] - 1/n
\end_layout

\begin_layout Plain Layout

    ret_object$weights[k] = ret_object$weights[k] + 1/n
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  ret_object$iterations = vals[k]
\end_layout

\begin_layout Plain Layout

  ret_object$method = "greedy"
\end_layout

\begin_layout Plain Layout

  ret_object$lim = lim
\end_layout

\begin_layout Plain Layout

  class(ret_object) = c("hist")
\end_layout

\begin_layout Plain Layout

  ret_object  
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

dpHistogram = function(data,k,type="KL",weights="equal",lim=0.0001){
\end_layout

\begin_layout Plain Layout

  ret_object = list()
\end_layout

\begin_layout Plain Layout

  ret_object$specification = c(type=type,weights=weights)
\end_layout

\begin_layout Plain Layout

  ret_object$k = k
\end_layout

\begin_layout Plain Layout

  n = length(data)
\end_layout

\begin_layout Plain Layout

  type = (type=="L2")
\end_layout

\begin_layout Plain Layout

  weights = (weights!="equal")
\end_layout

\begin_layout Plain Layout

  vals = cpp_exact_alg(weights,type,c(0,data,1),n,k,lim=lim)
\end_layout

\begin_layout Plain Layout

  vals = vals[k-1,]
\end_layout

\begin_layout Plain Layout

  as = data[vals]
\end_layout

\begin_layout Plain Layout

  ret_object$splits = as
\end_layout

\begin_layout Plain Layout

  if (!weights) {
\end_layout

\begin_layout Plain Layout

    ret_object$weights = rep(1/k,k)
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    ret_object$weights = c(sapply(1:k,
\end_layout

\begin_layout Plain Layout

            function(i) c(0,vals[-k]/n,1)[i+1]-c(0,vals[-k]/n,1)[i]))
\end_layout

\begin_layout Plain Layout

    ret_object$weights[1] = ret_object$weights[1] - 1/n
\end_layout

\begin_layout Plain Layout

    ret_object$weights[k] = ret_object$weights[k] + 1/n
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  ret_object$method = "exact"
\end_layout

\begin_layout Plain Layout

  ret_object$lim = lim
\end_layout

\begin_layout Plain Layout

  class(ret_object) = c("hist")
\end_layout

\begin_layout Plain Layout

  ret_object  
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# "log likelihood"-function ----------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Pnm = function(obj,useData=data){
\end_layout

\begin_layout Plain Layout

  q     = obj$splits
\end_layout

\begin_layout Plain Layout

  w     = obj$weights
\end_layout

\begin_layout Plain Layout

  k     = obj$k
\end_layout

\begin_layout Plain Layout

  n     = length(useData)
\end_layout

\begin_layout Plain Layout

  Pn    = c(0,sapply(q,function(j) sum(useData<=j)/n),1)
\end_layout

\begin_layout Plain Layout

  qAug  = c(0,q,1)
\end_layout

\begin_layout Plain Layout

  if (obj$specification[1] == "KL") {
\end_layout

\begin_layout Plain Layout

    dis   = sapply(1:k,function(i) - log(qAug[i+1]-qAug[i]) + log(w[i]))
\end_layout

\begin_layout Plain Layout

    probs = sapply(1:k,function(i) Pn[i+1]-Pn[i])
\end_layout

\begin_layout Plain Layout

    probs[1] = probs[1] - 1/n
\end_layout

\begin_layout Plain Layout

    probs[k] = probs[k] + 1/n
\end_layout

\begin_layout Plain Layout

    return(sum(probs*dis))
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    dis   = sapply(1:k,function(i) 1/(qAug[i+1]-qAug[i]))
\end_layout

\begin_layout Plain Layout

    probs = sapply(1:k,function(i) Pn[i+1]-Pn[i])
\end_layout

\begin_layout Plain Layout

    probs[1] = probs[1] - 1/n
\end_layout

\begin_layout Plain Layout

    probs[k] = probs[k] + 1/n
\end_layout

\begin_layout Plain Layout

    return(sum(w*(2*probs-w)*dis))
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Histogram class constructor -------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

histogram = function(data,k,method="exact",seed=1882,lim=0.0001, ...){
\end_layout

\begin_layout Plain Layout

  data = sort(data)
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (method == "exact") {
\end_layout

\begin_layout Plain Layout

    obj        = dpHistogram(data,k,lim=lim,...)
\end_layout

\begin_layout Plain Layout

    obj$loglik = Pnm(obj,data)
\end_layout

\begin_layout Plain Layout

  } else if (method == "smoothed") {
\end_layout

\begin_layout Plain Layout

    n = length(data)
\end_layout

\begin_layout Plain Layout

    new_data = sort(rgcde(50*k*n,data))
\end_layout

\begin_layout Plain Layout

    obj = coordHistogram(new_data,k,lim=lim,...)
\end_layout

\begin_layout Plain Layout

    obj$method = "smoothed"
\end_layout

\begin_layout Plain Layout

    obj$loglik = Pnm(obj,new_data)
\end_layout

\begin_layout Plain Layout

    return(obj)
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    obj = coordHistogram(data,k,lim=lim,...)
\end_layout

\begin_layout Plain Layout

    obj$method = "coordinateSearch"
\end_layout

\begin_layout Plain Layout

    obj$loglik = Pnm(obj,data)
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  return(obj)
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Shortcuts -------------------------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

L2histogram = function(data,k,lim=0.0001,method="exact") {
\end_layout

\begin_layout Plain Layout

  histogram(data,k,method=method,lim=lim,type="L2",weights="L2")
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

KLhistogram = function(data,k,lim=0.0001,method="exact") {
\end_layout

\begin_layout Plain Layout

  histogram(data,k,method=method,lim=lim,type="KL",weights="KL")
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Bin selection procedures ----------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

CIC = function(data,k,b=.5,K=50,type="L2",weights="L2",lim=0.001){
\end_layout

\begin_layout Plain Layout

  n = length(data)
\end_layout

\begin_layout Plain Layout

  obj = histogram(data,k=k,type=type,weights=type,lim=lim,method="exact")
\end_layout

\begin_layout Plain Layout

  disc = obj$loglik
\end_layout

\begin_layout Plain Layout

  bias = biasSubs(data, b=b, k=k, K=K, type=type, weights=type, lim=lim)
\end_layout

\begin_layout Plain Layout

  n*disc - n*bias
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

CICselect = function(data,b=.5,K=50,type="L2",weights="L2",lim=0.0001,ks =
 seq(3,2*ceiling(nobs^(1/3)))) {
\end_layout

\begin_layout Plain Layout

  nobs = length(data)
\end_layout

\begin_layout Plain Layout

  CICs = sapply(ks,function(k) CIC(data,k,b,K,type,weights,lim=lim))
\end_layout

\begin_layout Plain Layout

  which.max(CICs) + 2
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

penB = function(data,k){
\end_layout

\begin_layout Plain Layout

  n = length(data)
\end_layout

\begin_layout Plain Layout

  obj = histogram(data,k=k,type=type,weights=type,lim=lim,method="exact")
\end_layout

\begin_layout Plain Layout

  lik = n*obj$loglik
\end_layout

\begin_layout Plain Layout

  pen = log(choose(n-1,k-1)) + (k-1) + (log(k))^(2.5)
\end_layout

\begin_layout Plain Layout

  lik - pen
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

penBselect = function(data,ks = seq(3,2*ceiling(nobs^(1/3)))){
\end_layout

\begin_layout Plain Layout

  nobs = length(data)
\end_layout

\begin_layout Plain Layout

  penBs = sapply(ks,function(k) penB(data,k))
\end_layout

\begin_layout Plain Layout

  which.max(penBs) + 2
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

penR = function(data,k,lim=.0001){
\end_layout

\begin_layout Plain Layout

  n = length(data)
\end_layout

\begin_layout Plain Layout

  obj = histogram(data,k=k,type=type,weights=type,lim=lim,method="exact")
\end_layout

\begin_layout Plain Layout

  lik = n*obj$loglik
\end_layout

\begin_layout Plain Layout

  pen = log(choose(n-1,k-1)) + 0.5*sum(obj$weights/diff(c(0,obj$splits,1)))
 + (log(k))^(2.5)
\end_layout

\begin_layout Plain Layout

  lik - pen
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

penRselect = function(data,ks = seq(3,2*ceiling(nobs^(1/3)))){
\end_layout

\begin_layout Plain Layout

  nobs = length(data)
\end_layout

\begin_layout Plain Layout

  penRs = sapply(ks,function(k) penR(data,k))
\end_layout

\begin_layout Plain Layout

  which.max(penRs) + 2
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

AICselect = function(data,ks = seq(3,2*ceiling(nobs^(1/3)))){
\end_layout

\begin_layout Plain Layout

  nobs = length(data)
\end_layout

\begin_layout Plain Layout

  AICs = sapply(ks,function(k) -AIC(histogram(data,k=k,type=type,weights=type,li
m=lim,method="exact")))
\end_layout

\begin_layout Plain Layout

  which.max(AICs) + 2  
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Generics --------------------------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

plot.hist = function(hist_obj,main=NULL,sub=NULL,xlab=NULL,ylab=NULL,rescale
 = 1,grid=TRUE,...){
\end_layout

\begin_layout Plain Layout

  splits <- c(0,hist_obj$splits,1)
\end_layout

\begin_layout Plain Layout

  xlab = ifelse(is.null(xlab),"x",xlab)
\end_layout

\begin_layout Plain Layout

  ylab = ifelse(is.null(ylab),"Density",ylab)
\end_layout

\begin_layout Plain Layout

  ys <- c(0,hist_obj$weights*sapply(1:hist_obj$k,function(i) 1/(splits[i+1]-spli
ts[i])))
\end_layout

\begin_layout Plain Layout

  if (is.null(main)) main = "Histogram"
\end_layout

\begin_layout Plain Layout

  if (is.null(sub)) sub = paste0("Irregular ",(hist_obj$specification)[1],"-histo
gram with ",(hist_obj$specification)[2]," weights.
 Method: ",hist_obj$method,"; k = ",hist_obj$k)
\end_layout

\begin_layout Plain Layout

  plot(rescale*splits,ys/rescale,type="S",bty="l",
\end_layout

\begin_layout Plain Layout

       xlab=xlab,ylab=ylab,main=main,sub=sub,...)
\end_layout

\begin_layout Plain Layout

  if(grid) {
\end_layout

\begin_layout Plain Layout

    grid()
\end_layout

\begin_layout Plain Layout

    lines(rescale*splits,ys/rescale,type="S",bty="l",
\end_layout

\begin_layout Plain Layout

         xlab=xlab,ylab=ylab,main=main,sub=sub,...)
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  lines(rescale*splits,ys/rescale,type="h",...)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

lines.hist = function(hist_obj,...){
\end_layout

\begin_layout Plain Layout

  splits <- c(0,hist_obj$splits,1)
\end_layout

\begin_layout Plain Layout

  ys <- c(0,hist_obj$weights*sapply(1:hist_obj$k,function(i) 1/(splits[i+1]-spli
ts[i])))
\end_layout

\begin_layout Plain Layout

  lines(splits,ys,type="S",...)
\end_layout

\begin_layout Plain Layout

  lines(splits,ys,type="h",...)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

print.hist = function(hist_obj){
\end_layout

\begin_layout Plain Layout

  cat("***-----------------------------*** 
\backslash
n")
\end_layout

\begin_layout Plain Layout

  cat("*** Irregular histogram object.
 *** 
\backslash
n")
\end_layout

\begin_layout Plain Layout

  cat("***-----------------------------***")
\end_layout

\begin_layout Plain Layout

  cat("
\backslash
n Type:",(hist_obj$specification)[1])
\end_layout

\begin_layout Plain Layout

  cat("
\backslash
n Weights:",(hist_obj$specification)[2])
\end_layout

\begin_layout Plain Layout

  cat("
\backslash
n Method:",hist_obj$method)
\end_layout

\begin_layout Plain Layout

  cat("
\backslash
n Splits:",hist_obj$splits)
\end_layout

\begin_layout Plain Layout

  cat("
\backslash
n Weights:",hist_obj$weights)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

logLik.hist = function(hist_obj) obj$loglik
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

AIC.hist = function(hist_obj) {
\end_layout

\begin_layout Plain Layout

  -2*n*hist_obj$loglik + 2*(hist_obj$k-1)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Error measurements ----------------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

imse = function(obj,dist){
\end_layout

\begin_layout Plain Layout

  k = obj$k
\end_layout

\begin_layout Plain Layout

  q = obj$splits
\end_layout

\begin_layout Plain Layout

  w = obj$weights
\end_layout

\begin_layout Plain Layout

  qAug = c(0,q,1)
\end_layout

\begin_layout Plain Layout

  error = 0
\end_layout

\begin_layout Plain Layout

  for (i in 2:(k+1)){
\end_layout

\begin_layout Plain Layout

    error = error + integrate(function(x) (dist(x) - w[i-1]/(qAug[i]-qAug[i-1]))
^2,
\end_layout

\begin_layout Plain Layout

                              lower = qAug[i-1],upper=qAug[i])$value
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  error
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

hellinger = function(obj,dist){
\end_layout

\begin_layout Plain Layout

  k = obj$k
\end_layout

\begin_layout Plain Layout

  q = obj$splits
\end_layout

\begin_layout Plain Layout

  w = obj$weights
\end_layout

\begin_layout Plain Layout

  qAug = c(0,q,1)
\end_layout

\begin_layout Plain Layout

  error = 0
\end_layout

\begin_layout Plain Layout

  for (i in 2:(k+1)){
\end_layout

\begin_layout Plain Layout

    error = error + integrate(function(x) (sqrt(dist(x)) - sqrt(w[i-1]/(qAug[i]-
qAug[i-1])))^2,
\end_layout

\begin_layout Plain Layout

                              lower = qAug[i-1],upper=qAug[i])$value
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  sqrt(0.5*error)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Manski's estimator code
\begin_inset CommandInset label
LatexCommand label
name "chap:Manski's estimator"

\end_inset


\end_layout

\begin_layout Standard
We provide 
\begin_inset Formula $\mathtt{C++}$
\end_inset

code for the algorithm in one and two dimensions, together with an 
\begin_inset Formula $\mathtt{R}$
\end_inset

 wrapper.
\end_layout

\begin_layout Section
One dimension
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language={[GNU]C++},numbers=left,basicstyle={\scriptsize},breaklines=true"
inline false
status open

\begin_layout Plain Layout

#include <cmath>
\end_layout

\begin_layout Plain Layout

#include <vector>
\end_layout

\begin_layout Plain Layout

#include <Rcpp.h>
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

class Point { 
\end_layout

\begin_layout Plain Layout

public: 
\end_layout

\begin_layout Plain Layout

  /* These values should be there from the beginning, when the struct is
\end_layout

\begin_layout Plain Layout

  * instantiated.
 */
\end_layout

\begin_layout Plain Layout

  double value;
\end_layout

\begin_layout Plain Layout

  double weight;
\end_layout

\begin_layout Plain Layout

  bool isRed;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  double redLeft;
\end_layout

\begin_layout Plain Layout

  double blueRight;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  double posWeight;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  Point(double _value, double _weight, bool _isRed);
\end_layout

\begin_layout Plain Layout

  Point();
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

}; 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

typedef std::vector <Point> Points;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

inline bool operator < (const Point pointOne, const Point pointTwo) { 
\end_layout

\begin_layout Plain Layout

  return pointOne.value < pointTwo.value; 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

inline bool operator > (const Point pointOne, const Point pointTwo) { 
\end_layout

\begin_layout Plain Layout

  return pointOne.value > pointTwo.value; 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Point::Point(){
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Point::Point(double _value, double _weight, bool _isRed) {
\end_layout

\begin_layout Plain Layout

  /* The basic values of the object is defined.
 */
\end_layout

\begin_layout Plain Layout

  value      = _value;
\end_layout

\begin_layout Plain Layout

  weight     = _weight;
\end_layout

\begin_layout Plain Layout

  isRed      = _isRed;
\end_layout

\begin_layout Plain Layout

  posWeight     = 0;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  /* The quickredblue procedure will never update a point 
\end_layout

\begin_layout Plain Layout

  * with its own colors.
 This is done here.
 */
\end_layout

\begin_layout Plain Layout

    if (isRed){
\end_layout

\begin_layout Plain Layout

      redLeft   = weight; 
\end_layout

\begin_layout Plain Layout

      blueRight = 0; 
\end_layout

\begin_layout Plain Layout

    } else {
\end_layout

\begin_layout Plain Layout

      redLeft   = 0; 
\end_layout

\begin_layout Plain Layout

      blueRight = weight;     
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

void updateColors(Points &_points){
\end_layout

\begin_layout Plain Layout

  long n = _points.size() - 1;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  /* We iterate through all points.
 At each point, we update its redLeft
\end_layout

\begin_layout Plain Layout

  * etc values by adding what was known at the previous step of the iteration
\end_layout

\begin_layout Plain Layout

  */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    for (long i = (n-1); i >= 0; i--){
\end_layout

\begin_layout Plain Layout

      _points[n].redLeft += _points[i].redLeft;
\end_layout

\begin_layout Plain Layout

    } 
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  for (long i = (n-1); i >= 0; i--){
\end_layout

\begin_layout Plain Layout

    _points[i].blueRight += _points[i+1].blueRight;
\end_layout

\begin_layout Plain Layout

    if (_points[i+1].isRed){
\end_layout

\begin_layout Plain Layout

      _points[i].redLeft   = _points[i+1].redLeft - _points[i+1].weight;
\end_layout

\begin_layout Plain Layout

    } else {
\end_layout

\begin_layout Plain Layout

      _points[i].redLeft   = _points[i+1].redLeft;
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

void updateWeights(Points &_points){
\end_layout

\begin_layout Plain Layout

  long n = _points.size();
\end_layout

\begin_layout Plain Layout

  for (long i = 0; i < n; i++){
\end_layout

\begin_layout Plain Layout

    _points[i].posWeight = _points[i].blueRight + _points[i].redLeft;
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// [[Rcpp::export]]
\end_layout

\begin_layout Plain Layout

Rcpp::NumericMatrix redBlue(Rcpp::NumericVector values,Rcpp::NumericVector
 weights,
\end_layout

\begin_layout Plain Layout

                            Rcpp::IntegerVector isReds,bool isSorted){
\end_layout

\begin_layout Plain Layout

              
\end_layout

\begin_layout Plain Layout

  long n = values.size();
\end_layout

\begin_layout Plain Layout

  Points points(n+2);
\end_layout

\begin_layout Plain Layout

  for (int i = 1; i < (n+1); i++){
\end_layout

\begin_layout Plain Layout

    points[i] = Point(values[i-1],weights[i-1],isReds[i-1]);
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  points[n+1]   = Point( 1.0/0.0, 0, false);
\end_layout

\begin_layout Plain Layout

  points[0]     = Point(-1.0/0.0, 0, true);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  if (!isSorted) std::sort(points.begin(),points.end());
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  updateColors(points);
\end_layout

\begin_layout Plain Layout

  updateWeights(points);
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  Rcpp::NumericMatrix valuesAndWeights(3,n+2);
\end_layout

\begin_layout Plain Layout

  for (int i = 0; i < n+2; i++){
\end_layout

\begin_layout Plain Layout

    valuesAndWeights(0,i) = points[i].value;
\end_layout

\begin_layout Plain Layout

    valuesAndWeights(1,i) = points[i].isRed;
\end_layout

\begin_layout Plain Layout

    valuesAndWeights(2,i) = points[i].posWeight;
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  return (valuesAndWeights);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

/*
\end_layout

\begin_layout Plain Layout

Points updatePoints(Points &points,const Point newPoint){
\end_layout

\begin_layout Plain Layout

  long n = points.size();
\end_layout

\begin_layout Plain Layout

  int index;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (newPoint.isRed){
\end_layout

\begin_layout Plain Layout

  index = 
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

*/
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

 
\end_layout

\end_inset


\end_layout

\begin_layout Section
Two dimensions
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language={[GNU]C++},numbers=left,basicstyle={\scriptsize},breaklines=true"
inline false
status open

\begin_layout Plain Layout

#include <cmath>
\end_layout

\begin_layout Plain Layout

#include <vector>
\end_layout

\begin_layout Plain Layout

#include <algorithm>
\end_layout

\begin_layout Plain Layout

#include <list>
\end_layout

\begin_layout Plain Layout

#include <Rcpp.h>
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

class Point { 
\end_layout

\begin_layout Plain Layout

public: 
\end_layout

\begin_layout Plain Layout

  double value;
\end_layout

\begin_layout Plain Layout

  long weight;
\end_layout

\begin_layout Plain Layout

  long posWeight;
\end_layout

\begin_layout Plain Layout

  double redLeft;
\end_layout

\begin_layout Plain Layout

  double blueRight;
\end_layout

\begin_layout Plain Layout

  bool isRed;
\end_layout

\begin_layout Plain Layout

  Point(double _value, long _weight, bool _isRed);
\end_layout

\begin_layout Plain Layout

  Point();
\end_layout

\begin_layout Plain Layout

}; 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

typedef std::vector <Point> Points;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

inline bool operator < (const Point pointOne, const Point pointTwo) { 
\end_layout

\begin_layout Plain Layout

  return pointOne.value < pointTwo.value; 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

inline bool operator > (const Point pointOne, const Point pointTwo) { 
\end_layout

\begin_layout Plain Layout

  return pointOne.value > pointTwo.value; 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Point::Point(){
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Point::Point(double _value, long _weight, bool _isRed) {
\end_layout

\begin_layout Plain Layout

  /* The basic values of the object is defined.
 */
\end_layout

\begin_layout Plain Layout

  value      = _value;
\end_layout

\begin_layout Plain Layout

  weight     = _weight;
\end_layout

\begin_layout Plain Layout

  isRed      = _isRed;
\end_layout

\begin_layout Plain Layout

  posWeight     = 0;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  /* The quickredblue procedure will never update a point 
\end_layout

\begin_layout Plain Layout

  * with its own colors.
 This is done here.
 */
\end_layout

\begin_layout Plain Layout

    if (isRed){
\end_layout

\begin_layout Plain Layout

      redLeft   = weight; 
\end_layout

\begin_layout Plain Layout

      blueRight = 0; 
\end_layout

\begin_layout Plain Layout

    } else {
\end_layout

\begin_layout Plain Layout

      redLeft   = 0; 
\end_layout

\begin_layout Plain Layout

      blueRight = weight;     
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

void updateColors(Points &_points){
\end_layout

\begin_layout Plain Layout

  long n = _points.size() - 1;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  /* We iterate through all points.
 At each point, we update its redLeft
\end_layout

\begin_layout Plain Layout

  * etc values by adding what was known at the previous step of the iteration
\end_layout

\begin_layout Plain Layout

  */
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    for (long i = (n-1); i >= 0; i--){
\end_layout

\begin_layout Plain Layout

      _points[n].redLeft += _points[i].redLeft;
\end_layout

\begin_layout Plain Layout

    } 
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  for (long i = (n-1); i >= 0; i--){
\end_layout

\begin_layout Plain Layout

    _points[i].blueRight += _points[i+1].blueRight;
\end_layout

\begin_layout Plain Layout

    if (_points[i+1].isRed){
\end_layout

\begin_layout Plain Layout

      _points[i].redLeft   = _points[i+1].redLeft - _points[i+1].weight;
\end_layout

\begin_layout Plain Layout

    } else {
\end_layout

\begin_layout Plain Layout

      _points[i].redLeft   = _points[i+1].redLeft;
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

template <typename T> int signum(T val) {
\end_layout

\begin_layout Plain Layout

    return (T(0) < val) - (val < T(0));
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

void updateWeights(Points &_points){
\end_layout

\begin_layout Plain Layout

  long n = _points.size();
\end_layout

\begin_layout Plain Layout

  for (long i = 0; i < n; i++){
\end_layout

\begin_layout Plain Layout

    _points[i].posWeight = _points[i].blueRight + _points[i].redLeft;
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

long getWeightMax(Points points){
\end_layout

\begin_layout Plain Layout

    long tempweight = 0;
\end_layout

\begin_layout Plain Layout

    long n = points.size();
\end_layout

\begin_layout Plain Layout

    for(int i = 0; i < n; i++){
\end_layout

\begin_layout Plain Layout

        tempweight = std::max(tempweight,points[i].posWeight);
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    return(tempweight);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

inline bool getColor(double const slopeCurrent,double const slope,
\end_layout

\begin_layout Plain Layout

                     bool const isRed){
\end_layout

\begin_layout Plain Layout

  bool whichColor;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (slopeCurrent > slope) whichColor = isRed;
\end_layout

\begin_layout Plain Layout

  else whichColor = !isRed;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  return (whichColor);     
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Points redBlue(std::vector < double > values,
\end_layout

\begin_layout Plain Layout

               std::vector < long > weights, 
\end_layout

\begin_layout Plain Layout

               std::vector < bool   >   isReds){
\end_layout

\begin_layout Plain Layout

              
\end_layout

\begin_layout Plain Layout

  long n = values.size();
\end_layout

\begin_layout Plain Layout

  Points points(n+2);
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  for (int i = 1; i < (n+1); i++){
\end_layout

\begin_layout Plain Layout

    points[i] = Point(values[i-1],weights[i-1],isReds[i-1]);
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  points[n+1]   = Point( 1.0/0.0, 0, false);
\end_layout

\begin_layout Plain Layout

  points[0]     = Point(-1.0/0.0, 0, true);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  std::sort(points.begin(),points.end());
\end_layout

\begin_layout Plain Layout

  updateColors(points);
\end_layout

\begin_layout Plain Layout

  updateWeights(points);
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  return (points);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// [[Rcpp::export]]
\end_layout

\begin_layout Plain Layout

Rcpp::List redBlue2(std::vector < double > xx1,
\end_layout

\begin_layout Plain Layout

                             std::vector < double > xx2, 
\end_layout

\begin_layout Plain Layout

                             std::vector < bool > isReds,
\end_layout

\begin_layout Plain Layout

                             std::vector < long > weights) {
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  long nobs  = xx1.size();
\end_layout

\begin_layout Plain Layout

  long currentWeight;
\end_layout

\begin_layout Plain Layout

  long maxWeight = -10000;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  std::vector < double > points(nobs-1);
\end_layout

\begin_layout Plain Layout

  std::vector < bool >   colors(nobs-1);
\end_layout

\begin_layout Plain Layout

  std::vector < Points > storage(nobs-1);
\end_layout

\begin_layout Plain Layout

  std::list < double > xCoord;
\end_layout

\begin_layout Plain Layout

  std::list < double > yCoord;
\end_layout

\begin_layout Plain Layout

  Points redBlues;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  /* The main part of the algorithm consists of computing redBlue for each
 line in
\end_layout

\begin_layout Plain Layout

   * in the arrangement.
 In order to this, we will have to calculate all points of
\end_layout

\begin_layout Plain Layout

   * intersection and all the corresponding colors.
 The following loop will run through
\end_layout

\begin_layout Plain Layout

   * this algorithm for us.
 */
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  for (int lineCount = 0; lineCount < nobs; lineCount++){
\end_layout

\begin_layout Plain Layout

    double slopeCurrent = -xx2[lineCount]/xx1[lineCount];
\end_layout

\begin_layout Plain Layout

    double x11 = xx1[lineCount];
\end_layout

\begin_layout Plain Layout

    double x12 = xx2[lineCount];
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    for (int intersectionCount = 0; intersectionCount < lineCount; intersectionC
ount++){
\end_layout

\begin_layout Plain Layout

      bool isRed = isReds[intersectionCount];      
\end_layout

\begin_layout Plain Layout

      double slope = -xx2[intersectionCount]/xx1[intersectionCount];  
\end_layout

\begin_layout Plain Layout

      double x21 = xx1[intersectionCount];
\end_layout

\begin_layout Plain Layout

      double x22 = xx2[intersectionCount];      
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

      colors[intersectionCount] = getColor(slopeCurrent,slope,isRed);
\end_layout

\begin_layout Plain Layout

      points[intersectionCount] = (x21-x11)/(x22*x11-x21*x12);
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    for (int intersectionCount = lineCount +1; intersectionCount < nobs;
 intersectionCount++){
\end_layout

\begin_layout Plain Layout

      bool isRed = isReds[intersectionCount];      
\end_layout

\begin_layout Plain Layout

      double slope = -xx2[intersectionCount]/xx1[intersectionCount];  
\end_layout

\begin_layout Plain Layout

      double x21 = xx1[intersectionCount];
\end_layout

\begin_layout Plain Layout

      double x22 = xx2[intersectionCount];      
\end_layout

\begin_layout Plain Layout

      
\end_layout

\begin_layout Plain Layout

      colors[intersectionCount-1] = getColor(slopeCurrent,slope,isRed);
\end_layout

\begin_layout Plain Layout

      points[intersectionCount-1] = (x21-x11)/(x22*x11-x21*x12);   
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    /* In order to call redBlue we will erase the values.
 When we're done it is safe
\end_layout

\begin_layout Plain Layout

     * to add them once again.
 */
\end_layout

\begin_layout Plain Layout

    currentWeight   = weights[lineCount];
\end_layout

\begin_layout Plain Layout

    weights.erase(weights.begin()+lineCount);
\end_layout

\begin_layout Plain Layout

    redBlues = redBlue(points,weights,colors);
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    /* We begin the updating operation.
 */
\end_layout

\begin_layout Plain Layout

    long tempWeight = maxWeight;
\end_layout

\begin_layout Plain Layout

    maxWeight = std::max(getWeightMax(redBlues),maxWeight);
\end_layout

\begin_layout Plain Layout

    if (tempWeight < maxWeight){
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

        /* In this case, we will remove all entries from our 
\end_layout

\begin_layout Plain Layout

         * xCoord and yCoord lists, and replace them with the new
\end_layout

\begin_layout Plain Layout

         * and superior entries from redBlues! */
\end_layout

\begin_layout Plain Layout

         
\end_layout

\begin_layout Plain Layout

        xCoord.clear();
\end_layout

\begin_layout Plain Layout

        yCoord.clear();
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

        double slope = -xx2[lineCount]/xx1[lineCount];
\end_layout

\begin_layout Plain Layout

        double intercept = -1/xx1[lineCount];
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

        for (int i = 0; i < (nobs + 1); i++){
\end_layout

\begin_layout Plain Layout

            if (redBlues[i].posWeight >= maxWeight) {
\end_layout

\begin_layout Plain Layout

                if(redBlues[i].value >= pow(10,10)) {
\end_layout

\begin_layout Plain Layout

                  xCoord.push_front(pow(10,10));
\end_layout

\begin_layout Plain Layout

                  yCoord.push_front(slope*pow(10,10)+intercept);
\end_layout

\begin_layout Plain Layout

                } else if (redBlues[i].value <= - pow(10,10)) {
\end_layout

\begin_layout Plain Layout

                  xCoord.push_front(-pow(10,10));      
\end_layout

\begin_layout Plain Layout

                  yCoord.push_front(slope*(-pow(10,10)+intercept));
\end_layout

\begin_layout Plain Layout

                } else {
\end_layout

\begin_layout Plain Layout

                  xCoord.push_front(redBlues[i].value);
\end_layout

\begin_layout Plain Layout

                  yCoord.push_front(slope*redBlues[i].value+intercept);
\end_layout

\begin_layout Plain Layout

                }
\end_layout

\begin_layout Plain Layout

            }
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    else if (tempWeight == maxWeight){
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

        double slope = -xx2[lineCount]/xx1[lineCount];
\end_layout

\begin_layout Plain Layout

        double intercept = -1/xx1[lineCount];
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

        for (int i = 0; i < (nobs + 1); i++){
\end_layout

\begin_layout Plain Layout

            if (redBlues[i].posWeight >= maxWeight) {
\end_layout

\begin_layout Plain Layout

                if(redBlues[i].value >= pow(10,10)) {
\end_layout

\begin_layout Plain Layout

                  xCoord.push_front(pow(10,10));
\end_layout

\begin_layout Plain Layout

                  yCoord.push_front(slope*pow(10,10)+intercept);
\end_layout

\begin_layout Plain Layout

                } else if (redBlues[i].value <= - pow(10,10)) {
\end_layout

\begin_layout Plain Layout

                  xCoord.push_front(-pow(10,10));      
\end_layout

\begin_layout Plain Layout

                  yCoord.push_front(slope*(-pow(10,10)+intercept));
\end_layout

\begin_layout Plain Layout

                } else {
\end_layout

\begin_layout Plain Layout

                  xCoord.push_front(redBlues[i].value);
\end_layout

\begin_layout Plain Layout

                  yCoord.push_front(slope*redBlues[i].value+intercept);
\end_layout

\begin_layout Plain Layout

                }
\end_layout

\begin_layout Plain Layout

            }
\end_layout

\begin_layout Plain Layout

        }
\end_layout

\begin_layout Plain Layout

        
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    weights.insert(weights.begin()+lineCount,currentWeight);
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

 return Rcpp::List::create(Rcpp::Named("xCoord")    = xCoord,
\end_layout

\begin_layout Plain Layout

                           Rcpp::Named("yCoord")    = yCoord,
\end_layout

\begin_layout Plain Layout

                           Rcpp::Named("maxWeight") = maxWeight + 1);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset Formula $\mathtt{R}$
\end_inset

 wrapper
\end_layout

\begin_layout Standard
Here we provide generics and wrappers for the 
\begin_inset Formula $\mathtt{C++}$
\end_inset

-code.
 The 
\begin_inset Formula $\mathtt{mms}$
\end_inset

-function can be used as the 
\begin_inset Formula $\mathtt{lm}$
\end_inset

-function, by using formulas.
 An examples is 
\begin_inset Formula $\mathtt{mms(yy\sim xx1+xx2)}.$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=R,numbers=left,basicstyle={\scriptsize},breaklines=true"
inline false
status open

\begin_layout Plain Layout

library("Rcpp")
\end_layout

\begin_layout Plain Layout

sourceCpp("manskiAlgorithm[1d].cpp")
\end_layout

\begin_layout Plain Layout

sourceCpp("manskiAlgorithm[2d].cpp")
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# Begin the one dimensional algorithm -----------------------------------------
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# The objective function.
 -----------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

manskiObjective = function(beta,yy,xx,weights=rep(1,length(yy)),positive
 = TRUE){
\end_layout

\begin_layout Plain Layout

  if (positive) {
\end_layout

\begin_layout Plain Layout

    sum(weights*yy*(1+beta*xx>=0)) + sum(weights*(1-yy)*(1+beta*xx<0))
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  else {
\end_layout

\begin_layout Plain Layout

    sum(weights*yy*(-1+beta*xx>=0)) + sum(weights*(1-yy)*(-1+beta*xx<0))
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Wrapper.
 --------------------------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

manski1d = function(yy, xx, xxConst = 1, weights=rep(1,length(yy)),
\end_layout

\begin_layout Plain Layout

                    isSorted = FALSE) {
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  # xxConst is used to modulate the values of the constant beta.
 By
\end_layout

\begin_layout Plain Layout

  # putting it unequal to 1, one can let y = x1 + bx2, for instance.
\end_layout

\begin_layout Plain Layout

  #
\end_layout

\begin_layout Plain Layout

  # isSorted = TRUE if the values yy,xx are already sorted.
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  # First we find the colors and transform the input.
\end_layout

\begin_layout Plain Layout

  # isRed = c((yy & xx >=0 ) | (!yy & xx < 0))
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  values = -xxConst/xx
\end_layout

\begin_layout Plain Layout

  isRed = c((yy & xx >=0 ) | (!yy & xx < 0))
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  redBlues = redBlue(values,weights,isRed,isSorted=isSorted)
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  maxWeight = max(redBlues[3,])
\end_layout

\begin_layout Plain Layout

  points    = matrix(redBlues[1,][redBlues[3,] == maxWeight],
\end_layout

\begin_layout Plain Layout

                     ncol=2,byrow=TRUE)
\end_layout

\begin_layout Plain Layout

  colnames(points) = c("beta1","beta2")
\end_layout

\begin_layout Plain Layout

  sol1d = list()
\end_layout

\begin_layout Plain Layout

  class(sol1d)    = c("manski1d","manski")
\end_layout

\begin_layout Plain Layout

  sol1d$maxWeight = maxWeight
\end_layout

\begin_layout Plain Layout

  sol1d$total     = sum(weights)
\end_layout

\begin_layout Plain Layout

  sol1d$points    = points
\end_layout

\begin_layout Plain Layout

  sol1d$yy        = yy
\end_layout

\begin_layout Plain Layout

  sol1d$xx        = xx
\end_layout

\begin_layout Plain Layout

  sol1d$weights   = weights
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  return(sol1d)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Generics.
 -------------------------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

plot.manski1d = function(manski_obj,main=NULL,sub=NULL,lim=NULL,...){
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  redBlues = manski_obj$details
\end_layout

\begin_layout Plain Layout

  nobs = length(redBlues[1,]) - 2
\end_layout

\begin_layout Plain Layout

  maxWeight = manski_obj$maxWeight
\end_layout

\begin_layout Plain Layout

  total = manski_obj$total
\end_layout

\begin_layout Plain Layout

  weights = manski_obj$weights
\end_layout

\begin_layout Plain Layout

  positives = manski_obj$points
\end_layout

\begin_layout Plain Layout

  xx = manski_obj$xx
\end_layout

\begin_layout Plain Layout

  yy = manski_obj$yy 
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if(max(positives)==Inf) {
\end_layout

\begin_layout Plain Layout

    positives[positives==Inf] = max(positives[positives!=Inf])+4
\end_layout

\begin_layout Plain Layout

    upper = max(positives[positives!=Inf])
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    upper = max(positives,na.rm=TRUE) + abs(min(positives,na.rm=TRUE))
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  xs = seq(min(positives,na.rm=TRUE)-abs(min(positives,na.rm=TRUE)),
\end_layout

\begin_layout Plain Layout

           upper,by=0.001)
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  plot(xs,sapply(xs,function(beta) manskiObjective(beta,yy,xx,weights)/total),ty
pe="s",
\end_layout

\begin_layout Plain Layout

       col=adjustcolor("purple",alpha.f=0.6),xlab=expression(beta[1]),ylab="Percen
t hits",
\end_layout

\begin_layout Plain Layout

       main = main, bty="l",
\end_layout

\begin_layout Plain Layout

       xlim=c(min(positives)-0.01,max(positives)+0.01))
\end_layout

\begin_layout Plain Layout

  for (i in 1:dim(positives)[1]){
\end_layout

\begin_layout Plain Layout

    lines(positives[i,],c(maxWeight,maxWeight)/total)
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

breakdown = function(obj){
\end_layout

\begin_layout Plain Layout

  nobs = length(obj$yy)
\end_layout

\begin_layout Plain Layout

  isReds = obj$details[2,][-c(1,nobs+2)]
\end_layout

\begin_layout Plain Layout

  vals   = obj$details[1,][-c(1,nobs+2)]
\end_layout

\begin_layout Plain Layout

  left   = (vals <= obj$positives[1,1])
\end_layout

\begin_layout Plain Layout

  left   = sum(ifelse(isReds,1,-1)*left)
\end_layout

\begin_layout Plain Layout

  right  = (vals >= obj$positives[1,2])
\end_layout

\begin_layout Plain Layout

  right  = sum(ifelse(isReds,-1,1)*right)  
\end_layout

\begin_layout Plain Layout

  ceiling(min(left,right))/2
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

coef.manski1d = function(obj,rand=FALSE){
\end_layout

\begin_layout Plain Layout

  xs = obj$positives
\end_layout

\begin_layout Plain Layout

  xsFiltered = xs[xs<=10^9 & xs >= -10^9]
\end_layout

\begin_layout Plain Layout

  if (rand) {
\end_layout

\begin_layout Plain Layout

    return (sample(xsFiltered,1))
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    xsAbs = abs(xsFiltered)
\end_layout

\begin_layout Plain Layout

    index = which.min(xsAbs)
\end_layout

\begin_layout Plain Layout

    return(xsFiltered[index])
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# Begin the code for 2D algorithms --------------------------------------------
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Wrapper for the algorithm.
 --------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

manski2d = function(yy,xx1,xx2,weights=rep(1,length(yy))) {
\end_layout

\begin_layout Plain Layout

  isReds = (xx1 >= 0 & yy) | ( xx1 < 0 & !yy)
\end_layout

\begin_layout Plain Layout

  res = redBlue2(xx1,xx2,isReds,weights)
\end_layout

\begin_layout Plain Layout

  points = cbind(beta1 = res$yCoord,beta2 = res$xCoord)
\end_layout

\begin_layout Plain Layout

  sol2d = list()
\end_layout

\begin_layout Plain Layout

  class(sol2d)    = c("manski2d","manski")
\end_layout

\begin_layout Plain Layout

  sol2d$maxWeight = res$maxWeight
\end_layout

\begin_layout Plain Layout

  sol2d$total     = sum(weights)
\end_layout

\begin_layout Plain Layout

  sol2d$points    = points
\end_layout

\begin_layout Plain Layout

  sol2d$yy        = yy
\end_layout

\begin_layout Plain Layout

  sol2d$xx1       = xx1
\end_layout

\begin_layout Plain Layout

  sol2d$xx2       = xx2
\end_layout

\begin_layout Plain Layout

  sol2d$weights   = weights
\end_layout

\begin_layout Plain Layout

  return(sol2d)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Generics.
 -------------------------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

plot.manski2d = function(manski_obj,main=NULL,sub=NULL,
\end_layout

\begin_layout Plain Layout

                         full=FALSE,lim=NULL,...){
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  len = length(manski_obj$points[,1])/2
\end_layout

\begin_layout Plain Layout

  xCoord = matrix(manski_obj$points[,1],len,2,byrow=TRUE)
\end_layout

\begin_layout Plain Layout

  yCoord = matrix(manski_obj$points[,2],len,2,byrow=TRUE)
\end_layout

\begin_layout Plain Layout

  xx1 = manski_obj$xx1
\end_layout

\begin_layout Plain Layout

  xx2 = manski_obj$xx2
\end_layout

\begin_layout Plain Layout

  yy  = manski_obj$yy  
\end_layout

\begin_layout Plain Layout

  par(pty="m")  
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  plot(NULL,xlim=c(min(xCoord),max(xCoord)),
\end_layout

\begin_layout Plain Layout

       col=adjustcolor("black",alpha.f=0.6),
\end_layout

\begin_layout Plain Layout

       ylim=c(min(yCoord),max(yCoord)),type="l",
\end_layout

\begin_layout Plain Layout

       xlab=expression(beta[2]),ylab=expression(beta[1]),
\end_layout

\begin_layout Plain Layout

       bty="l")
\end_layout

\begin_layout Plain Layout

  grid()
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (full){
\end_layout

\begin_layout Plain Layout

    nobs = length(xx1)
\end_layout

\begin_layout Plain Layout

    xs = seq(-1000,1000,by=2)
\end_layout

\begin_layout Plain Layout

    isReds = (xx1 >= 0 & yy) | ( xx1 < 0 & !yy)
\end_layout

\begin_layout Plain Layout

    colIndex = ifelse(isReds,2,4)
\end_layout

\begin_layout Plain Layout

    for (i in 1:nobs){
\end_layout

\begin_layout Plain Layout

      lines(xs,-1/xx2[i]-xs/xx2[i]*xx1[i],col=adjustcolor(colIndex[i],alpha.f=0.7)
,lty=3)
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (is.null(lim)){
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    for (i in 1:len) {
\end_layout

\begin_layout Plain Layout

      lines(xCoord[i,],yCoord[i,],lwd=1,col=adjustcolor("black",alpha.f=0.6))
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    plot(xCoord[1,],yCoord[1,],xlim=c(min(xCoord),lim),col=adjustcolor("black",a
lpha.f=0.6),
\end_layout

\begin_layout Plain Layout

         ylim=c(min(yCoord),lim),type="l",xlab=expression(beta[2]),ylab=expressi
on(beta[1]))
\end_layout

\begin_layout Plain Layout

    
\end_layout

\begin_layout Plain Layout

    for (i in 2:len) {
\end_layout

\begin_layout Plain Layout

      lines(xCoord[i,],yCoord[i,],lwd=1,col=adjustcolor("black",alpha.f=0.6))
\end_layout

\begin_layout Plain Layout

    }    
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

coef.manski2d = function(obj,type="min"){
\end_layout

\begin_layout Plain Layout

  # The point is to automatically select coefficients in a smart way.
\end_layout

\begin_layout Plain Layout

  # Most importantly, we _don't_ want beta1 or beta2 to be Inf (that
\end_layout

\begin_layout Plain Layout

  # is 10^10 in this case.)
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if (type == "min") {
\end_layout

\begin_layout Plain Layout

    points = obj$points
\end_layout

\begin_layout Plain Layout

    index = which.min(apply(points,1,function(z) (z[1]^2+z[2]^2)))
\end_layout

\begin_layout Plain Layout

    return(c(points[index,1],points[index,2]))
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    xs = obj$points[,1]
\end_layout

\begin_layout Plain Layout

    ys = obj$points[,2] 
\end_layout

\begin_layout Plain Layout

    for (i in 1:length(xs)){
\end_layout

\begin_layout Plain Layout

      if (xs[i] <= 10^9 & xs[i] >= -10^9 & ys[i] <= 10^9 & ys[i] >= -10^9){
\end_layout

\begin_layout Plain Layout

        return(c(beta1=xs[i],beta2=ys[i]))
\end_layout

\begin_layout Plain Layout

      }
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# Define the mms function -----------------------------------------------------
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

mms = function(formula,weights=NULL) {
\end_layout

\begin_layout Plain Layout

  vars = all.vars(formula)
\end_layout

\begin_layout Plain Layout

  resp = eval(parse(text=vars[1]))
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if ( is.null(weights) ) weights = rep(1,length(resp))
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  if ( length(vars) == 2 ) {
\end_layout

\begin_layout Plain Layout

    xx = eval(parse(text=vars[2]))
\end_layout

\begin_layout Plain Layout

    return (manski1d(resp,xx,weights=weights))
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    xx1 = eval(parse(text=vars[2]))
\end_layout

\begin_layout Plain Layout

    xx2 = eval(parse(text=vars[3]))
\end_layout

\begin_layout Plain Layout

    return(manski2d(resp,xx1,xx2,weights=weights))
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

print.manski = function(obj) {
\end_layout

\begin_layout Plain Layout

  cat("***-----------------------------*** 
\backslash
n")
\end_layout

\begin_layout Plain Layout

  cat("*** Manski's maximum score      *** 
\backslash
n")
\end_layout

\begin_layout Plain Layout

  cat("***-----------------------------***")
\end_layout

\begin_layout Plain Layout

  if("manski1d" %in% class(obj)) {
\end_layout

\begin_layout Plain Layout

    cat("
\backslash
n   Covariates: 1")    
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    cat("
\backslash
n   Covariates: 2")      
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  cat("
\backslash
n   Objective:",obj$maxWeight)
\end_layout

\begin_layout Plain Layout

  cat("
\backslash
n   Sum of weights:",obj$total)
\end_layout

\begin_layout Plain Layout

  cat("
\backslash
n   Solution edges: 
\backslash
n")
\end_layout

\begin_layout Plain Layout

  print(as.data.frame(obj$points))
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard

\end_layout

\end_body
\end_document
